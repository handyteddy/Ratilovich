<!DOCTYPE html>


<html lang="en">
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" />
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Pivoting SQL Server Access Through SOCKS5 with Commando and Kali</title>
 

  <link rel="stylesheet" type="text/css" href="/assets/main-hacker.css"></head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul>
      <li class="menu-first-child">
        <span>
          [cyberRat@RedTeam]~$
          <span class="blink">
            â–ˆ
          </span>
        </span>
      </li>
      <li>
        <a href="/">Home</a>
      </li>

    
      <li>
        <a href="/brainbox/">/BrainBox</a>
      </li> 
      <li>
        <a href="/resume/">/Resume</a>
      </li>

    </ul>
  </div>
</header>

<main>
      <p>ğŸ§  <strong>Scenario</strong></p>

<ul>
  <li>ğŸ’» <strong>Kali VM</strong>: Has VPN access to the internal network.</li>
  <li>ğŸ›¡ï¸ <strong>Commando VM</strong>: Needs to reach SQL Server (10.10.110.58).</li>
  <li>ğŸ—ƒï¸ <strong>SQL Server</strong>: Only reachable via VPN from Kali.</li>
  <li>ğŸ¯ <strong>Objective</strong>: Route Commandoâ€™s traffic (specifically TCP/1433) through Kali using SOCKS5.</li>
</ul>

<hr />

<p>ğŸ› ï¸ <strong>Step 1: Setting up a SOCKS5 Proxy on Kali</strong></p>

<p>On Kali, I spun up a SOCKS5 proxy using SSH:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-D</span> 0.0.0.0:1080 <span class="nt">-q</span> <span class="nt">-C</span> <span class="nt">-N</span> kali@localhost
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">-D 0.0.0.0:1080</code>: Binds the SOCKS proxy to all interfaces</li>
  <li><code class="language-plaintext highlighter-rouge">-q -C -N</code>: Quiet, compressed, no command shell</li>
</ul>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>Terminal showing SSH SOCKS proxy command running</em></p>

<hr />

<p>ğŸ“¡ <strong>Step 2: Confirming the Proxy is Active</strong></p>

<p>To confirm itâ€™s listening:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ss <span class="nt">-tulnp</span> | <span class="nb">grep </span>1080
</code></pre></div></div>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>Output showing ssh process listening on 0.0.0.0:1080</em></p>

<hr />

<p>âš™ï¸ <strong>Step 3: Configure Proxifier on Commando VM</strong></p>

<p>Installed <a href="https://www.proxifier.com/">Proxifier</a> on Commando VM and added a proxy:</p>

<ul>
  <li>ğŸ  <strong>Address</strong>: Kaliâ€™s IP (e.g., 192.168.56.101)</li>
  <li>ğŸ”Œ <strong>Port</strong>: 1080</li>
  <li>ğŸ”„ <strong>Type</strong>: SOCKS5</li>
</ul>

<p>Then created a rule for traffic to SQL Server on port 1433.</p>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>Proxifier rule setup with IP, port, and proxy settings</em></p>

<hr />

<p>ğŸ“Š <strong>Step 4: Confirming Proxy Traffic</strong></p>

<p>Once configured, the Proxifier dashboard showed traffic flowing through the SOCKS5 proxy.</p>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>Proxifier stats with data on proxy traffic</em></p>

<hr />

<p>ğŸ§ª <strong>Step 5: PowerUpSQL to Test SQL Access</strong></p>

<p>From Commando VM, I used PowerUpSQL to query the SQL Server:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Invoke-SQLQuery</span><span class="w"> </span><span class="nt">-SQLServer</span><span class="w"> </span><span class="s2">"10.10.110.58"</span><span class="w"> </span><span class="nt">-Username</span><span class="w"> </span><span class="s2">"sa"</span><span class="w"> </span><span class="nt">-Password</span><span class="w"> </span><span class="s2">"P@ssw0rd"</span><span class="w"> </span><span class="nt">-Query</span><span class="w"> </span><span class="s2">"SELECT @@version"</span><span class="w">
</span></code></pre></div></div>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>PowerShell output showing SQL Server version</em></p>

<p>Loaded PowerUpSQL:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cd</span><span class="w"> </span><span class="nx">C:\Tools\PowerUpSQL\</span><span class="w">
</span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="n">\PowerUpSQL.ps1</span><span class="w">
</span></code></pre></div></div>

<hr />

<p>ğŸš« <strong>Why ICMP (Ping) Fails Over SOCKS</strong></p>

<p><code class="language-plaintext highlighter-rouge">ping</code> uses ICMP, which SOCKS5 doesnâ€™t support. Instead, I used:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">10.10.110.58</span><span class="w"> </span><span class="nt">-Port</span><span class="w"> </span><span class="nx">1433</span><span class="w">
</span></code></pre></div></div>

<p>âœ… Worked perfectly.</p>

<hr />

<p>âœ… <strong>Conclusion</strong></p>

<p>Using a SOCKS5 proxy via SSH allowed me to pivot Commando VMâ€™s traffic through Kaliâ€™s VPN connection. With Proxifier and PowerUpSQL, I retained full functionality without modifying Kali.</p>

<p>ğŸ“¸ <strong>Screenshot Placeholder</strong>: <em>Diagram: Commando â†’ SOCKS5 (Kali) â†’ VPN â†’ SQL Server</em></p>

<hr />

<p>ğŸ’¡ <strong>Future Improvements</strong></p>

<ul>
  <li>ğŸ” Automate SOCKS setup with key-based SSH login</li>
  <li>ğŸ“ˆ Monitor/log SOCKS traffic on Kali</li>
  <li>ğŸ§  Support DNS-over-proxy for advanced tools</li>
</ul>

<hr />


    </main><footer>
  <a href="https://twitter.com/ratilovich">Twitter</a> 
</footer>
</div>
  </body>
</html>
